<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vuepress</title>
    <meta name="description" content="vuepress">
    <meta name="generator" content="VuePress 1.4.0">
    
    
    <link rel="preload" href="/vuepress/assets/css/0.styles.68cb6b73.css" as="style"><link rel="preload" href="/vuepress/assets/js/app.f5011d8a.js" as="script"><link rel="preload" href="/vuepress/assets/js/4.90bcc246.js" as="script"><link rel="preload" href="/vuepress/assets/js/12.6b37e325.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/10.7d30284d.js"><link rel="prefetch" href="/vuepress/assets/js/11.2b502189.js"><link rel="prefetch" href="/vuepress/assets/js/13.26ac10f5.js"><link rel="prefetch" href="/vuepress/assets/js/14.7b859e8c.js"><link rel="prefetch" href="/vuepress/assets/js/15.e710549d.js"><link rel="prefetch" href="/vuepress/assets/js/16.7a15ea25.js"><link rel="prefetch" href="/vuepress/assets/js/17.533656ec.js"><link rel="prefetch" href="/vuepress/assets/js/18.99401dd0.js"><link rel="prefetch" href="/vuepress/assets/js/2.ea56696e.js"><link rel="prefetch" href="/vuepress/assets/js/3.f3a48d3c.js"><link rel="prefetch" href="/vuepress/assets/js/5.4b483fdd.js"><link rel="prefetch" href="/vuepress/assets/js/6.e99f3d9e.js"><link rel="prefetch" href="/vuepress/assets/js/7.8434a95d.js"><link rel="prefetch" href="/vuepress/assets/js/8.6af74ffa.js"><link rel="prefetch" href="/vuepress/assets/js/9.499e0c42.js">
    <link rel="stylesheet" href="/vuepress/assets/css/0.styles.68cb6b73.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><div class="content__default"><h2 id="python-速查表">python 速查表</h2> <div class="card"><div class="card-box"><p class="title">Main</p><hr> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>     <span class="token comment"># Runs main() if file wasn't imported.</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="list">List</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span><span class="token punctuation">[</span>from_inclusive <span class="token punctuation">:</span> to_exclusive <span class="token punctuation">:</span> ±step_size<span class="token punctuation">]</span>

<span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">)</span>            <span class="token comment"># Or: &lt;list&gt; += [&lt;el&gt;]</span>
<span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">)</span>    <span class="token comment"># Or: &lt;list&gt; += &lt;collection&gt;</span>

<span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>reverse<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token builtin">iter</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">reversed</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>

sum_of_elements  <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">)</span>
elementwise_sum  <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">sum</span><span class="token punctuation">(</span>pair<span class="token punctuation">)</span> <span class="token keyword">for</span> pair <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>list_a<span class="token punctuation">,</span> list_b<span class="token punctuation">)</span><span class="token punctuation">]</span>
sorted_by_second <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> el<span class="token punctuation">:</span> el<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sorted_by_both   <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> el<span class="token punctuation">:</span> <span class="token punctuation">(</span>el<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> el<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
flatter_list     <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>itertools<span class="token punctuation">.</span>chain<span class="token punctuation">.</span>from_iterable<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
product_of_elems <span class="token operator">=</span> functools<span class="token punctuation">.</span><span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> out<span class="token punctuation">,</span> el<span class="token punctuation">:</span> out <span class="token operator">*</span> el<span class="token punctuation">,</span> <span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">)</span>
list_of_chars    <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><strong>Module <a href="#operator">operator</a> provides functions itemgetter() and mul() that offer the same functionality as lambda expressions above.</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">)</span>     <span class="token comment"># Returns number of occurrences. Also works on strings.</span>
index <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">)</span>     <span class="token comment"># Returns index of first occurrence or raises ValueError.</span>
<span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>insert<span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">)</span>     <span class="token comment"># Inserts item at index and moves the rest to the right.</span>
<span class="token operator">&lt;</span>el<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>     <span class="token comment"># Removes and returns item at index or from the end.</span>
<span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">)</span>            <span class="token comment"># Removes first occurrence of item or raises ValueError.</span>
<span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>                 <span class="token comment"># Removes all items. Also works on dictionary and set.</span>
</code></pre></div><h2 id="dictionary">Dictionary</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span>view<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">dict</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span>                          <span class="token comment"># Coll. of keys that reflects changes.</span>
<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">dict</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span>                        <span class="token comment"># Coll. of values that reflects changes.</span>
<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">dict</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span>                         <span class="token comment"># Coll. of key-value tuples that reflects chgs.</span>

value  <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">dict</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span>key<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>          <span class="token comment"># Returns default if key is missing.</span>
value  <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">dict</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span>key<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>   <span class="token comment"># Returns and writes default if key is missing.</span>
<span class="token operator">&lt;</span><span class="token builtin">dict</span><span class="token operator">&gt;</span> <span class="token operator">=</span> collections<span class="token punctuation">.</span>defaultdict<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">type</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>        <span class="token comment"># Creates a dict with default value of type.</span>
<span class="token operator">&lt;</span><span class="token builtin">dict</span><span class="token operator">&gt;</span> <span class="token operator">=</span> collections<span class="token punctuation">.</span>defaultdict<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">)</span>     <span class="token comment"># Creates a dict with default value 1.</span>

<span class="token operator">&lt;</span><span class="token builtin">dict</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">)</span>                     <span class="token comment"># Creates a dict from coll. of key-value pairs.</span>
<span class="token operator">&lt;</span><span class="token builtin">dict</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>keys<span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token comment"># Creates a dict from two collections.</span>
<span class="token operator">&lt;</span><span class="token builtin">dict</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">.</span>fromkeys<span class="token punctuation">(</span>keys <span class="token punctuation">[</span><span class="token punctuation">,</span> value<span class="token punctuation">]</span><span class="token punctuation">)</span>          <span class="token comment"># Creates a dict from collection of keys.</span>

<span class="token operator">&lt;</span><span class="token builtin">dict</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">dict</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>                           <span class="token comment"># Adds items. Replaces ones with matching keys.</span>
value <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">dict</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>pop<span class="token punctuation">(</span>key<span class="token punctuation">)</span>                         <span class="token comment"># Removes item or raises KeyError.</span>
<span class="token punctuation">{</span>k <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> <span class="token operator">&lt;</span><span class="token builtin">dict</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> v <span class="token operator">==</span> value<span class="token punctuation">}</span>    <span class="token comment"># Returns set of keys that point to the value.</span>
<span class="token punctuation">{</span>k<span class="token punctuation">:</span> v <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> <span class="token operator">&lt;</span><span class="token builtin">dict</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> k <span class="token keyword">in</span> keys<span class="token punctuation">}</span>  <span class="token comment"># Returns a dictionary, filtered by keys.</span>
</code></pre></div><h3 id="counter">Counter</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> collections <span class="token keyword">import</span> Counter
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'blue'</span><span class="token punctuation">,</span> <span class="token string">'blue'</span><span class="token punctuation">,</span> <span class="token string">'blue'</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> counter <span class="token operator">=</span> Counter<span class="token punctuation">(</span>colors<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> counter<span class="token punctuation">[</span><span class="token string">'yellow'</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
Counter<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'blue'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'yellow'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> counter<span class="token punctuation">.</span>most_common<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token punctuation">(</span><span class="token string">'blue'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="set">Set</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">set</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token operator">&lt;</span><span class="token builtin">set</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">)</span>                                 <span class="token comment"># Or: &lt;set&gt; |= {&lt;el&gt;}</span>
<span class="token operator">&lt;</span><span class="token builtin">set</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">)</span>                      <span class="token comment"># Or: &lt;set&gt; |= &lt;set&gt;</span>

<span class="token operator">&lt;</span><span class="token builtin">set</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">set</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>union<span class="token punctuation">(</span><span class="token operator">&lt;</span>coll<span class="token punctuation">.</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>                   <span class="token comment"># Or: &lt;set&gt; | &lt;set&gt;</span>
<span class="token operator">&lt;</span><span class="token builtin">set</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">set</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>intersection<span class="token punctuation">(</span><span class="token operator">&lt;</span>coll<span class="token punctuation">.</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>            <span class="token comment"># Or: &lt;set&gt; &amp; &lt;set&gt;</span>
<span class="token operator">&lt;</span><span class="token builtin">set</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">set</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>difference<span class="token punctuation">(</span><span class="token operator">&lt;</span>coll<span class="token punctuation">.</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>              <span class="token comment"># Or: &lt;set&gt; - &lt;set&gt;</span>
<span class="token operator">&lt;</span><span class="token builtin">set</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">set</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>symmetric_difference<span class="token punctuation">(</span><span class="token operator">&lt;</span>coll<span class="token punctuation">.</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>    <span class="token comment"># Or: &lt;set&gt; ^ &lt;set&gt;</span>
<span class="token operator">&lt;</span><span class="token builtin">bool</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">set</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>issubset<span class="token punctuation">(</span><span class="token operator">&lt;</span>coll<span class="token punctuation">.</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>                <span class="token comment"># Or: &lt;set&gt; &lt;= &lt;set&gt;</span>
<span class="token operator">&lt;</span><span class="token builtin">bool</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">set</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>issuperset<span class="token punctuation">(</span><span class="token operator">&lt;</span>coll<span class="token punctuation">.</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>              <span class="token comment"># Or: &lt;set&gt; &gt;= &lt;set&gt;</span>

<span class="token operator">&lt;</span>el<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">set</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>                              <span class="token comment"># Raises KeyError if empty.</span>
<span class="token operator">&lt;</span><span class="token builtin">set</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">)</span>                              <span class="token comment"># Raises KeyError if missing.</span>
<span class="token operator">&lt;</span><span class="token builtin">set</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>discard<span class="token punctuation">(</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">)</span>                             <span class="token comment"># Doesn't raise an error.</span>
</code></pre></div><h3 id="frozen-set">Frozen Set</h3> <ul><li><strong>Is immutable and hashable.</strong></li> <li><strong>That means it can be used as a key in a dictionary or as an element in a set.</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">frozenset</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">frozenset</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="tuple">Tuple</h2> <p><strong>Tuple is an immutable and hashable list.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">tuple</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token builtin">tuple</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token builtin">tuple</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>el_1<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>el_2<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="named-tuple">Named Tuple</h3> <p><strong>Tuple's subclass with named elements.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> collections <span class="token keyword">import</span> namedtuple
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Point <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'Point'</span><span class="token punctuation">,</span> <span class="token string">'x y'</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> p <span class="token operator">=</span> Point<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
Point<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token number">1</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> p<span class="token punctuation">.</span>x
<span class="token number">1</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">)</span>
<span class="token number">2</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> p<span class="token punctuation">.</span>_fields  <span class="token comment"># Or: Point._fields</span>
<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="range">Range</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">range</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span>to_exclusive<span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token builtin">range</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span>from_inclusive<span class="token punctuation">,</span> to_exclusive<span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token builtin">range</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span>from_inclusive<span class="token punctuation">,</span> to_exclusive<span class="token punctuation">,</span> ±step_size<span class="token punctuation">)</span>

from_inclusive <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">range</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>start
to_exclusive   <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">range</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>stop
</code></pre></div><h2 id="enumerate">Enumerate</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">for</span> i<span class="token punctuation">,</span> el <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> i_start<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><h2 id="iterator">Iterator</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">iter</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">iter</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">)</span>                 <span class="token comment"># `iter(&lt;iter&gt;)` returns unmodified iterator.</span>
<span class="token operator">&lt;</span><span class="token builtin">iter</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">iter</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>function<span class="token operator">&gt;</span><span class="token punctuation">,</span> to_exclusive<span class="token punctuation">)</span>     <span class="token comment"># A sequence of return values until 'to_exclusive'.</span>
<span class="token operator">&lt;</span>el<span class="token operator">&gt;</span>   <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">iter</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> default<span class="token punctuation">]</span><span class="token punctuation">)</span>           <span class="token comment"># Raises StopIteration or returns 'default' on end.</span>
<span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">iter</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>                       <span class="token comment"># Returns a list of iterator's remaining elements.</span>
</code></pre></div><h3 id="itertools">Itertools</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> itertools <span class="token keyword">import</span> count<span class="token punctuation">,</span> repeat<span class="token punctuation">,</span> cycle<span class="token punctuation">,</span> chain<span class="token punctuation">,</span> islice

<span class="token operator">&lt;</span><span class="token builtin">iter</span><span class="token operator">&gt;</span> <span class="token operator">=</span> count<span class="token punctuation">(</span>start<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> step<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>             <span class="token comment"># Returns incremented value endlessly.</span>
<span class="token operator">&lt;</span><span class="token builtin">iter</span><span class="token operator">&gt;</span> <span class="token operator">=</span> repeat<span class="token punctuation">(</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> times<span class="token punctuation">]</span><span class="token punctuation">)</span>             <span class="token comment"># Returns element endlessly or 'times' times.</span>
<span class="token operator">&lt;</span><span class="token builtin">iter</span><span class="token operator">&gt;</span> <span class="token operator">=</span> cycle<span class="token punctuation">(</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">)</span>                <span class="token comment"># Repeats the sequence endlessly.</span>

<span class="token operator">&lt;</span><span class="token builtin">iter</span><span class="token operator">&gt;</span> <span class="token operator">=</span> chain<span class="token punctuation">(</span><span class="token operator">&lt;</span>coll_1<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>coll_2<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># Empties collections in order.</span>
<span class="token operator">&lt;</span><span class="token builtin">iter</span><span class="token operator">&gt;</span> <span class="token operator">=</span> chain<span class="token punctuation">.</span>from_iterable<span class="token punctuation">(</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">)</span>  <span class="token comment"># Empties collections inside a collection in order.</span>

<span class="token operator">&lt;</span><span class="token builtin">iter</span><span class="token operator">&gt;</span> <span class="token operator">=</span> islice<span class="token punctuation">(</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">,</span> to_exclusive<span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token builtin">iter</span><span class="token operator">&gt;</span> <span class="token operator">=</span> islice<span class="token punctuation">(</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">,</span> from_inclusive<span class="token punctuation">,</span> to_exclusive <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token operator">+</span>step_size<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="generator">Generator</h2> <ul><li><strong>Any function that contains a yield statement returns a generator.</strong></li> <li><strong>Generators and iterators are interchangeable.</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">count</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> step<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span> start
        start <span class="token operator">+=</span> step

<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> counter <span class="token operator">=</span> count<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token builtin">next</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">next</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">next</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="type">Type</h2> <ul><li><strong>Everything is an object.</strong></li> <li><strong>Every object has a type.</strong></li> <li><strong>Type and class are synonymous.</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">type</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">type</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">)</span>                          <span class="token comment"># Or: &lt;el&gt;.__class__</span>
<span class="token operator">&lt;</span><span class="token builtin">bool</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>            <span class="token comment"># Or: issubclass(type(&lt;el&gt;), &lt;type&gt;)</span>

<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token builtin">type</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">.</span>__class__<span class="token punctuation">,</span> <span class="token builtin">str</span>
<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'str'</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'str'</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'str'</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="some-types-do-not-have-built-in-names-so-they-must-be-imported">Some types do not have built-in names, so they must be imported:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> types <span class="token keyword">import</span> FunctionType<span class="token punctuation">,</span> MethodType<span class="token punctuation">,</span> LambdaType<span class="token punctuation">,</span> GeneratorType
</code></pre></div><h3 id="abc">ABC</h3> <p><strong>An abstract base class introduces virtual subclasses that don’t inherit from it, but are still recognized by isinstance() and issubclass().</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> collections<span class="token punctuation">.</span>abc <span class="token keyword">import</span> Sequence<span class="token punctuation">,</span> Collection<span class="token punctuation">,</span> Iterable
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Iterable<span class="token punctuation">)</span>
<span class="token boolean">True</span>
</code></pre></div><div class="language-text extra-class"><pre class="language-text"><code>+------------------+------------+------------+------------+
|                  |  Sequence  | Collection |  Iterable  |
+------------------+------------+------------+------------+
| list, range, str |    yes     |    yes     |    yes     |
| dict, set        |            |    yes     |    yes     |
| iter             |            |            |    yes     |
+------------------+------------+------------+------------+

&gt;&gt;&gt; from numbers import Integral, Rational, Real, Complex, Number
&gt;&gt;&gt; isinstance(123, Number)
True
</code></pre></div><div class="language-text extra-class"><pre class="language-text"><code>+--------------------+----------+----------+----------+----------+----------+
|                    | Integral | Rational |   Real   | Complex  |  Number  |
+--------------------+----------+----------+----------+----------+----------+
| int                |   yes    |   yes    |   yes    |   yes    |   yes    |
| fractions.Fraction |          |   yes    |   yes    |   yes    |   yes    |
| float              |          |          |   yes    |   yes    |   yes    |
| complex            |          |          |          |   yes    |   yes    |
| decimal.Decimal    |          |          |          |          |   yes    |
+--------------------+----------+----------+----------+----------+----------+
</code></pre></div><h2 id="string">String</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>                       <span class="token comment"># Strips all whitespace characters from both ends.</span>
<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'&lt;chars&gt;'</span><span class="token punctuation">)</span>              <span class="token comment"># Strips all passed characters from both ends.</span>

<span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>                       <span class="token comment"># Splits on one or more whitespace characters.</span>
<span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span>sep<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> maxsplit<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># Splits on 'sep' str at most 'maxsplit' times.</span>
<span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>splitlines<span class="token punctuation">(</span>keepends<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>    <span class="token comment"># Splits on \n,\r,\r\n. Keeps them if 'keepends'.</span>
<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token operator">&lt;</span>coll_of_strings<span class="token operator">&gt;</span><span class="token punctuation">)</span>       <span class="token comment"># Joins elements using string as separator.</span>

<span class="token operator">&lt;</span><span class="token builtin">bool</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>sub_str<span class="token operator">&gt;</span> <span class="token keyword">in</span> <span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>                  <span class="token comment"># Checks if string contains a substring.</span>
<span class="token operator">&lt;</span><span class="token builtin">bool</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token operator">&lt;</span>sub_str<span class="token operator">&gt;</span><span class="token punctuation">)</span>         <span class="token comment"># Pass tuple of strings for multiple options.</span>
<span class="token operator">&lt;</span><span class="token builtin">bool</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token operator">&lt;</span>sub_str<span class="token operator">&gt;</span><span class="token punctuation">)</span>           <span class="token comment"># Pass tuple of strings for multiple options.</span>
<span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token operator">&lt;</span>sub_str<span class="token operator">&gt;</span><span class="token punctuation">)</span>               <span class="token comment"># Returns start index of first match or -1.</span>
<span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token operator">&lt;</span>sub_str<span class="token operator">&gt;</span><span class="token punctuation">)</span>              <span class="token comment"># Same but raises ValueError if missing.</span>

<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span>old<span class="token punctuation">,</span> new <span class="token punctuation">[</span><span class="token punctuation">,</span> count<span class="token punctuation">]</span><span class="token punctuation">)</span>   <span class="token comment"># Replaces 'old' with 'new' at most 'count' times.</span>
<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token operator">&lt;</span>table<span class="token operator">&gt;</span><span class="token punctuation">)</span>            <span class="token comment"># Use `str.maketrans(&lt;dict&gt;)` to generate table.</span>

<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>                          <span class="token comment"># Converts int to Unicode char.</span>
<span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>                          <span class="token comment"># Converts Unicode char to int.</span>
</code></pre></div><ul><li><strong>Also: <code>'lstrip()'</code>, <code>'rstrip()'</code>.</strong></li> <li><strong>Also: <code>'lower()'</code>, <code>'upper()'</code>, <code>'capitalize()'</code> and <code>'title()'</code>.</strong></li></ul> <h3 id="property-methods">Property Methods</h3> <div class="language-text extra-class"><pre class="language-text"><code>+---------------+----------+----------+----------+----------+----------+
|               | [ !#$%…] | [a-zA-Z] |  [¼½¾]   |  [²³¹]   |  [0-9]   |
+---------------+----------+----------+----------+----------+----------+
| isprintable() |   yes    |   yes    |   yes    |   yes    |   yes    |
| isalnum()     |          |   yes    |   yes    |   yes    |   yes    |
| isnumeric()   |          |          |   yes    |   yes    |   yes    |
| isdigit()     |          |          |          |   yes    |   yes    |
| isdecimal()   |          |          |          |          |   yes    |
+---------------+----------+----------+----------+----------+----------+
</code></pre></div><ul><li><strong>Also: <code>'isspace()'</code> checks for <code>'[ \t\n\r\f\v…]'</code>.</strong></li></ul> <h2 id="regex">Regex</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> re
<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>   <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token operator">&lt;</span>regex<span class="token operator">&gt;</span><span class="token punctuation">,</span> new<span class="token punctuation">,</span> text<span class="token punctuation">,</span> count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># Substitutes all occurrences with 'new'.</span>
<span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token operator">&lt;</span>regex<span class="token operator">&gt;</span><span class="token punctuation">,</span> text<span class="token punctuation">)</span>            <span class="token comment"># Returns all occurrences as strings.</span>
<span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> re<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token operator">&lt;</span>regex<span class="token operator">&gt;</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> maxsplit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># Use brackets in regex to include the matches.</span>
<span class="token operator">&lt;</span>Match<span class="token operator">&gt;</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token operator">&lt;</span>regex<span class="token operator">&gt;</span><span class="token punctuation">,</span> text<span class="token punctuation">)</span>             <span class="token comment"># Searches for first occurrence of the pattern.</span>
<span class="token operator">&lt;</span>Match<span class="token operator">&gt;</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>match<span class="token punctuation">(</span><span class="token operator">&lt;</span>regex<span class="token operator">&gt;</span><span class="token punctuation">,</span> text<span class="token punctuation">)</span>              <span class="token comment"># Searches only at the beginning of the text.</span>
<span class="token operator">&lt;</span><span class="token builtin">iter</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> re<span class="token punctuation">.</span>finditer<span class="token punctuation">(</span><span class="token operator">&lt;</span>regex<span class="token operator">&gt;</span><span class="token punctuation">,</span> text<span class="token punctuation">)</span>           <span class="token comment"># Returns all occurrences as match objects.</span>
</code></pre></div><ul><li><strong>Search() and match() return None if they can't find a match.</strong></li> <li><strong>Argument <code>'flags=re.IGNORECASE'</code> can be used with all functions.</strong></li> <li><strong>Argument <code>'flags=re.MULTILINE'</code> makes <code>'^'</code> and <code>'$'</code> match the start/end of each line.</strong></li> <li><strong>Argument <code>'flags=re.DOTALL'</code> makes dot also accept the <code>'\n'</code>.</strong></li> <li><strong>Use <code>r'\1'</code> or <code>'\\1'</code> for backreference.</strong></li> <li><strong>Add <code>'?'</code> after an operator to make it non-greedy.</strong></li></ul> <h3 id="match-object">Match Object</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>   <span class="token operator">=</span> <span class="token operator">&lt;</span>Match<span class="token operator">&gt;</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token punctuation">)</span>                      <span class="token comment"># Returns the whole match. Also group(0).</span>
<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>   <span class="token operator">=</span> <span class="token operator">&lt;</span>Match<span class="token operator">&gt;</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>                     <span class="token comment"># Returns part in the first bracket.</span>
<span class="token operator">&lt;</span><span class="token builtin">tuple</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>Match<span class="token operator">&gt;</span><span class="token punctuation">.</span>groups<span class="token punctuation">(</span><span class="token punctuation">)</span>                     <span class="token comment"># Returns all bracketed parts.</span>
<span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>   <span class="token operator">=</span> <span class="token operator">&lt;</span>Match<span class="token operator">&gt;</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>                      <span class="token comment"># Returns start index of the match.</span>
<span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>   <span class="token operator">=</span> <span class="token operator">&lt;</span>Match<span class="token operator">&gt;</span><span class="token punctuation">.</span>end<span class="token punctuation">(</span><span class="token punctuation">)</span>                        <span class="token comment"># Returns exclusive end index of the match.</span>
</code></pre></div><h3 id="special-sequences">Special Sequences</h3> <ul><li><strong>By default digits, alphanumerics and whitespaces from all alphabets are matched, unless <code>'flags=re.ASCII'</code> argument is used.</strong></li> <li><strong>Use a capital letter for negation.</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token string">'\d'</span> <span class="token operator">==</span> <span class="token string">'[0-9]'</span>                                <span class="token comment"># Matches any digit.</span>
<span class="token string">'\w'</span> <span class="token operator">==</span> <span class="token string">'[a-zA-Z0-9_]'</span>                         <span class="token comment"># Matches any alphanumeric.</span>
<span class="token string">'\s'</span> <span class="token operator">==</span> <span class="token string">'[ \t\n\r\f\v]'</span>                        <span class="token comment"># Matches any whitespace.</span>
</code></pre></div><h2 id="format">Format</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token operator">&lt;</span>el_1<span class="token operator">&gt;</span><span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token operator">&lt;</span>el_2<span class="token operator">&gt;</span><span class="token punctuation">}</span></span><span class="token string">'</span></span>
<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token string">'{}, {}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>el_1<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>el_2<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="attributes">Attributes</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> collections <span class="token keyword">import</span> namedtuple
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Person <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'Person'</span><span class="token punctuation">,</span> <span class="token string">'name height'</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> person <span class="token operator">=</span> Person<span class="token punctuation">(</span><span class="token string">'Jean-Luc'</span><span class="token punctuation">,</span> <span class="token number">187</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>person<span class="token punctuation">.</span>height<span class="token punctuation">}</span></span><span class="token string">'</span></span>
<span class="token string">'187'</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token string">'{p.height}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>p<span class="token operator">=</span>person<span class="token punctuation">)</span>
<span class="token string">'187'</span>
</code></pre></div><h3 id="general-options">General Options</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token punctuation">{</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">:</span><span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">}</span>                                     <span class="token comment"># '&lt;el&gt;      '</span>
<span class="token punctuation">{</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">:</span><span class="token operator">^</span><span class="token number">10</span><span class="token punctuation">}</span>                                     <span class="token comment"># '   &lt;el&gt;   '</span>
<span class="token punctuation">{</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">:</span><span class="token operator">&gt;</span><span class="token number">10</span><span class="token punctuation">}</span>                                     <span class="token comment"># '      &lt;el&gt;'</span>
<span class="token punctuation">{</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">:</span><span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">}</span>                                    <span class="token comment"># '&lt;el&gt;......'</span>
<span class="token punctuation">{</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">:</span><span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">}</span>                                      <span class="token comment"># '&lt;el&gt;'</span>
</code></pre></div><h3 id="strings">Strings</h3> <p><strong><code>'!r'</code> calls object's <a href="#class">repr()</a> method, instead of <a href="#class">str()</a>, to get a string.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token punctuation">{</span><span class="token string">'abcde'</span>!r<span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">}</span>                                 <span class="token comment"># &quot;'abcde'   &quot;</span>
<span class="token punctuation">{</span><span class="token string">'abcde'</span><span class="token punctuation">:</span><span class="token number">10.3</span><span class="token punctuation">}</span>                                 <span class="token comment"># 'abc       '</span>
<span class="token punctuation">{</span><span class="token string">'abcde'</span><span class="token punctuation">:</span><span class="token number">.3</span><span class="token punctuation">}</span>                                   <span class="token comment"># 'abc'</span>
</code></pre></div><h3 id="numbers">Numbers</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token punctuation">{</span> <span class="token number">123456</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token punctuation">}</span>                                  <span class="token comment"># '   123,456'</span>
<span class="token punctuation">{</span> <span class="token number">123456</span><span class="token punctuation">:</span>10_<span class="token punctuation">}</span>                                  <span class="token comment"># '   123_456'</span>
<span class="token punctuation">{</span> <span class="token number">123456</span><span class="token punctuation">:</span><span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">}</span>                                  <span class="token comment"># '   +123456'</span>
<span class="token punctuation">{</span><span class="token operator">-</span><span class="token number">123456</span><span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">}</span>                                  <span class="token comment"># '-   123456'</span>
<span class="token punctuation">{</span> <span class="token number">123456</span><span class="token punctuation">:</span> <span class="token punctuation">}</span>                                    <span class="token comment"># ' 123456'</span>
<span class="token punctuation">{</span><span class="token operator">-</span><span class="token number">123456</span><span class="token punctuation">:</span> <span class="token punctuation">}</span>                                    <span class="token comment"># '-123456'</span>
</code></pre></div><h3 id="floats">Floats</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token punctuation">{</span><span class="token number">1.23456</span><span class="token punctuation">:</span><span class="token number">10.3</span><span class="token punctuation">}</span>                                 <span class="token comment"># '      1.23'</span>
<span class="token punctuation">{</span><span class="token number">1.23456</span><span class="token punctuation">:</span><span class="token number">10.</span><span class="token number">3f</span><span class="token punctuation">}</span>                                <span class="token comment"># '     1.235'</span>
<span class="token punctuation">{</span><span class="token number">1.23456</span><span class="token punctuation">:</span><span class="token number">10.</span><span class="token number">3e</span><span class="token punctuation">}</span>                                <span class="token comment"># ' 1.235e+00'</span>
<span class="token punctuation">{</span><span class="token number">1.23456</span><span class="token punctuation">:</span><span class="token number">10.3</span><span class="token operator">%</span><span class="token punctuation">}</span>                                <span class="token comment"># '  123.456%'</span>
</code></pre></div><h4 id="comparison-of-presentation-types">Comparison of presentation types:</h4> <div class="language-text extra-class"><pre class="language-text"><code>+---------------+-----------------+-----------------+-----------------+-----------------+
|               |    {&lt;float&gt;}    |   {&lt;float&gt;:f}   |   {&lt;float&gt;:e}   |   {&lt;float&gt;:%}   |
+---------------+-----------------+-----------------+-----------------+-----------------+
|   0.000056789 |    '5.6789e-05' |     '0.000057'  |  '5.678900e-05' |     '0.005679%' |
|   0.00056789  |    '0.00056789' |     '0.000568'  |  '5.678900e-04' |     '0.056789%' |
|   0.0056789   |    '0.0056789'  |     '0.005679'  |  '5.678900e-03' |     '0.567890%' |
|   0.056789    |    '0.056789'   |     '0.056789'  |  '5.678900e-02' |     '5.678900%' |
|   0.56789     |    '0.56789'    |     '0.567890'  |  '5.678900e-01' |    '56.789000%' |
|   5.6789      |    '5.6789'     |     '5.678900'  |  '5.678900e+00' |   '567.890000%' |
|  56.789       |   '56.789'      |    '56.789000'  |  '5.678900e+01' |  '5678.900000%' |
| 567.89        |  '567.89'       |   '567.890000'  |  '5.678900e+02' | '56789.000000%' |
+---------------+-----------------+-----------------+-----------------+-----------------+
</code></pre></div><div class="language-text extra-class"><pre class="language-text"><code>+---------------+-----------------+-----------------+-----------------+-----------------+
|               |   {&lt;float&gt;:.2}  |  {&lt;float&gt;:.2f}  |  {&lt;float&gt;:.2e}  |  {&lt;float&gt;:.2%}  |
+---------------+-----------------+-----------------+-----------------+-----------------+
|   0.000056789 |    '5.7e-05'    |       '0.00'    |    '5.68e-05'   |       '0.01%'   |
|   0.00056789  |    '0.00057'    |       '0.00'    |    '5.68e-04'   |       '0.06%'   |
|   0.0056789   |    '0.0057'     |       '0.01'    |    '5.68e-03'   |       '0.57%'   |
|   0.056789    |    '0.057'      |       '0.06'    |    '5.68e-02'   |       '5.68%'   |
|   0.56789     |    '0.57'       |       '0.57'    |    '5.68e-01'   |      '56.79%'   |
|   5.6789      |    '5.7'        |       '5.68'    |    '5.68e+00'   |     '567.89%'   |
|  56.789       |    '5.7e+01'    |      '56.79'    |    '5.68e+01'   |    '5678.90%'   |
| 567.89        |    '5.7e+02'    |     '567.89'    |    '5.68e+02'   |   '56789.00%'   |
+---------------+-----------------+-----------------+-----------------+-----------------+
</code></pre></div><h3 id="ints">Ints</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token punctuation">{</span><span class="token number">90</span><span class="token punctuation">:</span>c<span class="token punctuation">}</span>                                <span class="token comment"># 'Z'</span>
<span class="token punctuation">{</span><span class="token number">90</span><span class="token punctuation">:</span>b<span class="token punctuation">}</span>                                <span class="token comment"># '1011010'</span>
<span class="token punctuation">{</span><span class="token number">90</span><span class="token punctuation">:</span>X<span class="token punctuation">}</span>                                <span class="token comment"># '5A'</span>
</code></pre></div><h2 id="numbers-2">Numbers</h2> <h3 id="types">Types</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>      <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">float</span><span class="token operator">/</span><span class="token builtin">str</span><span class="token operator">/</span><span class="token builtin">bool</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>    <span class="token comment"># Or: math.floor(&lt;float&gt;)</span>
<span class="token operator">&lt;</span><span class="token builtin">float</span><span class="token operator">&gt;</span>    <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">/</span><span class="token builtin">str</span><span class="token operator">/</span><span class="token builtin">bool</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>    <span class="token comment"># Or: &lt;real&gt;e±&lt;int&gt;</span>
<span class="token operator">&lt;</span><span class="token builtin">complex</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token builtin">complex</span><span class="token punctuation">(</span>real<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> imag<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># Or: &lt;real&gt; ± &lt;real&gt;j</span>
<span class="token operator">&lt;</span>Fraction<span class="token operator">&gt;</span> <span class="token operator">=</span> fractions<span class="token punctuation">.</span>Fraction<span class="token punctuation">(</span>numerator<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> denominator<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>Decimal<span class="token operator">&gt;</span>  <span class="token operator">=</span> decimal<span class="token punctuation">.</span>Decimal<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">/</span><span class="token builtin">int</span><span class="token operator">/</span><span class="token builtin">float</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><strong><code>'int(&lt;str&gt;)'</code> and <code>'float(&lt;str&gt;)'</code> raise ValueError on malformed strings.</strong></li> <li><strong>Decimal numbers can be represented exactly, unlike floats where <code>'1.1 + 2.2 != 3.3'</code>.</strong></li> <li><strong>Precision of decimal operations is set with: <code>'decimal.getcontext().prec = &lt;int&gt;'</code>.</strong></li></ul> <h3 id="basic-functions">Basic Functions</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span>num<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>num<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>num<span class="token operator">&gt;</span><span class="token punctuation">)</span>             <span class="token comment"># Or: &lt;num&gt; ** &lt;num&gt;</span>
<span class="token operator">&lt;</span>num<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">abs</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>num<span class="token operator">&gt;</span><span class="token punctuation">)</span>                    <span class="token comment"># &lt;float&gt; = abs(&lt;complex&gt;)</span>
<span class="token operator">&lt;</span>num<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">round</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>num<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> ±ndigits<span class="token punctuation">]</span><span class="token punctuation">)</span>     <span class="token comment"># `round(126, -1) == 130`</span>
</code></pre></div><h3 id="math">Math</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> math <span class="token keyword">import</span> e<span class="token punctuation">,</span> pi<span class="token punctuation">,</span> inf<span class="token punctuation">,</span> nan
<span class="token keyword">from</span> math <span class="token keyword">import</span> cos<span class="token punctuation">,</span> acos<span class="token punctuation">,</span> sin<span class="token punctuation">,</span> asin<span class="token punctuation">,</span> tan<span class="token punctuation">,</span> atan<span class="token punctuation">,</span> degrees<span class="token punctuation">,</span> radians
<span class="token keyword">from</span> math <span class="token keyword">import</span> log<span class="token punctuation">,</span> log10<span class="token punctuation">,</span> log2
</code></pre></div><h3 id="statistics">Statistics</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> statistics <span class="token keyword">import</span> mean<span class="token punctuation">,</span> median<span class="token punctuation">,</span> variance<span class="token punctuation">,</span> pvariance<span class="token punctuation">,</span> pstdev
</code></pre></div><h3 id="random">Random</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> random <span class="token keyword">import</span> random<span class="token punctuation">,</span> randint<span class="token punctuation">,</span> choice<span class="token punctuation">,</span> shuffle
<span class="token operator">&lt;</span><span class="token builtin">float</span><span class="token operator">&gt;</span> <span class="token operator">=</span> random<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>   <span class="token operator">=</span> randint<span class="token punctuation">(</span>from_inclusive<span class="token punctuation">,</span> to_inclusive<span class="token punctuation">)</span>
<span class="token operator">&lt;</span>el<span class="token operator">&gt;</span>    <span class="token operator">=</span> choice<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
shuffle<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="bin-hex">Bin, Hex</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>     <span class="token operator">=</span> <span class="token number">0b</span><span class="token operator">&lt;</span><span class="token builtin">bin</span><span class="token operator">&gt;</span>                   <span class="token comment"># Or: 0x&lt;hex&gt;</span>
<span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>     <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token string">'&lt;bin&gt;'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>           <span class="token comment"># Or: int('&lt;hex&gt;', 16)</span>
<span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>     <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token string">'0b&lt;bin&gt;'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>         <span class="token comment"># Or: int('0x&lt;hex&gt;', 0)</span>
<span class="token string">'0b&lt;bin&gt;'</span> <span class="token operator">=</span> <span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>                <span class="token comment"># Or: hex(&lt;int&gt;)</span>
</code></pre></div><h3 id="bitwise-operators">Bitwise Operators</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>     <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span> <span class="token operator">&amp;</span> <span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>             <span class="token comment"># And</span>
<span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>     <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>             <span class="token comment"># Or</span>
<span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>     <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span> <span class="token operator">^</span> <span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>             <span class="token comment"># Xor (0 if both bits equal)</span>
<span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>     <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span> <span class="token operator">&lt;&lt;</span> n_bits           <span class="token comment"># Shift left</span>
<span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>     <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span> <span class="token operator">&gt;&gt;</span> n_bits           <span class="token comment"># Shift right</span>
<span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>     <span class="token operator">=</span> <span class="token operator">~</span><span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>                    <span class="token comment"># Compliment (flips bits)</span>
</code></pre></div><h2 id="combinatorics">Combinatorics</h2> <ul><li><strong>Every function returns an iterator.</strong></li> <li><strong>If you want to print the iterator, you need to pass it to the list() function first!</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> itertools <span class="token keyword">import</span> product<span class="token punctuation">,</span> combinations<span class="token punctuation">,</span> combinations_with_replacement<span class="token punctuation">,</span> permutations

<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> product<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> repeat<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> product<span class="token punctuation">(</span><span class="token string">'ab'</span><span class="token punctuation">,</span> <span class="token string">'12'</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> combinations<span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> combinations_with_replacement<span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token punctuation">(</span><span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> permutations<span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token punctuation">(</span><span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><h2 id="datetime">Datetime</h2> <ul><li><strong>Module 'datetime' provides 'date' <code>&lt;D&gt;</code>, 'time' <code>&lt;T&gt;</code>, 'datetime' <code>&lt;DT&gt;</code> and 'timedelta' <code>&lt;TD&gt;</code> classes. All are immutable and hashable.</strong></li> <li><strong>Time and datetime objects can be 'aware' <code>&lt;a&gt;</code>, meaning they have defined timezone, or 'naive' <code>&lt;n&gt;</code>, meaning they don't.</strong></li> <li><strong>If object is naive, it is presumed to be in the system's timezone.</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> datetime <span class="token keyword">import</span> date<span class="token punctuation">,</span> time<span class="token punctuation">,</span> datetime<span class="token punctuation">,</span> timedelta
<span class="token keyword">from</span> dateutil<span class="token punctuation">.</span>tz <span class="token keyword">import</span> UTC<span class="token punctuation">,</span> tzlocal<span class="token punctuation">,</span> gettz<span class="token punctuation">,</span> resolve_imaginary
</code></pre></div><h3 id="constructors">Constructors</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span>D<span class="token operator">&gt;</span>  <span class="token operator">=</span> date<span class="token punctuation">(</span>year<span class="token punctuation">,</span> month<span class="token punctuation">,</span> day<span class="token punctuation">)</span>
<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span>  <span class="token operator">=</span> time<span class="token punctuation">(</span>hour<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> minute<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> second<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> microsecond<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> tzinfo<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> fold<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>DT<span class="token operator">&gt;</span> <span class="token operator">=</span> datetime<span class="token punctuation">(</span>year<span class="token punctuation">,</span> month<span class="token punctuation">,</span> day<span class="token punctuation">,</span> hour<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> minute<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> second<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>TD<span class="token operator">&gt;</span> <span class="token operator">=</span> timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> seconds<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> microseconds<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> milliseconds<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                 minutes<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> hours<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> weeks<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><strong>Use <code>'&lt;D/DT&gt;.weekday()'</code> to get the day of the week (Mon == 0).</strong></li> <li><strong><code>'fold=1'</code> means the second pass in case of time jumping back for one hour.</strong></li> <li><strong><code>'&lt;DTa&gt; = resolve_imaginary(&lt;DTa&gt;)'</code> fixes DTs that fall into the missing hour.</strong></li></ul> <h3 id="now">Now</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span>D<span class="token operator">/</span>DTn<span class="token operator">&gt;</span>  <span class="token operator">=</span> D<span class="token operator">/</span>DT<span class="token punctuation">.</span>today<span class="token punctuation">(</span><span class="token punctuation">)</span>                     <span class="token comment"># Current local date or naive datetime.</span>
<span class="token operator">&lt;</span>DTn<span class="token operator">&gt;</span>    <span class="token operator">=</span> DT<span class="token punctuation">.</span>utcnow<span class="token punctuation">(</span><span class="token punctuation">)</span>                      <span class="token comment"># Naive datetime from current UTC time.</span>
<span class="token operator">&lt;</span>DTa<span class="token operator">&gt;</span>    <span class="token operator">=</span> DT<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token operator">&lt;</span>tzinfo<span class="token operator">&gt;</span><span class="token punctuation">)</span>                 <span class="token comment"># Aware datetime from current tz time.</span>
</code></pre></div><ul><li><strong>To extract time use <code>'&lt;DTn&gt;.time()'</code>, <code>'&lt;DTa&gt;.time()'</code> or <code>'&lt;DTa&gt;.timetz()'</code>.</strong></li></ul> <h3 id="timezone">Timezone</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span>tzinfo<span class="token operator">&gt;</span> <span class="token operator">=</span> UTC                              <span class="token comment"># UTC timezone. London without DST.</span>
<span class="token operator">&lt;</span>tzinfo<span class="token operator">&gt;</span> <span class="token operator">=</span> tzlocal<span class="token punctuation">(</span><span class="token punctuation">)</span>                        <span class="token comment"># Local timezone. Also gettz().</span>
<span class="token operator">&lt;</span>tzinfo<span class="token operator">&gt;</span> <span class="token operator">=</span> gettz<span class="token punctuation">(</span><span class="token string">'&lt;Cont.&gt;/&lt;City&gt;'</span><span class="token punctuation">)</span>          <span class="token comment"># 'Continent/City_Name' timezone or None.</span>
<span class="token operator">&lt;</span>DTa<span class="token operator">&gt;</span>    <span class="token operator">=</span> <span class="token operator">&lt;</span>DT<span class="token operator">&gt;</span><span class="token punctuation">.</span>astimezone<span class="token punctuation">(</span><span class="token operator">&lt;</span>tzinfo<span class="token operator">&gt;</span><span class="token punctuation">)</span>        <span class="token comment"># Datetime, converted to passed timezone.</span>
<span class="token operator">&lt;</span>Ta<span class="token operator">/</span>DTa<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>T<span class="token operator">/</span>DT<span class="token operator">&gt;</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span>tzinfo<span class="token operator">=</span><span class="token operator">&lt;</span>tzinfo<span class="token operator">&gt;</span><span class="token punctuation">)</span>  <span class="token comment"># Unconverted object with new timezone.</span>
</code></pre></div><h3 id="encode">Encode</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span>D<span class="token operator">/</span>T<span class="token operator">/</span>DT<span class="token operator">&gt;</span> <span class="token operator">=</span> D<span class="token operator">/</span>T<span class="token operator">/</span>DT<span class="token punctuation">.</span>fromisoformat<span class="token punctuation">(</span><span class="token string">'&lt;iso&gt;'</span><span class="token punctuation">)</span>    <span class="token comment"># Object from ISO string. Raises ValueError.</span>
<span class="token operator">&lt;</span>DT<span class="token operator">&gt;</span>     <span class="token operator">=</span> DT<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token string">'&lt;format&gt;'</span><span class="token punctuation">)</span>   <span class="token comment"># Datetime from str, according to format.</span>
<span class="token operator">&lt;</span>D<span class="token operator">/</span>DTn<span class="token operator">&gt;</span>  <span class="token operator">=</span> D<span class="token operator">/</span>DT<span class="token punctuation">.</span>fromordinal<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>          <span class="token comment"># D/DTn from days since Christ, at midnight.</span>
<span class="token operator">&lt;</span>DTn<span class="token operator">&gt;</span>    <span class="token operator">=</span> DT<span class="token punctuation">.</span>fromtimestamp<span class="token punctuation">(</span><span class="token operator">&lt;</span>real<span class="token operator">&gt;</span><span class="token punctuation">)</span>         <span class="token comment"># Local time DTn from seconds since Epoch.</span>
<span class="token operator">&lt;</span>DTa<span class="token operator">&gt;</span>    <span class="token operator">=</span> DT<span class="token punctuation">.</span>fromtimestamp<span class="token punctuation">(</span><span class="token operator">&lt;</span>real<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>tz<span class="token punctuation">.</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>  <span class="token comment"># Aware datetime from seconds since Epoch.</span>
</code></pre></div><ul><li><strong>ISO strings come in following forms: <code>'YYYY-MM-DD'</code>, <code>'HH:MM:SS.ffffff[±&lt;offset&gt;]'</code>, or both separated by an arbitrary character. Offset is formatted as: <code>'HH:MM'</code>.</strong></li> <li><strong>Epoch on Unix systems is: <code>'1970-01-01 00:00 UTC'</code>, <code>'1970-01-01 01:00 CET'</code>, ...</strong></li></ul> <h3 id="decode">Decode</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>    <span class="token operator">=</span> <span class="token operator">&lt;</span>D<span class="token operator">/</span>T<span class="token operator">/</span>DT<span class="token operator">&gt;</span><span class="token punctuation">.</span>isoformat<span class="token punctuation">(</span>sep<span class="token operator">=</span><span class="token string">'T'</span><span class="token punctuation">)</span>      <span class="token comment"># Also timespec='auto/hours/minutes/seconds'.</span>
<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>    <span class="token operator">=</span> <span class="token operator">&lt;</span>D<span class="token operator">/</span>T<span class="token operator">/</span>DT<span class="token operator">&gt;</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'&lt;format&gt;'</span><span class="token punctuation">)</span>    <span class="token comment"># Custom string representation.</span>
<span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>    <span class="token operator">=</span> <span class="token operator">&lt;</span>D<span class="token operator">/</span>DT<span class="token operator">&gt;</span><span class="token punctuation">.</span>toordinal<span class="token punctuation">(</span><span class="token punctuation">)</span>               <span class="token comment"># Days since Christ, ignoring time and tz.</span>
<span class="token operator">&lt;</span><span class="token builtin">float</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span>DTn<span class="token operator">&gt;</span><span class="token punctuation">.</span>timestamp<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token comment"># Seconds since Epoch, from DTn in local tz.</span>
<span class="token operator">&lt;</span><span class="token builtin">float</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span>DTa<span class="token operator">&gt;</span><span class="token punctuation">.</span>timestamp<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token comment"># Seconds since Epoch, from DTa.</span>
</code></pre></div><h3 id="format-2">Format</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> dt <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span><span class="token string">'2015-05-14 23:39:00.00 +0200'</span><span class="token punctuation">,</span> <span class="token string">'%Y-%m-%d %H:%M:%S.%f %z'</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> dt<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">&quot;%A, %dth of %B '%y, %I:%M%p %Z&quot;</span><span class="token punctuation">)</span>
<span class="token string">&quot;Thursday, 14th of May '15, 11:39PM UTC+02:00&quot;</span>
</code></pre></div><ul><li><strong>When parsing, <code>'%z'</code> also accepts <code>'±HH:MM'</code>.</strong></li> <li><strong>For abbreviated weekday and month use <code>'%a'</code> and <code>'%b'</code>.</strong></li></ul> <h3 id="arithmetics">Arithmetics</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span>D<span class="token operator">/</span>DT<span class="token operator">&gt;</span>   <span class="token operator">=</span> <span class="token operator">&lt;</span>D<span class="token operator">/</span>DT<span class="token operator">&gt;</span>   ± <span class="token operator">&lt;</span>TD<span class="token operator">&gt;</span>                  <span class="token comment"># Returned datetime can fall into missing hour.</span>
<span class="token operator">&lt;</span>TD<span class="token operator">&gt;</span>     <span class="token operator">=</span> <span class="token operator">&lt;</span>D<span class="token operator">/</span>DTn<span class="token operator">&gt;</span>  <span class="token operator">-</span> <span class="token operator">&lt;</span>D<span class="token operator">/</span>DTn<span class="token operator">&gt;</span>               <span class="token comment"># Returns the difference, ignoring time jumps.</span>
<span class="token operator">&lt;</span>TD<span class="token operator">&gt;</span>     <span class="token operator">=</span> <span class="token operator">&lt;</span>DTa<span class="token operator">&gt;</span>    <span class="token operator">-</span> <span class="token operator">&lt;</span>DTa<span class="token operator">&gt;</span>                 <span class="token comment"># Ignores time jumps if they share tzinfo object.</span>
<span class="token operator">&lt;</span>TD<span class="token operator">&gt;</span>     <span class="token operator">=</span> <span class="token operator">&lt;</span>DT_UTC<span class="token operator">&gt;</span> <span class="token operator">-</span> <span class="token operator">&lt;</span>DT_UTC<span class="token operator">&gt;</span>              <span class="token comment"># Convert DTs to UTC to get the actual delta.</span>
</code></pre></div><h2 id="arguments">Arguments</h2> <h3 id="inside-function-call">Inside Function Call</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span>function<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>positional_args<span class="token operator">&gt;</span><span class="token punctuation">)</span>                  <span class="token comment"># f(0, 0)</span>
<span class="token operator">&lt;</span>function<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>keyword_args<span class="token operator">&gt;</span><span class="token punctuation">)</span>                     <span class="token comment"># f(x=0, y=0)</span>
<span class="token operator">&lt;</span>function<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>positional_args<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>keyword_args<span class="token operator">&gt;</span><span class="token punctuation">)</span>  <span class="token comment"># f(0, y=0)</span>
</code></pre></div><h3 id="inside-function-definition">Inside Function Definition</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>nondefault_args<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                      <span class="token comment"># def f(x, y):</span>
<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>default_args<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                         <span class="token comment"># def f(x=0, y=0):</span>
<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>nondefault_args<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>default_args<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>      <span class="token comment"># def f(x, y=0):</span>
</code></pre></div><h2 id="splat-operator">Splat Operator</h2> <h3 id="inside-function-call-2">Inside Function Call</h3> <p><strong>Splat expands a collection into positional arguments, while splatty-splat expands a dictionary into keyword arguments.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code>args   <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
kwargs <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'x'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'z'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">}</span>
func<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
</code></pre></div><h4 id="is-the-same-as">Is the same as:</h4> <div class="language-python extra-class"><pre class="language-python"><code>func<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> x<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> z<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="inside-function-definition-2">Inside Function Definition</h3> <p><strong>Splat combines zero or more positional arguments into a tuple, while splatty-splat combines zero or more keyword arguments into a dictionary.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token operator">*</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>

<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">6</span>
</code></pre></div><h4 id="legal-argument-combinations">Legal argument combinations:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token comment"># f(x=1, y=2, z=3) | f(1, y=2, z=3) | f(1, 2, z=3) | f(1, 2, 3)</span>
<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">:</span>             <span class="token comment"># f(x=1, y=2, z=3)</span>
<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">:</span>             <span class="token comment"># f(x=1, y=2, z=3) | f(1, y=2, z=3)</span>
<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">:</span>             <span class="token comment"># f(x=1, y=2, z=3) | f(1, y=2, z=3) | f(1, 2, z=3)</span>

<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>                  <span class="token comment"># f(1, 2, 3)</span>
<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>               <span class="token comment"># f(1, 2, 3)</span>
<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">:</span>               <span class="token comment"># f(1, 2, z=3)</span>
<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token comment"># f(1, 2, z=3)</span>

<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>               <span class="token comment"># f(x=1, y=2, z=3)</span>
<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token comment"># f(x=1, y=2, z=3) | f(1, y=2, z=3)</span>
<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>         <span class="token comment"># f(x=1, y=2, z=3)</span>

<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment"># f(x=1, y=2, z=3) | f(1, y=2, z=3) | f(1, 2, z=3) | f(1, 2, 3)</span>
<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>     <span class="token comment"># f(x=1, y=2, z=3) | f(1, y=2, z=3) | f(1, 2, z=3) | f(1, 2, 3)</span>
<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>     <span class="token comment"># f(x=1, y=2, z=3) | f(1, y=2, z=3)</span>
<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> z<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># f(x=1, y=2, z=3) | f(1, y=2, z=3) | f(1, 2, z=3)</span>
</code></pre></div><h3 id="other-uses">Other Uses</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">*</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token operator">&lt;</span><span class="token builtin">set</span><span class="token operator">&gt;</span>   <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">*</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token builtin">tuple</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token builtin">dict</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">**</span><span class="token operator">&lt;</span><span class="token builtin">dict</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">}</span>

head<span class="token punctuation">,</span> <span class="token operator">*</span>body<span class="token punctuation">,</span> tail <span class="token operator">=</span> <span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span>
</code></pre></div><h2 id="inline">Inline</h2> <h3 id="lambda">Lambda</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span>function<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token keyword">lambda</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>return_value<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>function<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token keyword">lambda</span> <span class="token operator">&lt;</span>argument_1<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>argument_2<span class="token operator">&gt;</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>return_value<span class="token operator">&gt;</span>
</code></pre></div><h3 id="comprehension">Comprehension</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">]</span>                   <span class="token comment"># [1, 2, ..., 10]</span>
<span class="token operator">&lt;</span><span class="token builtin">set</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token punctuation">{</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">if</span> i <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">}</span>            <span class="token comment"># {6, 7, 8, 9}</span>
<span class="token operator">&lt;</span><span class="token builtin">iter</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">5</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                   <span class="token comment"># (5, 6, ..., 14)</span>
<span class="token operator">&lt;</span><span class="token builtin">dict</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span>i<span class="token punctuation">:</span> i<span class="token operator">*</span><span class="token number">2</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">}</span>                <span class="token comment"># {0: 0, 1: 2, ..., 9: 18}</span>

out <span class="token operator">=</span> <span class="token punctuation">[</span>i<span class="token operator">+</span>j <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><h4 id="is-the-same-as-2">Is the same as:</h4> <div class="language-python extra-class"><pre class="language-python"><code>out <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        out<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token operator">+</span>j<span class="token punctuation">)</span>
</code></pre></div><h3 id="map-filter-reduce">Map, Filter, Reduce</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> functools <span class="token keyword">import</span> <span class="token builtin">reduce</span>
<span class="token operator">&lt;</span><span class="token builtin">iter</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token comment"># (1, 2, ..., 10)</span>
<span class="token operator">&lt;</span><span class="token builtin">iter</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>         <span class="token comment"># (6, 7, 8, 9)</span>
<span class="token operator">&lt;</span>obj<span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> out<span class="token punctuation">,</span> x<span class="token punctuation">:</span> out <span class="token operator">+</span> x<span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 45</span>
</code></pre></div><h3 id="any-all">Any, All</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">bool</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">)</span>                          <span class="token comment"># False if empty.</span>
<span class="token operator">&lt;</span><span class="token builtin">bool</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">all</span><span class="token punctuation">(</span>el<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">for</span> el <span class="token keyword">in</span> <span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">)</span>          <span class="token comment"># True if empty.</span>
</code></pre></div><h3 id="if-else">If - Else</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span>obj<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>expression_if_true<span class="token operator">&gt;</span> <span class="token keyword">if</span> <span class="token operator">&lt;</span>condition<span class="token operator">&gt;</span> <span class="token keyword">else</span> <span class="token operator">&lt;</span>expression_if_false<span class="token operator">&gt;</span>

<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>a <span class="token keyword">if</span> a <span class="token keyword">else</span> <span class="token string">'zero'</span> <span class="token keyword">for</span> a <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token string">'zero'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
</code></pre></div><h3 id="namedtuple-enum-dataclass">Namedtuple, Enum, Dataclass</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> collections <span class="token keyword">import</span> namedtuple
Point     <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'Point'</span><span class="token punctuation">,</span> <span class="token string">'x y'</span><span class="token punctuation">)</span>
point     <span class="token operator">=</span> Point<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

<span class="token keyword">from</span> enum <span class="token keyword">import</span> Enum
Direction <span class="token operator">=</span> Enum<span class="token punctuation">(</span><span class="token string">'Direction'</span><span class="token punctuation">,</span> <span class="token string">'n e s w'</span><span class="token punctuation">)</span>
direction <span class="token operator">=</span> Direction<span class="token punctuation">.</span>n

<span class="token keyword">from</span> dataclasses <span class="token keyword">import</span> make_dataclass
Creature  <span class="token operator">=</span> make_dataclass<span class="token punctuation">(</span><span class="token string">'Creature'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'location'</span><span class="token punctuation">,</span> <span class="token string">'direction'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
creature  <span class="token operator">=</span> Creature<span class="token punctuation">(</span>Point<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Direction<span class="token punctuation">.</span>n<span class="token punctuation">)</span>
</code></pre></div><h2 id="closure">Closure</h2> <p><strong>We have a closure in Python when:</strong></p> <ul><li><strong>A nested function references a value of its enclosing function and then</strong></li> <li><strong>the enclosing function returns the nested function.</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_multiplier</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">out</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> a <span class="token operator">*</span> b
    <span class="token keyword">return</span> out

<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> multiply_by_3 <span class="token operator">=</span> get_multiplier<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> multiply_by_3<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token number">30</span>
</code></pre></div><ul><li><strong>If multiple nested functions within enclosing function reference the same value, that value gets shared.</strong></li> <li><strong>To dynamically access function's first free variable use <code>'&lt;function&gt;.__closure__[0].cell_contents'</code>.</strong></li></ul> <h3 id="partial">Partial</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> functools <span class="token keyword">import</span> partial
<span class="token operator">&lt;</span>function<span class="token operator">&gt;</span> <span class="token operator">=</span> partial<span class="token punctuation">(</span><span class="token operator">&lt;</span>function<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>arg_1<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>arg_2<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">import</span> operator <span class="token keyword">as</span> op
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> multiply_by_3 <span class="token operator">=</span> partial<span class="token punctuation">(</span>op<span class="token punctuation">.</span>mul<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> multiply_by_3<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token number">30</span>
</code></pre></div><ul><li><strong>Partial is also useful in cases when function needs to be passed as an argument, because it enables us to set its arguments beforehand.</strong></li> <li><strong>A few examples being: <code>'defaultdict(&lt;function&gt;)'</code>, <code>'iter(&lt;function&gt;, to_exclusive)'</code> and dataclass's <code>'field(default_factory=&lt;function&gt;)'</code>.</strong></li></ul> <h3 id="nonlocal">Nonlocal</h3> <p><strong>If variable is being assigned to anywhere in the scope, it is regarded as a local variable, unless it is declared as a 'global' or a 'nonlocal'.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    i <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">def</span> <span class="token function">out</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">nonlocal</span> i
        i <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">return</span> i
    <span class="token keyword">return</span> out

<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> counter <span class="token operator">=</span> get_counter<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> counter<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> counter<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> counter<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="decorator">Decorator</h2> <p><strong>A decorator takes a function, adds some functionality and returns it.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token decorator annotation punctuation">@decorator_name</span>
<span class="token keyword">def</span> <span class="token function">function_that_gets_passed_to_decorator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><h3 id="debugger-example">Debugger Example</h3> <p><strong>Decorator that prints function's name every time it gets called.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> functools <span class="token keyword">import</span> wraps

<span class="token keyword">def</span> <span class="token function">debug</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token decorator annotation punctuation">@wraps</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">out</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>func<span class="token punctuation">.</span>__name__<span class="token punctuation">)</span>
        <span class="token keyword">return</span> func<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
    <span class="token keyword">return</span> out

<span class="token decorator annotation punctuation">@debug</span>
<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y
</code></pre></div><ul><li><strong>Wraps is a helper decorator that copies the metadata of the passed function (func) to the function it is wrapping (out).</strong></li> <li><strong>Without it <code>'add.__name__'</code> would return <code>'out'</code>.</strong></li></ul> <h3 id="lru-cache">LRU Cache</h3> <p><strong>Decorator that caches function's return values. All function's arguments must be hashable.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> functools <span class="token keyword">import</span> lru_cache

<span class="token decorator annotation punctuation">@lru_cache</span><span class="token punctuation">(</span>maxsize<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">fib</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> n <span class="token keyword">if</span> n <span class="token operator">&lt;</span> <span class="token number">2</span> <span class="token keyword">else</span> fib<span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> fib<span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><strong>CPython interpreter limits recursion depth to 1000 by default. To increase it use <code>'sys.setrecursionlimit(&lt;depth&gt;)'</code>.</strong></li></ul> <h3 id="parametrized-decorator">Parametrized Decorator</h3> <p><strong>A decorator that accepts arguments and returns a normal decorator that accepts a function.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> functools <span class="token keyword">import</span> wraps

<span class="token keyword">def</span> <span class="token function">debug</span><span class="token punctuation">(</span>print_result<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">decorator</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token decorator annotation punctuation">@wraps</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span>
        <span class="token keyword">def</span> <span class="token function">out</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
            result <span class="token operator">=</span> func<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>func<span class="token punctuation">.</span>__name__<span class="token punctuation">,</span> result <span class="token keyword">if</span> print_result <span class="token keyword">else</span> <span class="token string">''</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> result
        <span class="token keyword">return</span> out
    <span class="token keyword">return</span> decorator

<span class="token decorator annotation punctuation">@debug</span><span class="token punctuation">(</span>print_result<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y
</code></pre></div><h2 id="class">Class</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a
    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        class_name <span class="token operator">=</span> self<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__name__
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>class_name<span class="token punctuation">}</span></span><span class="token string">(</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>a<span class="token conversion-option punctuation">!r</span><span class="token punctuation">}</span></span><span class="token string">)'</span></span>
    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>a<span class="token punctuation">)</span>

    <span class="token decorator annotation punctuation">@classmethod</span>
    <span class="token keyword">def</span> <span class="token function">get_class_name</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> cls<span class="token punctuation">.</span>__name__
</code></pre></div><ul><li><strong>Return value of repr() should be unambiguous and of str() readable.</strong></li> <li><strong>If only repr() is defined, it will also be used for str().</strong></li></ul> <h4 id="str-use-cases">Str() use cases:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
<span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">)</span>
loguru<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>debug<span class="token punctuation">(</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">)</span>
csv<span class="token punctuation">.</span>writer<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">file</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>writerow<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="repr-use-cases">Repr() use cases:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token conversion-option punctuation">!r</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span>el<span class="token operator">&gt;</span>
loguru<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token punctuation">)</span>
Z <span class="token operator">=</span> dataclasses<span class="token punctuation">.</span>make_dataclass<span class="token punctuation">(</span><span class="token string">'Z'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>Z<span class="token punctuation">(</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="constructor-overloading">Constructor Overloading</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a
</code></pre></div><h3 id="inheritance">Inheritance</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name
        self<span class="token punctuation">.</span>age  <span class="token operator">=</span> age

<span class="token keyword">class</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span>Person<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> staff_num<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>staff_num <span class="token operator">=</span> staff_num
</code></pre></div><h3 id="multiple-inheritance">Multiple Inheritance</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">:</span> <span class="token keyword">pass</span>
<span class="token keyword">class</span> <span class="token class-name">B</span><span class="token punctuation">:</span> <span class="token keyword">pass</span>
<span class="token keyword">class</span> <span class="token class-name">C</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">pass</span>
</code></pre></div><p><strong>MRO determines the order in which parent classes are traversed when searching for a method:</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> C<span class="token punctuation">.</span>mro<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'C'</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'A'</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'B'</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'object'</span><span class="token operator">&gt;</span><span class="token punctuation">]</span>
</code></pre></div><h3 id="property">Property</h3> <p><strong>Pythonic way of implementing getters and setters.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">MyClass</span><span class="token punctuation">:</span>
    <span class="token decorator annotation punctuation">@property</span>
    <span class="token keyword">def</span> <span class="token function">a</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_a

    <span class="token decorator annotation punctuation">@a<span class="token punctuation">.</span>setter</span>
    <span class="token keyword">def</span> <span class="token function">a</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>_a <span class="token operator">=</span> value

<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> el <span class="token operator">=</span> MyClass<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> el<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">123</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> el<span class="token punctuation">.</span>a
<span class="token number">123</span>
</code></pre></div><h3 id="dataclass">Dataclass</h3> <p><strong>Decorator that automatically generates init(), repr() and eq() special methods.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> dataclasses <span class="token keyword">import</span> dataclass<span class="token punctuation">,</span> field

<span class="token decorator annotation punctuation">@dataclass</span><span class="token punctuation">(</span>order<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> frozen<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token operator">&lt;</span>class_name<span class="token operator">&gt;</span><span class="token punctuation">:</span>
    <span class="token operator">&lt;</span>attr_name_1<span class="token operator">&gt;</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span><span class="token builtin">type</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>attr_name_2<span class="token operator">&gt;</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span><span class="token builtin">type</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>default_value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>attr_name_3<span class="token operator">&gt;</span><span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token operator">/</span><span class="token builtin">dict</span><span class="token operator">/</span><span class="token builtin">set</span> <span class="token operator">=</span> field<span class="token punctuation">(</span>default_factory<span class="token operator">=</span><span class="token builtin">list</span><span class="token operator">/</span><span class="token builtin">dict</span><span class="token operator">/</span><span class="token builtin">set</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><strong>Objects can be made sortable with <code>'order=True'</code> and/or immutable and hashable with <code>'frozen=True'</code>.</strong></li> <li><strong>Function field() is needed because <code>'&lt;attr_name&gt;: list = []'</code> would make a list that is shared among all instances.</strong></li> <li><strong>Default_factory can be any <a href="#callable">callable</a>.</strong></li></ul> <h4 id="inline-2">Inline:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> dataclasses <span class="token keyword">import</span> make_dataclass
<span class="token operator">&lt;</span><span class="token keyword">class</span><span class="token operator">&gt;</span> <span class="token operator">=</span> make_dataclass<span class="token punctuation">(</span><span class="token string">'&lt;class_name&gt;'</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>coll_of_attribute_names<span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token keyword">class</span><span class="token operator">&gt;</span> <span class="token operator">=</span> make_dataclass<span class="token punctuation">(</span><span class="token string">'&lt;class_name&gt;'</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>coll_of_tuples<span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token builtin">tuple</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'&lt;attr_name&gt;'</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>default_value<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="slots">Slots</h3> <p><strong>Mechanism that restricts objects to attributes listed in 'slots' and significantly reduces their memory footprint.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">MyClassWithSlots</span><span class="token punctuation">:</span>
    __slots__ <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span>
</code></pre></div><h3 id="copy">Copy</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> copy <span class="token keyword">import</span> copy<span class="token punctuation">,</span> deepcopy
<span class="token operator">&lt;</span><span class="token builtin">object</span><span class="token operator">&gt;</span> <span class="token operator">=</span> copy<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">object</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token builtin">object</span><span class="token operator">&gt;</span> <span class="token operator">=</span> deepcopy<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">object</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="duck-types">Duck Types</h2> <p><strong>A duck type is an implicit type that prescribes a set of special methods. Any object that has those methods defined is considered a member of that duck type.</strong></p> <h3 id="comparable">Comparable</h3> <ul><li><strong>If eq() method is not overridden, it returns <code>'id(self) == id(other)'</code>, which is the same as <code>'self is other'</code>.</strong></li> <li><strong>That means all objects compare not equal by default.</strong></li> <li><strong>Only the left side object has eq() method called, unless it returns NotImplemented, in which case the right object is consulted.</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">MyComparable</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a
    <span class="token keyword">def</span> <span class="token function">__eq__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>other<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>a <span class="token operator">==</span> other<span class="token punctuation">.</span>a
        <span class="token keyword">return</span> NotImplemented
</code></pre></div><h3 id="hashable">Hashable</h3> <ul><li><strong>Hashable object needs both hash() and eq() methods and its hash value should never change.</strong></li> <li><strong>Hashable objects that compare equal must have the same hash value, meaning default hash() that returns <code>'id(self)'</code> will not do.</strong></li> <li><strong>That is why Python automatically makes classes unhashable if you only implement eq().</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">MyHashable</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>_a <span class="token operator">=</span> a
    <span class="token decorator annotation punctuation">@property</span>
    <span class="token keyword">def</span> <span class="token function">a</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_a
    <span class="token keyword">def</span> <span class="token function">__eq__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>other<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>a <span class="token operator">==</span> other<span class="token punctuation">.</span>a
        <span class="token keyword">return</span> NotImplemented
    <span class="token keyword">def</span> <span class="token function">__hash__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">hash</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>a<span class="token punctuation">)</span>
</code></pre></div><h3 id="sortable">Sortable</h3> <ul><li><strong>With total_ordering decorator you only need to provide eq() and one of lt(), gt(), le() or ge() special methods.</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> functools <span class="token keyword">import</span> total_ordering

<span class="token decorator annotation punctuation">@total_ordering</span>
<span class="token keyword">class</span> <span class="token class-name">MySortable</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a
    <span class="token keyword">def</span> <span class="token function">__eq__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>other<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>a <span class="token operator">==</span> other<span class="token punctuation">.</span>a
        <span class="token keyword">return</span> NotImplemented
    <span class="token keyword">def</span> <span class="token function">__lt__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>other<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>a <span class="token operator">&lt;</span> other<span class="token punctuation">.</span>a
        <span class="token keyword">return</span> NotImplemented
</code></pre></div><h3 id="iterator-2">Iterator</h3> <ul><li><strong>Any object that has methods next() and iter() is an iterator.</strong></li> <li><strong>Next() should return next item or raise StopIteration.</strong></li> <li><strong>Iter() should return 'self'.</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Counter</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>i <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">def</span> <span class="token function">__next__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>i <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>i
    <span class="token keyword">def</span> <span class="token function">__iter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self

<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> counter <span class="token operator">=</span> Counter<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token builtin">next</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">next</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">next</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="python-has-many-different-iterator-objects">Python has many different iterator objects:</h4> <ul><li><strong>Iterators returned by the <a href="#iterator">iter()</a> function, such as list_iterator and set_iterator.</strong></li> <li><strong>Objects returned by the <a href="#itertools">itertools</a> module, such as count, repeat and cycle.</strong></li> <li><strong>Generators returned by the <a href="#generator">generator functions</a> and <a href="#comprehension">generator expressions</a>.</strong></li> <li><strong>File objects returned by the <a href="#open">open()</a> function, etc.</strong></li></ul> <h3 id="callable">Callable</h3> <ul><li><strong>All functions and classes have a call() method, hence are callable.</strong></li> <li><strong>When this cheatsheet uses <code>'&lt;function&gt;'</code> as an argument, it actually means <code>'&lt;callable&gt;'</code>.</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Counter</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>i <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>i <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>i

<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> counter <span class="token operator">=</span> Counter<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> counter<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> counter<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> counter<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="context-manager">Context Manager</h3> <ul><li><strong>Enter() should lock the resources and optionally return an object.</strong></li> <li><strong>Exit() should release the resources.</strong></li> <li><strong>Any exception that happens inside the with block is passed to the exit() method.</strong></li> <li><strong>If it wishes to suppress the exception it must return a true value.</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">MyOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>filename <span class="token operator">=</span> filename
    <span class="token keyword">def</span> <span class="token function">__enter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span><span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>filename<span class="token punctuation">)</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span><span class="token builtin">file</span>
    <span class="token keyword">def</span> <span class="token function">__exit__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> exc_type<span class="token punctuation">,</span> exception<span class="token punctuation">,</span> traceback<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span><span class="token builtin">file</span><span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'test.txt'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>     <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'Hello World!'</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">with</span> MyOpen<span class="token punctuation">(</span><span class="token string">'test.txt'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>     <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
Hello World!
</code></pre></div><h2 id="iterable-duck-types">Iterable Duck Types</h2> <h3 id="iterable">Iterable</h3> <ul><li><strong>Only required method is iter(). It should return an iterator of object's items.</strong></li> <li><strong>Contains() automatically works on any object that has iter() defined.</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">MyIterable</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a
    <span class="token keyword">def</span> <span class="token function">__iter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">iter</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>a<span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">__contains__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> el<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> el <span class="token keyword">in</span> self<span class="token punctuation">.</span>a

<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> obj <span class="token operator">=</span> MyIterable<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>el <span class="token keyword">for</span> el <span class="token keyword">in</span> obj<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token keyword">in</span> obj
<span class="token boolean">True</span>
</code></pre></div><h3 id="collection">Collection</h3> <ul><li><strong>Only required methods are iter() and len().</strong></li> <li><strong>This cheatsheet actually means <code>'&lt;iterable&gt;'</code> when it uses <code>'&lt;collection&gt;'</code>.</strong></li> <li><strong>I chose not to use the name 'iterable' because it sounds scarier and more vague than 'collection'.</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">MyCollection</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a
    <span class="token keyword">def</span> <span class="token function">__iter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">iter</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>a<span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">__contains__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> el<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> el <span class="token keyword">in</span> self<span class="token punctuation">.</span>a
    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>a<span class="token punctuation">)</span>
</code></pre></div><h3 id="sequence">Sequence</h3> <ul><li><strong>Only required methods are len() and getitem().</strong></li> <li><strong>Getitem() should return an item at index or raise IndexError.</strong></li> <li><strong>Iter() and contains() automatically work on any object that has getitem() defined.</strong></li> <li><strong>Reversed() automatically works on any object that has getitem() and len() defined.</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">MySequence</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a
    <span class="token keyword">def</span> <span class="token function">__iter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">iter</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>a<span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">__contains__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> el<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> el <span class="token keyword">in</span> self<span class="token punctuation">.</span>a
    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>a<span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token keyword">def</span> <span class="token function">__reversed__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">reversed</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>a<span class="token punctuation">)</span>
</code></pre></div><h3 id="collections-abc-sequence">Collections.abc.Sequence</h3> <ul><li><strong>It's a richer interface than the basic sequence.</strong></li> <li><strong>Extending it generates iter(), contains(), reversed(), index() and count().</strong></li> <li><strong>Unlike <code>'abc.Iterable'</code> and <code>'abc.Collection'</code>, it is not a duck type. That is why <code>'issubclass(MySequence, abc.Sequence)'</code> would return False even if MySequence had all the methods defined.</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> collections <span class="token keyword">import</span> abc

<span class="token keyword">class</span> <span class="token class-name">MyAbcSequence</span><span class="token punctuation">(</span>abc<span class="token punctuation">.</span>Sequence<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> a
    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>a<span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
</code></pre></div><h4 id="table-of-required-and-automatically-available-special-methods">Table of required and automatically available special methods:</h4> <div class="language-text extra-class"><pre class="language-text"><code>+------------+------------+------------+------------+--------------+
|            |  Iterable  | Collection |  Sequence  | abc.Sequence |
+------------+------------+------------+------------+--------------+
| iter()     |    REQ     |    REQ     |    Yes     |     Yes      |
| contains() |    Yes     |    Yes     |    Yes     |     Yes      |
| len()      |            |    REQ     |    REQ     |     REQ      |
| getitem()  |            |            |    REQ     |     REQ      |
| reversed() |            |            |    Yes     |     Yes      |
| index()    |            |            |            |     Yes      |
| count()    |            |            |            |     Yes      |
+------------+------------+------------+------------+--------------+
</code></pre></div><ul><li><strong>Other ABCs that generate missing methods are: MutableSequence, Set, MutableSet, Mapping and MutableMapping.</strong></li> <li><strong>Names of their required methods are stored in <code>'&lt;abc&gt;.__abstractmethods__'</code>.</strong></li></ul> <h2 id="enum">Enum</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> enum <span class="token keyword">import</span> Enum<span class="token punctuation">,</span> auto

<span class="token keyword">class</span> <span class="token operator">&lt;</span>enum_name<span class="token operator">&gt;</span><span class="token punctuation">(</span>Enum<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token operator">&lt;</span>member_name_1<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>value_1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>member_name_2<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>value_2_a<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>value_2_b<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>member_name_3<span class="token operator">&gt;</span> <span class="token operator">=</span> auto<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><strong>If there are no numeric values before auto(), it returns 1.</strong></li> <li><strong>Otherwise it returns an increment of the last numeric value.</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span>member<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>enum<span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token operator">&lt;</span>member_name<span class="token operator">&gt;</span>                 <span class="token comment"># Returns a member.</span>
<span class="token operator">&lt;</span>member<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>enum<span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token string">'&lt;member_name&gt;'</span><span class="token punctuation">]</span>              <span class="token comment"># Returns a member or raises KeyError.</span>
<span class="token operator">&lt;</span>member<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>enum<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>value<span class="token operator">&gt;</span><span class="token punctuation">)</span>                      <span class="token comment"># Returns a member or raises ValueError.</span>
<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>    <span class="token operator">=</span> <span class="token operator">&lt;</span>member<span class="token operator">&gt;</span><span class="token punctuation">.</span>name                        <span class="token comment"># Returns member's name.</span>
<span class="token operator">&lt;</span>obj<span class="token operator">&gt;</span>    <span class="token operator">=</span> <span class="token operator">&lt;</span>member<span class="token operator">&gt;</span><span class="token punctuation">.</span>value                       <span class="token comment"># Returns member's value.</span>

list_of_members <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>enum<span class="token operator">&gt;</span><span class="token punctuation">)</span>
member_names    <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token punctuation">.</span>name <span class="token keyword">for</span> a <span class="token keyword">in</span> <span class="token operator">&lt;</span>enum<span class="token operator">&gt;</span><span class="token punctuation">]</span>
member_values   <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token punctuation">.</span>value <span class="token keyword">for</span> a <span class="token keyword">in</span> <span class="token operator">&lt;</span>enum<span class="token operator">&gt;</span><span class="token punctuation">]</span>
random_member   <span class="token operator">=</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>enum<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">get_next_member</span><span class="token punctuation">(</span>member<span class="token punctuation">)</span><span class="token punctuation">:</span>
    members <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>member<span class="token punctuation">.</span>__class__<span class="token punctuation">)</span>
    index   <span class="token operator">=</span> <span class="token punctuation">(</span>members<span class="token punctuation">.</span>index<span class="token punctuation">(</span>member<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>members<span class="token punctuation">)</span>
    <span class="token keyword">return</span> members<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
</code></pre></div><h3 id="inline-3">Inline</h3> <div class="language-python extra-class"><pre class="language-python"><code>Cutlery <span class="token operator">=</span> Enum<span class="token punctuation">(</span><span class="token string">'Cutlery'</span><span class="token punctuation">,</span> <span class="token string">'fork knife spoon'</span><span class="token punctuation">)</span>
Cutlery <span class="token operator">=</span> Enum<span class="token punctuation">(</span><span class="token string">'Cutlery'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'fork'</span><span class="token punctuation">,</span> <span class="token string">'knife'</span><span class="token punctuation">,</span> <span class="token string">'spoon'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
Cutlery <span class="token operator">=</span> Enum<span class="token punctuation">(</span><span class="token string">'Cutlery'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'fork'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'knife'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'spoon'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="user-defined-functions-cannot-be-values-so-they-must-be-wrapped">User-defined functions cannot be values, so they must be wrapped:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> functools <span class="token keyword">import</span> partial
LogicOp <span class="token operator">=</span> Enum<span class="token punctuation">(</span><span class="token string">'LogicOp'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'AND'</span><span class="token punctuation">:</span> partial<span class="token punctuation">(</span><span class="token keyword">lambda</span> l<span class="token punctuation">,</span> r<span class="token punctuation">:</span> l <span class="token keyword">and</span> r<span class="token punctuation">)</span><span class="token punctuation">,</span>
                           <span class="token string">'OR'</span> <span class="token punctuation">:</span> partial<span class="token punctuation">(</span><span class="token keyword">lambda</span> l<span class="token punctuation">,</span> r<span class="token punctuation">:</span> l <span class="token keyword">or</span> r<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><strong>Another solution in this particular case is to use built-in functions and_() and or_() from the module <a href="#operator">operator</a>.</strong></li></ul> <h2 id="exceptions">Exceptions</h2> <h3 id="basic-example">Basic Example</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token operator">&lt;</span>code<span class="token operator">&gt;</span>
<span class="token keyword">except</span> <span class="token operator">&lt;</span>exception<span class="token operator">&gt;</span><span class="token punctuation">:</span>
    <span class="token operator">&lt;</span>code<span class="token operator">&gt;</span>
</code></pre></div><h3 id="complex-example">Complex Example</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token operator">&lt;</span>code_1<span class="token operator">&gt;</span>
<span class="token keyword">except</span> <span class="token operator">&lt;</span>exception_a<span class="token operator">&gt;</span><span class="token punctuation">:</span>
    <span class="token operator">&lt;</span>code_2_a<span class="token operator">&gt;</span>
<span class="token keyword">except</span> <span class="token operator">&lt;</span>exception_b<span class="token operator">&gt;</span><span class="token punctuation">:</span>
    <span class="token operator">&lt;</span>code_2_b<span class="token operator">&gt;</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token operator">&lt;</span>code_2_c<span class="token operator">&gt;</span>
<span class="token keyword">finally</span><span class="token punctuation">:</span>
    <span class="token operator">&lt;</span>code_3<span class="token operator">&gt;</span>
</code></pre></div><h3 id="catching-exceptions">Catching Exceptions</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">except</span> <span class="token operator">&lt;</span>exception<span class="token operator">&gt;</span><span class="token punctuation">:</span>
<span class="token keyword">except</span> <span class="token operator">&lt;</span>exception<span class="token operator">&gt;</span> <span class="token keyword">as</span> <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span><span class="token punctuation">:</span>
<span class="token keyword">except</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>exception<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">except</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>exception<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span><span class="token punctuation">:</span>
</code></pre></div><ul><li><strong>Also catches subclasses of the exception.</strong></li> <li><strong>Use <code>'traceback.print_exc()'</code> to print the error message.</strong></li></ul> <h3 id="raising-exceptions">Raising Exceptions</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">raise</span> <span class="token operator">&lt;</span>exception<span class="token operator">&gt;</span>
<span class="token keyword">raise</span> <span class="token operator">&lt;</span>exception<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">raise</span> <span class="token operator">&lt;</span>exception<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="re-raising-caught-exception">Re-raising caught exception:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">except</span> <span class="token operator">&lt;</span>exception<span class="token operator">&gt;</span> <span class="token keyword">as</span> <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">raise</span>
</code></pre></div><h3 id="exception-object">Exception Object</h3> <div class="language-python extra-class"><pre class="language-python"><code>arguments <span class="token operator">=</span> <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span><span class="token punctuation">.</span>args
exc_type  <span class="token operator">=</span> <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span><span class="token punctuation">.</span>__class__
filename  <span class="token operator">=</span> <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span><span class="token punctuation">.</span>__traceback__<span class="token punctuation">.</span>tb_frame<span class="token punctuation">.</span>f_code<span class="token punctuation">.</span>co_filename
func_name <span class="token operator">=</span> <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span><span class="token punctuation">.</span>__traceback__<span class="token punctuation">.</span>tb_frame<span class="token punctuation">.</span>f_code<span class="token punctuation">.</span>co_name
line      <span class="token operator">=</span> linecache<span class="token punctuation">.</span>getline<span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span><span class="token punctuation">.</span>__traceback__<span class="token punctuation">.</span>tb_lineno<span class="token punctuation">)</span>
error_msg <span class="token operator">=</span> traceback<span class="token punctuation">.</span>format_exception<span class="token punctuation">(</span>exc_type<span class="token punctuation">,</span> <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span><span class="token punctuation">.</span>__traceback__<span class="token punctuation">)</span>
</code></pre></div><h3 id="built-in-exceptions">Built-in Exceptions</h3> <div class="language-text extra-class"><pre class="language-text"><code>BaseException
 +-- SystemExit                   # Raised by the sys.exit() function.
 +-- KeyboardInterrupt            # Raised when the user hits the interrupt key (ctrl-c).
 +-- Exception                    # User-defined exceptions should be derived from this class.
      +-- ArithmeticError         # Base class for arithmetic errors.
      |    +-- ZeroDivisionError  # Raised when dividing by zero.
      +-- AttributeError          # Raised when an attribute is missing.
      +-- EOFError                # Raised by input() when it hits end-of-file condition.
      +-- LookupError             # Raised when a look-up on a collection fails.
      |    +-- IndexError         # Raised when a sequence index is out of range.
      |    +-- KeyError           # Raised when a dictionary key or set element is not found.
      +-- NameError               # Raised when a variable name is not found.
      +-- OSError                 # Failures such as “file not found” or “disk full”.
      |    +-- FileNotFoundError  # When a file or directory is requested but doesn't exist.
      +-- RuntimeError            # Raised by errors that don't fall in other categories.
      |    +-- RecursionError     # Raised when the maximum recursion depth is exceeded.
      +-- StopIteration           # Raised by next() when run on an empty iterator.
      +-- TypeError               # Raised when an argument is of wrong type.
      +-- ValueError              # When an argument is of right type but inappropriate value.
           +-- UnicodeError       # Raised when encoding/decoding strings to/from bytes fails.
</code></pre></div><h4 id="collections-and-their-exceptions">Collections and their exceptions:</h4> <div class="language-text extra-class"><pre class="language-text"><code>+-----------+------------+------------+------------+
|           |    list    |    dict    |    set     |
+-----------+------------+------------+------------+
| getitem() | IndexError |  KeyError  |            |
| pop()     | IndexError |  KeyError  |  KeyError  |
| remove()  | ValueError |            |  KeyError  |
| index()   | ValueError |            |            |
+-----------+------------+------------+------------+
</code></pre></div><h4 id="useful-built-in-exceptions">Useful built-in exceptions:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">raise</span> TypeError<span class="token punctuation">(</span><span class="token string">'Argument is of wrong type!'</span><span class="token punctuation">)</span>
<span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">'Argument is of right type but inappropriate value!'</span><span class="token punctuation">)</span>
<span class="token keyword">raise</span> RuntimeError<span class="token punctuation">(</span><span class="token string">'None of above!'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="user-defined-exceptions">User-defined Exceptions</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">MyError</span><span class="token punctuation">(</span>Exception<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

<span class="token keyword">class</span> <span class="token class-name">MyInputError</span><span class="token punctuation">(</span>MyError<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>
</code></pre></div><h2 id="exit">Exit</h2> <p><strong>Exits the interpreter by raising SystemExit exception.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> sys
sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token punctuation">)</span>                        <span class="token comment"># Exits with exit code 0 (success).</span>
sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>                   <span class="token comment"># Exits with passed exit code.</span>
sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token operator">&lt;</span>obj<span class="token operator">&gt;</span><span class="token punctuation">)</span>                   <span class="token comment"># Prints the object and exits with 1 (failure).</span>
</code></pre></div><h2 id="print">Print</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>el_1<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">' '</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">'\n'</span><span class="token punctuation">,</span> <span class="token builtin">file</span><span class="token operator">=</span>sys<span class="token punctuation">.</span>stdout<span class="token punctuation">,</span> flush<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><strong>Use <code>'file=sys.stderr'</code> for messages about errors.</strong></li> <li><strong>Use <code>'flush=True'</code> to forcibly flush the stream.</strong></li></ul> <h3 id="pretty-print">Pretty Print</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> pprint <span class="token keyword">import</span> pprint
pprint<span class="token punctuation">(</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">,</span> depth<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> compact<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> sort_dicts<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><strong>Levels deeper than 'depth' get replaced by '...'.</strong></li></ul> <h2 id="input">Input</h2> <p><strong>Reads a line from user input or pipe if present.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span>prompt<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><strong>Trailing newline gets stripped.</strong></li> <li><strong>Prompt string is printed to the standard output before reading input.</strong></li> <li><strong>Raises EOFError when user hits EOF (ctrl-d) or input stream gets exhausted.</strong></li></ul> <h2 id="command-line-arguments">Command Line Arguments</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> sys
script_name <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
arguments   <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
</code></pre></div><h3 id="argparse">Argparse</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> argparse <span class="token keyword">import</span> ArgumentParser<span class="token punctuation">,</span> FileType
p <span class="token operator">=</span> ArgumentParser<span class="token punctuation">(</span>description<span class="token operator">=</span><span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'-&lt;short_name&gt;'</span><span class="token punctuation">,</span> <span class="token string">'--&lt;name&gt;'</span><span class="token punctuation">,</span> action<span class="token operator">=</span><span class="token string">'store_true'</span><span class="token punctuation">)</span>  <span class="token comment"># Flag</span>
p<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'-&lt;short_name&gt;'</span><span class="token punctuation">,</span> <span class="token string">'--&lt;name&gt;'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token operator">&lt;</span><span class="token builtin">type</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>          <span class="token comment"># Option</span>
p<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'&lt;name&gt;'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token operator">&lt;</span><span class="token builtin">type</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> nargs<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>                    <span class="token comment"># First argument</span>
p<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'&lt;name&gt;'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token operator">&lt;</span><span class="token builtin">type</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> nargs<span class="token operator">=</span><span class="token string">'+'</span><span class="token punctuation">)</span>                  <span class="token comment"># Remaining arguments</span>
p<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'&lt;name&gt;'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token operator">&lt;</span><span class="token builtin">type</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> nargs<span class="token operator">=</span><span class="token string">'*'</span><span class="token punctuation">)</span>                  <span class="token comment"># Optional arguments</span>
args  <span class="token operator">=</span> p<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>                                            <span class="token comment"># Exits on error.</span>
value <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>
</code></pre></div><ul><li><strong>Use <code>'help=&lt;str&gt;'</code> to set argument description.</strong></li> <li><strong>Use <code>'default=&lt;el&gt;'</code> to set the default value.</strong></li> <li><strong>Use <code>'type=FileType(&lt;mode&gt;)'</code> for files.</strong></li></ul> <h2 id="open">Open</h2> <p><strong>Opens the file and returns a corresponding file object.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">file</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'&lt;path&gt;'</span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><strong><code>'encoding=None'</code> means that the default encoding is used, which is platform dependent. Best practice is to use <code>'encoding=&quot;utf-8&quot;'</code> whenever possible.</strong></li> <li><strong><code>'newline=None'</code> means all different end of line combinations are converted to '\n' on read, while on write all '\n' characters are converted to system's default line separator.</strong></li> <li><strong><code>'newline=&quot;&quot;'</code> means no conversions take place, but input is still broken into chunks by readline() and readlines() on either '\n', '\r' or '\r\n'.</strong></li></ul> <h3 id="modes">Modes</h3> <ul><li><strong><code>'r'</code>  - Read (default).</strong></li> <li><strong><code>'w'</code>  - Write (truncate).</strong></li> <li><strong><code>'x'</code>  - Write or fail if the file already exists.</strong></li> <li><strong><code>'a'</code>  - Append.</strong></li> <li><strong><code>'w+'</code> - Read and write (truncate).</strong></li> <li><strong><code>'r+'</code> - Read and write from the start.</strong></li> <li><strong><code>'a+'</code> - Read and write from the end.</strong></li> <li><strong><code>'t'</code>  - Text mode (default).</strong></li> <li><strong><code>'b'</code>  - Binary mode.</strong></li></ul> <h3 id="exceptions-2">Exceptions</h3> <ul><li><strong><code>'FileNotFoundError'</code> can be raised when reading with <code>'r'</code> or <code>'r+'</code>.</strong></li> <li><strong><code>'FileExistsError'</code> can be raised when writing with <code>'x'</code>.</strong></li> <li><strong><code>'IsADirectoryError'</code> and <code>'PermissionError'</code> can be raised by any.</strong></li> <li><strong><code>'OSError'</code> is the parent class of all listed exceptions.</strong></li></ul> <h3 id="file-object">File Object</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">file</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>seek<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>                      <span class="token comment"># Moves to the start of the file.</span>
<span class="token operator">&lt;</span><span class="token builtin">file</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>seek<span class="token punctuation">(</span>offset<span class="token punctuation">)</span>                 <span class="token comment"># Moves 'offset' chars/bytes from the start.</span>
<span class="token operator">&lt;</span><span class="token builtin">file</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>seek<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>                   <span class="token comment"># Moves to the end of the file.</span>
<span class="token operator">&lt;</span>bin_file<span class="token operator">&gt;</span><span class="token punctuation">.</span>seek<span class="token punctuation">(</span>±offset<span class="token punctuation">,</span> <span class="token operator">&lt;</span>anchor<span class="token operator">&gt;</span><span class="token punctuation">)</span>  <span class="token comment"># Anchor: 0 start, 1 current pos., 2 end.</span>

<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">/</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">file</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># Reads 'size' chars/bytes or until EOF.</span>
<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">/</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">file</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token comment"># Returns a line or empty string/bytes on EOF.</span>
<span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span>      <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">file</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># Returns a list of remaining lines.</span>
<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">/</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">file</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>          <span class="token comment"># Returns a line using buffer. Do not mix.</span>

<span class="token operator">&lt;</span><span class="token builtin">file</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">/</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>           <span class="token comment"># Writes a string or bytes object.</span>
<span class="token operator">&lt;</span><span class="token builtin">file</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>writelines<span class="token punctuation">(</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">)</span>     <span class="token comment"># Writes a coll. of strings or bytes objects.</span>
<span class="token operator">&lt;</span><span class="token builtin">file</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span>                      <span class="token comment"># Flushes write buffer.</span>
</code></pre></div><ul><li><strong>Methods do not add or strip trailing newlines, even writelines().</strong></li></ul> <h3 id="read-text-from-file">Read Text from File</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">read_file</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">file</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="write-text-to-file">Write Text to File</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">write_to_file</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>text<span class="token punctuation">)</span>
</code></pre></div><h2 id="path">Path</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> os <span class="token keyword">import</span> getcwd<span class="token punctuation">,</span> path<span class="token punctuation">,</span> listdir
<span class="token keyword">from</span> glob <span class="token keyword">import</span> glob

<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> getcwd<span class="token punctuation">(</span><span class="token punctuation">)</span>                   <span class="token comment"># Returns the current working directory.</span>
<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> path<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token operator">&lt;</span>path<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>     <span class="token comment"># Joins two or more pathname components.</span>
<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span><span class="token operator">&lt;</span>path<span class="token operator">&gt;</span><span class="token punctuation">)</span>       <span class="token comment"># Returns absolute path.</span>

<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> path<span class="token punctuation">.</span>basename<span class="token punctuation">(</span><span class="token operator">&lt;</span>path<span class="token operator">&gt;</span><span class="token punctuation">)</span>      <span class="token comment"># Returns final component of the path.</span>
<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span><span class="token operator">&lt;</span>path<span class="token operator">&gt;</span><span class="token punctuation">)</span>       <span class="token comment"># Returns path without the final component.</span>
<span class="token operator">&lt;</span>tup<span class="token punctuation">.</span><span class="token operator">&gt;</span> <span class="token operator">=</span> path<span class="token punctuation">.</span>splitext<span class="token punctuation">(</span><span class="token operator">&lt;</span>path<span class="token operator">&gt;</span><span class="token punctuation">)</span>      <span class="token comment"># Splits on last period of the final component.</span>

<span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span> <span class="token operator">=</span> listdir<span class="token punctuation">(</span>path<span class="token operator">=</span><span class="token string">'.'</span><span class="token punctuation">)</span>          <span class="token comment"># Returns filenames located at path.</span>
<span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span> <span class="token operator">=</span> glob<span class="token punctuation">(</span><span class="token string">'&lt;pattern&gt;'</span><span class="token punctuation">)</span>          <span class="token comment"># Returns paths matching the wildcard pattern.</span>

<span class="token operator">&lt;</span><span class="token builtin">bool</span><span class="token operator">&gt;</span> <span class="token operator">=</span> path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token operator">&lt;</span>path<span class="token operator">&gt;</span><span class="token punctuation">)</span>        <span class="token comment"># Or: &lt;Path&gt;.exists()</span>
<span class="token operator">&lt;</span><span class="token builtin">bool</span><span class="token operator">&gt;</span> <span class="token operator">=</span> path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span><span class="token operator">&lt;</span>path<span class="token operator">&gt;</span><span class="token punctuation">)</span>        <span class="token comment"># Or: &lt;DirEntry/Path&gt;.is_file()</span>
<span class="token operator">&lt;</span><span class="token builtin">bool</span><span class="token operator">&gt;</span> <span class="token operator">=</span> path<span class="token punctuation">.</span>isdir<span class="token punctuation">(</span><span class="token operator">&lt;</span>path<span class="token operator">&gt;</span><span class="token punctuation">)</span>         <span class="token comment"># Or: &lt;DirEntry/Path&gt;.is_dir()</span>
</code></pre></div><h3 id="direntry">DirEntry</h3> <p><strong>Using scandir() instead of listdir() can significantly increase the performance of code that also needs file type information.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> os <span class="token keyword">import</span> scandir

<span class="token operator">&lt;</span><span class="token builtin">iter</span><span class="token operator">&gt;</span> <span class="token operator">=</span> scandir<span class="token punctuation">(</span>path<span class="token operator">=</span><span class="token string">'.'</span><span class="token punctuation">)</span>          <span class="token comment"># Returns DirEntry objects located at path.</span>
<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span>DirEntry<span class="token operator">&gt;</span><span class="token punctuation">.</span>path            <span class="token comment"># Returns path as a string.</span>
<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span>DirEntry<span class="token operator">&gt;</span><span class="token punctuation">.</span>name            <span class="token comment"># Returns final component as a string.</span>
<span class="token operator">&lt;</span><span class="token builtin">file</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>DirEntry<span class="token operator">&gt;</span><span class="token punctuation">)</span>           <span class="token comment"># Opens the file and returns file object.</span>
</code></pre></div><h3 id="path-object">Path Object</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Path

<span class="token operator">&lt;</span>Path<span class="token operator">&gt;</span> <span class="token operator">=</span> Path<span class="token punctuation">(</span><span class="token operator">&lt;</span>path<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>       <span class="token comment"># Accepts strings, Paths and DirEntry objects.</span>
<span class="token operator">&lt;</span>Path<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span> <span class="token operator">/</span> <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token operator">/</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>    <span class="token comment"># One of the paths must be a Path object.</span>

<span class="token operator">&lt;</span>Path<span class="token operator">&gt;</span> <span class="token operator">=</span> Path<span class="token punctuation">(</span><span class="token punctuation">)</span>                     <span class="token comment"># Returns relative cwd. Also Path('.').</span>
<span class="token operator">&lt;</span>Path<span class="token operator">&gt;</span> <span class="token operator">=</span> Path<span class="token punctuation">.</span>cwd<span class="token punctuation">(</span><span class="token punctuation">)</span>                 <span class="token comment"># Returns absolute cwd. Also Path().resolve().</span>
<span class="token operator">&lt;</span>Path<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>Path<span class="token operator">&gt;</span><span class="token punctuation">.</span>resolve<span class="token punctuation">(</span><span class="token punctuation">)</span>           <span class="token comment"># Returns absolute Path without symlinks.</span>

<span class="token operator">&lt;</span>Path<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>Path<span class="token operator">&gt;</span><span class="token punctuation">.</span>parent              <span class="token comment"># Returns Path without final component.</span>
<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span>Path<span class="token operator">&gt;</span><span class="token punctuation">.</span>name                <span class="token comment"># Returns final component as a string.</span>
<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span>Path<span class="token operator">&gt;</span><span class="token punctuation">.</span>stem                <span class="token comment"># Returns final component without extension.</span>
<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span>Path<span class="token operator">&gt;</span><span class="token punctuation">.</span>suffix              <span class="token comment"># Returns final component's extension.</span>
<span class="token operator">&lt;</span>tup<span class="token punctuation">.</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>Path<span class="token operator">&gt;</span><span class="token punctuation">.</span>parts               <span class="token comment"># Returns all components as strings.</span>

<span class="token operator">&lt;</span><span class="token builtin">iter</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>Path<span class="token operator">&gt;</span><span class="token punctuation">.</span>iterdir<span class="token punctuation">(</span><span class="token punctuation">)</span>           <span class="token comment"># Returns dir contents as Path objects.</span>
<span class="token operator">&lt;</span><span class="token builtin">iter</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>Path<span class="token operator">&gt;</span><span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">'&lt;pattern&gt;'</span><span class="token punctuation">)</span>   <span class="token comment"># Returns Paths matching the wildcard pattern.</span>

<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Path<span class="token operator">&gt;</span><span class="token punctuation">)</span>                <span class="token comment"># Returns path as a string.</span>
<span class="token operator">&lt;</span><span class="token builtin">file</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Path<span class="token operator">&gt;</span><span class="token punctuation">)</span>               <span class="token comment"># Opens the file and returns file object.</span>
</code></pre></div><h2 id="os-commands">OS Commands</h2> <h3 id="files-and-directories">Files and Directories</h3> <ul><li><strong>Paths can be either strings, Paths or DirEntry objects.</strong></li> <li><strong>Functions report OS related errors by raising either OSError or one of its <a href="#exceptions-1">subclasses</a>.</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> os<span class="token punctuation">,</span> shutil

os<span class="token punctuation">.</span>chdir<span class="token punctuation">(</span><span class="token operator">&lt;</span>path<span class="token operator">&gt;</span><span class="token punctuation">)</span>                    <span class="token comment"># Changes the current working directory.</span>
os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span><span class="token operator">&lt;</span>path<span class="token operator">&gt;</span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token number">0o777</span><span class="token punctuation">)</span>        <span class="token comment"># Creates a directory. Mode is in octal.</span>

shutil<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token keyword">from</span><span class="token punctuation">,</span> to<span class="token punctuation">)</span>               <span class="token comment"># Copies the file. 'to' can be a directory.</span>
shutil<span class="token punctuation">.</span>copytree<span class="token punctuation">(</span><span class="token keyword">from</span><span class="token punctuation">,</span> to<span class="token punctuation">)</span>           <span class="token comment"># Copies the directory. 'to' must not exist.</span>

os<span class="token punctuation">.</span>rename<span class="token punctuation">(</span><span class="token keyword">from</span><span class="token punctuation">,</span> to<span class="token punctuation">)</span>                 <span class="token comment"># Renames/moves the file or directory.</span>
os<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token keyword">from</span><span class="token punctuation">,</span> to<span class="token punctuation">)</span>                <span class="token comment"># Same, but overwrites 'to' if it exists.</span>

os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token operator">&lt;</span>path<span class="token operator">&gt;</span><span class="token punctuation">)</span>                   <span class="token comment"># Deletes the file.</span>
os<span class="token punctuation">.</span>rmdir<span class="token punctuation">(</span><span class="token operator">&lt;</span>path<span class="token operator">&gt;</span><span class="token punctuation">)</span>                    <span class="token comment"># Deletes the empty directory.</span>
shutil<span class="token punctuation">.</span>rmtree<span class="token punctuation">(</span><span class="token operator">&lt;</span>path<span class="token operator">&gt;</span><span class="token punctuation">)</span>               <span class="token comment"># Deletes the directory.</span>
</code></pre></div><h3 id="shell-commands">Shell Commands</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> os
<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span> <span class="token operator">=</span> os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">'&lt;shell_command&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="sends-1-1-to-the-calculator-and-captures-its-output">Sends '1 + 1' to the calculator and captures its output:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> subprocess <span class="token keyword">import</span> run
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> run<span class="token punctuation">(</span><span class="token string">'bc'</span><span class="token punctuation">,</span> <span class="token builtin">input</span><span class="token operator">=</span><span class="token string">'1 + 1\n'</span><span class="token punctuation">,</span> capture_output<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
CompletedProcess<span class="token punctuation">(</span>args<span class="token operator">=</span><span class="token string">'bc'</span><span class="token punctuation">,</span> returncode<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span><span class="token string">'2\n'</span><span class="token punctuation">,</span> stderr<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="sends-test-in-to-the-calculator-running-in-standard-mode-and-saves-its-output-to-test-out">Sends test.in to the calculator running in standard mode and saves its output to test.out:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> shlex <span class="token keyword">import</span> split
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">'echo 1 + 1 &gt; test.in'</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> run<span class="token punctuation">(</span>split<span class="token punctuation">(</span><span class="token string">'bc -s'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> stdin<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'test.in'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'test.out'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
CompletedProcess<span class="token punctuation">(</span>args<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'bc'</span><span class="token punctuation">,</span> <span class="token string">'-s'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> returncode<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'test.out'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token string">'2\n'</span>
</code></pre></div><h2 id="json">JSON</h2> <p><strong>Text file format for storing collections of strings and numbers.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> json
<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>    <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">object</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token builtin">object</span><span class="token operator">&gt;</span> <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="read-object-from-json-file">Read Object from JSON File</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">read_json_file</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="write-object-to-json-file">Write Object to JSON File</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">write_to_json_file</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> an_object<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>an_object<span class="token punctuation">,</span> <span class="token builtin">file</span><span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="pickle">Pickle</h2> <p><strong>Binary file format for storing objects.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> pickle
<span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">object</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token builtin">object</span><span class="token operator">&gt;</span> <span class="token operator">=</span> pickle<span class="token punctuation">.</span>loads<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="read-object-from-file">Read Object from File</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">read_pickle_file</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> pickle<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="write-object-to-file">Write Object to File</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">write_to_pickle_file</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> an_object<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        pickle<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>an_object<span class="token punctuation">,</span> <span class="token builtin">file</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="csv">CSV</h2> <p><strong>Text file format for storing spreadsheets.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> csv
</code></pre></div><h3 id="read">Read</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span>reader<span class="token operator">&gt;</span> <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">file</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> dialect<span class="token operator">=</span><span class="token string">'excel'</span><span class="token punctuation">,</span> delimiter<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span>   <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>reader<span class="token operator">&gt;</span><span class="token punctuation">)</span>           <span class="token comment"># Returns next row as a list of strings.</span>
<span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span>   <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>reader<span class="token operator">&gt;</span><span class="token punctuation">)</span>           <span class="token comment"># Returns list of remaining rows.</span>
</code></pre></div><ul><li><strong>File must be opened with <code>'newline=&quot;&quot;'</code> argument, or newlines embedded inside quoted fields will not be interpreted correctly!</strong></li></ul> <h3 id="write">Write</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span>writer<span class="token operator">&gt;</span> <span class="token operator">=</span> csv<span class="token punctuation">.</span>writer<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">file</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> dialect<span class="token operator">=</span><span class="token string">'excel'</span><span class="token punctuation">,</span> delimiter<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>writer<span class="token operator">&gt;</span><span class="token punctuation">.</span>writerow<span class="token punctuation">(</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">)</span>     <span class="token comment"># Encodes objects using `str(&lt;el&gt;)`.</span>
<span class="token operator">&lt;</span>writer<span class="token operator">&gt;</span><span class="token punctuation">.</span>writerows<span class="token punctuation">(</span><span class="token operator">&lt;</span>coll_of_coll<span class="token operator">&gt;</span><span class="token punctuation">)</span>  <span class="token comment"># Appends multiple rows.</span>
</code></pre></div><ul><li><strong>File must be opened with <code>'newline=&quot;&quot;'</code> argument, or an extra '\r' will be added to every '\n' on platforms that use '\r\n' line endings!</strong></li></ul> <h3 id="parameters">Parameters</h3> <ul><li><strong><code>'dialect'</code> - Master parameter that sets the default values.</strong></li> <li><strong><code>'delimiter'</code> - A one-character string used to separate fields.</strong></li> <li><strong><code>'quotechar'</code> - Character for quoting fields that contain special characters.</strong></li> <li><strong><code>'doublequote'</code> - Whether quotechars inside fields get doubled or escaped.</strong></li> <li><strong><code>'skipinitialspace'</code> - Whether whitespace after delimiter gets stripped.</strong></li> <li><strong><code>'lineterminator'</code> - Specifies how writer terminates rows.</strong></li> <li><strong><code>'quoting'</code> - Controls the amount of quoting: 0 - as necessary, 1 - all.</strong></li> <li><strong><code>'escapechar'</code> - Character for escaping 'quotechar' if 'doublequote' is False.</strong></li></ul> <h3 id="dialects">Dialects</h3> <div class="language-text extra-class"><pre class="language-text"><code>+------------------+--------------+--------------+--------------+
|                  |     excel    |   excel-tab  |     unix     |
+------------------+--------------+--------------+--------------+
| delimiter        |       ','    |      '\t'    |       ','    |
| quotechar        |       '&quot;'    |       '&quot;'    |       '&quot;'    |
| doublequote      |      True    |      True    |      True    |
| skipinitialspace |     False    |     False    |     False    |
| lineterminator   |    '\r\n'    |    '\r\n'    |      '\n'    |
| quoting          |         0    |         0    |         1    |
| escapechar       |      None    |      None    |      None    |
+------------------+--------------+--------------+--------------+
</code></pre></div><h3 id="read-rows-from-csv-file">Read Rows from CSV File</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">read_csv_file</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">list</span><span class="token punctuation">(</span>csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="write-rows-to-csv-file">Write Rows to CSV File</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">write_to_csv_file</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> rows<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        writer <span class="token operator">=</span> csv<span class="token punctuation">.</span>writer<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>
        writer<span class="token punctuation">.</span>writerows<span class="token punctuation">(</span>rows<span class="token punctuation">)</span>
</code></pre></div><h2 id="sqlite">SQLite</h2> <p><strong>Server-less database engine that stores each database into a separate file.</strong></p> <h3 id="connect">Connect</h3> <p><strong>Opens a connection to the database file. Creates a new file if path doesn't exist.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> sqlite3
db <span class="token operator">=</span> sqlite3<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">'&lt;path&gt;'</span><span class="token punctuation">)</span>                  <span class="token comment"># Also ':memory:'.</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
db<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="read-2">Read</h3> <p><strong>Returned values can be of type str, int, float, bytes or None.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span>cursor<span class="token operator">&gt;</span> <span class="token operator">=</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'&lt;query&gt;'</span><span class="token punctuation">)</span>                <span class="token comment"># Can raise a subclass of sqlite3.Error.</span>
<span class="token operator">&lt;</span><span class="token builtin">tuple</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span>cursor<span class="token operator">&gt;</span><span class="token punctuation">.</span>fetchone<span class="token punctuation">(</span><span class="token punctuation">)</span>                  <span class="token comment"># Returns next row. Also next(&lt;cursor&gt;).</span>
<span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span>   <span class="token operator">=</span> <span class="token operator">&lt;</span>cursor<span class="token operator">&gt;</span><span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>                  <span class="token comment"># Returns remaining rows. Also list(&lt;cursor&gt;).</span>
</code></pre></div><h3 id="write-2">Write</h3> <div class="language-python extra-class"><pre class="language-python"><code>db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'&lt;query&gt;'</span><span class="token punctuation">)</span>
db<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="or">Or:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">with</span> db<span class="token punctuation">:</span>
    db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'&lt;query&gt;'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="placeholders">Placeholders</h3> <ul><li><strong>Passed values can be of type str, int, float, bytes, None, bool, datetime.date or datetime.datetme.</strong></li> <li><strong>Bools will be stored and returned as ints and dates as <a href="#encode">ISO formatted strings</a>.</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code>db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'&lt;query&gt;'</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">/</span><span class="token builtin">tuple</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>             <span class="token comment"># Replaces '?'s in query with values.</span>
db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'&lt;query&gt;'</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">dict</span><span class="token operator">/</span>namedtuple<span class="token operator">&gt;</span><span class="token punctuation">)</span>        <span class="token comment"># Replaces ':&lt;key&gt;'s with values.</span>
db<span class="token punctuation">.</span>executemany<span class="token punctuation">(</span><span class="token string">'&lt;query&gt;'</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>coll_of_above<span class="token operator">&gt;</span><span class="token punctuation">)</span>      <span class="token comment"># Runs execute() many times.</span>
</code></pre></div><h3 id="example">Example</h3> <p><strong>In this example values are not actually saved because <code>'db.commit()'</code> is omitted!</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> db <span class="token operator">=</span> sqlite3<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">'test.db'</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'create table t (a, b, c)'</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'insert into t values (1, 2, 3)'</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'select * from t'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><h3 id="mysql">MySQL</h3> <p><strong>Has a very similar interface, with differences listed below.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># $ pip3 install mysql-connector</span>
<span class="token keyword">from</span> mysql <span class="token keyword">import</span> connector
db <span class="token operator">=</span> connector<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> user<span class="token operator">=</span><span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> database<span class="token operator">=</span><span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>cursor<span class="token operator">&gt;</span> <span class="token operator">=</span> db<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>cursor<span class="token operator">&gt;</span><span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'&lt;query&gt;'</span><span class="token punctuation">)</span>                     <span class="token comment"># Can raise a subclass of connector.Error.</span>
<span class="token operator">&lt;</span>cursor<span class="token operator">&gt;</span><span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'&lt;query&gt;'</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">/</span><span class="token builtin">tuple</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>       <span class="token comment"># Replaces '%s's in query with values.</span>
<span class="token operator">&lt;</span>cursor<span class="token operator">&gt;</span><span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'&lt;query&gt;'</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">dict</span><span class="token operator">/</span>namedtuple<span class="token operator">&gt;</span><span class="token punctuation">)</span>  <span class="token comment"># Replaces '%(&lt;key&gt;)s's with values.</span>
</code></pre></div><h2 id="bytes">Bytes</h2> <p><strong>Bytes object is an immutable sequence of single bytes. Mutable version is called bytearray.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token string">b'&lt;str&gt;'</span>                       <span class="token comment"># Only accepts ASCII characters and \x00 - \xff.</span>
<span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>   <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token operator">&lt;</span>index<span class="token operator">&gt;</span><span class="token punctuation">]</span>               <span class="token comment"># Returns int in range from 0 to 255.</span>
<span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token operator">&lt;</span><span class="token builtin">slice</span><span class="token operator">&gt;</span><span class="token punctuation">]</span>               <span class="token comment"># Returns bytes even if it has only one element.</span>
<span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token operator">&lt;</span>coll_of_bytes<span class="token operator">&gt;</span><span class="token punctuation">)</span>  <span class="token comment"># Joins elements using bytes object as separator.</span>
</code></pre></div><h3 id="encode-2">Encode</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>coll_of_ints<span class="token operator">&gt;</span><span class="token punctuation">)</span>          <span class="token comment"># Ints must be in range from 0 to 255.</span>
<span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>          <span class="token comment"># Or: &lt;str&gt;.encode('utf-8')</span>
<span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span>n_bytes<span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">'big/little'</span><span class="token punctuation">,</span> signed<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span><span class="token string">'&lt;hex&gt;'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="decode-2">Decode</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>                  <span class="token comment"># Returns ints in range from 0 to 255.</span>
<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>   <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>          <span class="token comment"># Or: &lt;bytes&gt;.decode('utf-8')</span>
<span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>   <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">'big/little'</span><span class="token punctuation">,</span> signed<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token string">'&lt;hex&gt;'</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="read-bytes-from-file">Read Bytes from File</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">read_bytes</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">file</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="write-bytes-to-file">Write Bytes to File</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">write_bytes</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> bytes_obj<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>bytes_obj<span class="token punctuation">)</span>
</code></pre></div><h2 id="struct">Struct</h2> <ul><li><strong>Module that performs conversions between a sequence of numbers and a bytes object.</strong></li> <li><strong>Machine’s native type sizes and byte order are used by default.</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> struct <span class="token keyword">import</span> pack<span class="token punctuation">,</span> unpack<span class="token punctuation">,</span> iter_unpack
<span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;format&gt;'</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>num_1<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>num_2<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token builtin">tuple</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> unpack<span class="token punctuation">(</span><span class="token string">'&lt;format&gt;'</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>tuples<span class="token operator">&gt;</span> <span class="token operator">=</span> iter_unpack<span class="token punctuation">(</span><span class="token string">'&lt;format&gt;'</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="example-2">Example</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> pack<span class="token punctuation">(</span><span class="token string">'&gt;hhl'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token string">b'\x00\x01\x00\x02\x00\x00\x00\x03'</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> unpack<span class="token punctuation">(</span><span class="token string">'&gt;hhl'</span><span class="token punctuation">,</span> <span class="token string">b'\x00\x01\x00\x02\x00\x00\x00\x03'</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="format-3">Format</h3> <h4 id="for-standard-type-sizes-start-format-string-with">For standard type sizes start format string with:</h4> <ul><li><strong><code>'='</code> - native byte order</strong></li> <li><strong><code>'&lt;'</code> - little-endian</strong></li> <li><strong><code>'&gt;'</code> - big-endian (also <code>'!'</code>)</strong></li></ul> <h4 id="integer-types-use-a-capital-letter-for-unsigned-type-standard-sizes-are-in-brackets">Integer types. Use a capital letter for unsigned type. Standard sizes are in brackets:</h4> <ul><li><strong><code>'x'</code> - pad byte</strong></li> <li><strong><code>'b'</code> - char (1)</strong></li> <li><strong><code>'h'</code> - short (2)</strong></li> <li><strong><code>'i'</code> - int (4)</strong></li> <li><strong><code>'l'</code> - long (4)</strong></li> <li><strong><code>'q'</code> - long long (8)</strong></li></ul> <h4 id="floating-point-types">Floating point types:</h4> <ul><li><strong><code>'f'</code> - float (4)</strong></li> <li><strong><code>'d'</code> - double (8)</strong></li></ul> <h2 id="array">Array</h2> <p><strong>List that can only hold numbers of a predefined type. Available types and their sizes in bytes are listed above.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> array <span class="token keyword">import</span> array
<span class="token operator">&lt;</span>array<span class="token operator">&gt;</span> <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token string">'&lt;typecode&gt;'</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">)</span>    <span class="token comment"># Array from collection of numbers.</span>
<span class="token operator">&lt;</span>array<span class="token operator">&gt;</span> <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token string">'&lt;typecode&gt;'</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>         <span class="token comment"># Array from bytes object.</span>
<span class="token operator">&lt;</span>array<span class="token operator">&gt;</span> <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token string">'&lt;typecode&gt;'</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>array<span class="token operator">&gt;</span><span class="token punctuation">)</span>         <span class="token comment"># Treats array as a sequence of numbers.</span>
<span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>array<span class="token operator">&gt;</span><span class="token punctuation">)</span>                       <span class="token comment"># Or: &lt;array&gt;.tobytes()</span>
</code></pre></div><h2 id="memory-view">Memory View</h2> <ul><li><strong>A sequence object that points to the memory of another object.</strong></li> <li><strong>Each element can reference a single or multiple consecutive bytes, depending on format.</strong></li> <li><strong>Order and number of elements can be changed with slicing.</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span>mview<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">memoryview</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">/</span><span class="token builtin">bytearray</span><span class="token operator">/</span>array<span class="token operator">&gt;</span><span class="token punctuation">)</span>  <span class="token comment"># Immutable if bytes, else mutable.</span>
<span class="token operator">&lt;</span>real<span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span>mview<span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token operator">&lt;</span>index<span class="token operator">&gt;</span><span class="token punctuation">]</span>                     <span class="token comment"># Returns an int or a float.</span>
<span class="token operator">&lt;</span>mview<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>mview<span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token operator">&lt;</span><span class="token builtin">slice</span><span class="token operator">&gt;</span><span class="token punctuation">]</span>                     <span class="token comment"># Mview with rearranged elements.</span>
<span class="token operator">&lt;</span>mview<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>mview<span class="token operator">&gt;</span><span class="token punctuation">.</span>cast<span class="token punctuation">(</span><span class="token string">'&lt;typecode&gt;'</span><span class="token punctuation">)</span>           <span class="token comment"># Casts memoryview to the new format.</span>
<span class="token operator">&lt;</span>mview<span class="token operator">&gt;</span><span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>                              <span class="token comment"># Releases the object's memory buffer.</span>
</code></pre></div><h3 id="decode-3">Decode</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span>bin_file<span class="token operator">&gt;</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token operator">&lt;</span>mview<span class="token operator">&gt;</span><span class="token punctuation">)</span>                      <span class="token comment"># Writes mview to the binary file.</span>
<span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>mview<span class="token operator">&gt;</span><span class="token punctuation">)</span>                       <span class="token comment"># Creates a new bytes object.</span>
<span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token operator">&lt;</span>coll_of_mviews<span class="token operator">&gt;</span><span class="token punctuation">)</span>       <span class="token comment"># Joins mviews using bytes object as sep.</span>
<span class="token operator">&lt;</span>array<span class="token operator">&gt;</span> <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token string">'&lt;typecode&gt;'</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>mview<span class="token operator">&gt;</span><span class="token punctuation">)</span>         <span class="token comment"># Treats mview as a sequence of numbers.</span>
<span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>mview<span class="token operator">&gt;</span><span class="token punctuation">)</span>                        <span class="token comment"># Returns list of ints or floats.</span>
<span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>   <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>mview<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>                <span class="token comment"># Treats mview as a bytes object.</span>
<span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>   <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span><span class="token operator">&lt;</span>mview<span class="token operator">&gt;</span><span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">'big/little'</span><span class="token punctuation">,</span> signed<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token string">'&lt;hex&gt;'</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>mview<span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="deque">Deque</h2> <p><strong>A thread-safe list with efficient appends and pops from either side. Pronounced &quot;deck&quot;.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> collections <span class="token keyword">import</span> deque
<span class="token operator">&lt;</span>deque<span class="token operator">&gt;</span> <span class="token operator">=</span> deque<span class="token punctuation">(</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">,</span> maxlen<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>

<span class="token operator">&lt;</span>deque<span class="token operator">&gt;</span><span class="token punctuation">.</span>appendleft<span class="token punctuation">(</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">)</span>                       <span class="token comment"># Opposite element is dropped if full.</span>
<span class="token operator">&lt;</span>deque<span class="token operator">&gt;</span><span class="token punctuation">.</span>extendleft<span class="token punctuation">(</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">)</span>               <span class="token comment"># Collection gets reversed.</span>
<span class="token operator">&lt;</span>el<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>deque<span class="token operator">&gt;</span><span class="token punctuation">.</span>popleft<span class="token punctuation">(</span><span class="token punctuation">)</span>                       <span class="token comment"># Raises IndexError if empty.</span>
<span class="token operator">&lt;</span>deque<span class="token operator">&gt;</span><span class="token punctuation">.</span>rotate<span class="token punctuation">(</span>n<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>                            <span class="token comment"># Rotates elements to the right.</span>
</code></pre></div><h2 id="threading">Threading</h2> <ul><li><strong>CPython interpreter can only run a single thread at a time.</strong></li> <li><strong>That is why using multiple threads won't result in a faster execution, unless at least one of the threads contains an I/O operation.</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread<span class="token punctuation">,</span> RLock<span class="token punctuation">,</span> Semaphore<span class="token punctuation">,</span> Event<span class="token punctuation">,</span> Barrier
</code></pre></div><h3 id="thread">Thread</h3> <div class="language-python extra-class"><pre class="language-python"><code>thread <span class="token operator">=</span> Thread<span class="token punctuation">(</span>target<span class="token operator">=</span><span class="token operator">&lt;</span>function<span class="token operator">&gt;</span><span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>first_arg<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>
thread<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token operator">&lt;</span><span class="token builtin">bool</span><span class="token operator">&gt;</span> <span class="token operator">=</span> thread<span class="token punctuation">.</span>is_alive<span class="token punctuation">(</span><span class="token punctuation">)</span>           <span class="token comment"># Checks if thread has finished executing.</span>
thread<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>                        <span class="token comment"># Waits for thread to finish.</span>
</code></pre></div><ul><li><strong>Use <code>'kwargs=&lt;dict&gt;'</code> to pass keyword arguments to the function.</strong></li> <li><strong>Use <code>'daemon=True'</code>, or the program will not be able to exit while the thread is alive.</strong></li></ul> <h3 id="lock">Lock</h3> <div class="language-python extra-class"><pre class="language-python"><code>lock <span class="token operator">=</span> RLock<span class="token punctuation">(</span><span class="token punctuation">)</span>
lock<span class="token punctuation">.</span>acquire<span class="token punctuation">(</span><span class="token punctuation">)</span>                       <span class="token comment"># Waits for lock to be available.</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
lock<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="or-2">Or:</h4> <div class="language-python extra-class"><pre class="language-python"><code>lock <span class="token operator">=</span> RLock<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">with</span> lock<span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><h3 id="semaphore-event-barrier">Semaphore, Event, Barrier</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span>Semaphore<span class="token operator">&gt;</span> <span class="token operator">=</span> Semaphore<span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>     <span class="token comment"># Lock that can be acquired 'value' times.</span>
<span class="token operator">&lt;</span>Event<span class="token operator">&gt;</span>     <span class="token operator">=</span> Event<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token comment"># Method wait() blocks until set() is called.</span>
<span class="token operator">&lt;</span>Barrier<span class="token operator">&gt;</span>   <span class="token operator">=</span> Barrier<span class="token punctuation">(</span>n_times<span class="token punctuation">)</span>       <span class="token comment"># Method wait() blocks until it's called 'n_times'.</span>
</code></pre></div><h3 id="thread-pool-executor">Thread Pool Executor</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> concurrent<span class="token punctuation">.</span>futures <span class="token keyword">import</span> ThreadPoolExecutor
<span class="token keyword">with</span> ThreadPoolExecutor<span class="token punctuation">(</span>max_workers<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span> <span class="token keyword">as</span> executor<span class="token punctuation">:</span>
    <span class="token operator">&lt;</span><span class="token builtin">iter</span><span class="token operator">&gt;</span>   <span class="token operator">=</span> executor<span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>         <span class="token comment"># (1, 2, 3)</span>
    <span class="token operator">&lt;</span><span class="token builtin">iter</span><span class="token operator">&gt;</span>   <span class="token operator">=</span> executor<span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span> y<span class="token punctuation">:</span> x <span class="token operator">+</span> y<span class="token punctuation">,</span> <span class="token string">'abc'</span><span class="token punctuation">,</span> <span class="token string">'123'</span><span class="token punctuation">)</span>  <span class="token comment"># ('a1', 'b2', 'c3')</span>
    <span class="token operator">&lt;</span>Future<span class="token operator">&gt;</span> <span class="token operator">=</span> executor<span class="token punctuation">.</span>submit<span class="token punctuation">(</span><span class="token operator">&lt;</span>function<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>arg_1<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="future">Future:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">bool</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>Future<span class="token operator">&gt;</span><span class="token punctuation">.</span>done<span class="token punctuation">(</span><span class="token punctuation">)</span>             <span class="token comment"># Checks if thread has finished executing.</span>
<span class="token operator">&lt;</span>obj<span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span>Future<span class="token operator">&gt;</span><span class="token punctuation">.</span>result<span class="token punctuation">(</span><span class="token punctuation">)</span>           <span class="token comment"># Waits for thread to finish and returns result.</span>
</code></pre></div><h3 id="queue">Queue</h3> <p><strong>A thread-safe FIFO queue. For LIFO queue use LifoQueue.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> queue <span class="token keyword">import</span> Queue
<span class="token operator">&lt;</span>Queue<span class="token operator">&gt;</span> <span class="token operator">=</span> Queue<span class="token punctuation">(</span>maxsize<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token operator">&lt;</span>Queue<span class="token operator">&gt;</span><span class="token punctuation">.</span>put<span class="token punctuation">(</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">)</span>                    <span class="token comment"># Blocks until queue stops being full.</span>
<span class="token operator">&lt;</span>Queue<span class="token operator">&gt;</span><span class="token punctuation">.</span>put_nowait<span class="token punctuation">(</span><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span><span class="token punctuation">)</span>             <span class="token comment"># Raises queue.Full exception if full.</span>
<span class="token operator">&lt;</span>el<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>Queue<span class="token operator">&gt;</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>                 <span class="token comment"># Blocks until queue stops being empty.</span>
<span class="token operator">&lt;</span>el<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>Queue<span class="token operator">&gt;</span><span class="token punctuation">.</span>get_nowait<span class="token punctuation">(</span><span class="token punctuation">)</span>          <span class="token comment"># Raises queue.Empty exception if empty.</span>
</code></pre></div><h2 id="operator">Operator</h2> <p><strong>Module of functions that provide the functionality of operators.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> operator <span class="token keyword">import</span> add<span class="token punctuation">,</span> sub<span class="token punctuation">,</span> mul<span class="token punctuation">,</span> truediv<span class="token punctuation">,</span> floordiv<span class="token punctuation">,</span> mod<span class="token punctuation">,</span> <span class="token builtin">pow</span><span class="token punctuation">,</span> neg<span class="token punctuation">,</span> <span class="token builtin">abs</span>
<span class="token keyword">from</span> operator <span class="token keyword">import</span> eq<span class="token punctuation">,</span> ne<span class="token punctuation">,</span> lt<span class="token punctuation">,</span> le<span class="token punctuation">,</span> gt<span class="token punctuation">,</span> ge
<span class="token keyword">from</span> operator <span class="token keyword">import</span> and_<span class="token punctuation">,</span> or_<span class="token punctuation">,</span> not_
<span class="token keyword">from</span> operator <span class="token keyword">import</span> itemgetter<span class="token punctuation">,</span> attrgetter<span class="token punctuation">,</span> methodcaller

<span class="token keyword">import</span> operator <span class="token keyword">as</span> op
elementwise_sum  <span class="token operator">=</span> <span class="token builtin">map</span><span class="token punctuation">(</span>op<span class="token punctuation">.</span>add<span class="token punctuation">,</span> list_a<span class="token punctuation">,</span> list_b<span class="token punctuation">)</span>
sorted_by_second <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">,</span> key<span class="token operator">=</span>op<span class="token punctuation">.</span>itemgetter<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
sorted_by_both   <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">,</span> key<span class="token operator">=</span>op<span class="token punctuation">.</span>itemgetter<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
product_of_elems <span class="token operator">=</span> functools<span class="token punctuation">.</span><span class="token builtin">reduce</span><span class="token punctuation">(</span>op<span class="token punctuation">.</span>mul<span class="token punctuation">,</span> <span class="token operator">&lt;</span>collection<span class="token operator">&gt;</span><span class="token punctuation">)</span>
LogicOp          <span class="token operator">=</span> enum<span class="token punctuation">.</span>Enum<span class="token punctuation">(</span><span class="token string">'LogicOp'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'AND'</span><span class="token punctuation">:</span> op<span class="token punctuation">.</span>and_<span class="token punctuation">,</span> <span class="token string">'OR'</span> <span class="token punctuation">:</span> op<span class="token punctuation">.</span>or_<span class="token punctuation">}</span><span class="token punctuation">)</span>
last_el          <span class="token operator">=</span> op<span class="token punctuation">.</span>methodcaller<span class="token punctuation">(</span><span class="token string">'pop'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="introspection">Introspection</h2> <p><strong>Inspecting code at runtime.</strong></p> <h3 id="variables">Variables</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">dir</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                       <span class="token comment"># Returns names of local variables (incl. functions).</span>
<span class="token operator">&lt;</span><span class="token builtin">dict</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">vars</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                      <span class="token comment"># Returns dict of local variables. Also locals().</span>
<span class="token operator">&lt;</span><span class="token builtin">dict</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                   <span class="token comment"># Returns dict of global variables.</span>
</code></pre></div><h3 id="attributes-2">Attributes</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">dir</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">object</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>               <span class="token comment"># Returns names of object's attributes (incl. methods).</span>
<span class="token operator">&lt;</span><span class="token builtin">dict</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">vars</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">object</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>              <span class="token comment"># Returns dict of object's fields. Also &lt;obj&gt;.__dict__.</span>

<span class="token operator">&lt;</span><span class="token builtin">bool</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">object</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token string">'&lt;attr_name&gt;'</span><span class="token punctuation">)</span>
value  <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">object</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token string">'&lt;attr_name&gt;'</span><span class="token punctuation">)</span>
<span class="token builtin">setattr</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">object</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token string">'&lt;attr_name&gt;'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
<span class="token builtin">delattr</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">object</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token string">'&lt;attr_name&gt;'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="parameters-2">Parameters</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> inspect <span class="token keyword">import</span> signature
<span class="token operator">&lt;</span>sig<span class="token operator">&gt;</span>        <span class="token operator">=</span> signature<span class="token punctuation">(</span><span class="token operator">&lt;</span>function<span class="token operator">&gt;</span><span class="token punctuation">)</span>
no_of_params <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>sig<span class="token operator">&gt;</span><span class="token punctuation">.</span>parameters<span class="token punctuation">)</span>
param_names  <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>sig<span class="token operator">&gt;</span><span class="token punctuation">.</span>parameters<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
param_kinds  <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token punctuation">.</span>kind <span class="token keyword">for</span> a <span class="token keyword">in</span> <span class="token operator">&lt;</span>sig<span class="token operator">&gt;</span><span class="token punctuation">.</span>parameters<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><h2 id="metaprograming">Metaprograming</h2> <p><strong>Code that generates code.</strong></p> <h3 id="type-2">Type</h3> <p><strong>Type is the root class. If only passed an object it returns its type (class). Otherwise it creates a new class.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span><span class="token keyword">class</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token builtin">type</span><span class="token punctuation">(</span><span class="token string">'&lt;class_name&gt;'</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>parents_tuple<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>attributes_dict<span class="token operator">&gt;</span><span class="token punctuation">)</span>

<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Z <span class="token operator">=</span> <span class="token builtin">type</span><span class="token punctuation">(</span><span class="token string">'Z'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token string">'abcde'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token number">12345</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> z <span class="token operator">=</span> Z<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="meta-class">Meta Class</h3> <p><strong>A class that creates classes.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">my_meta_class</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> parents<span class="token punctuation">,</span> attrs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    attrs<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'abcde'</span>
    <span class="token keyword">return</span> <span class="token builtin">type</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> parents<span class="token punctuation">,</span> attrs<span class="token punctuation">)</span>
</code></pre></div><h4 id="or-3">Or:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">MyMetaClass</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__new__</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> name<span class="token punctuation">,</span> parents<span class="token punctuation">,</span> attrs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        attrs<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'abcde'</span>
        <span class="token keyword">return</span> <span class="token builtin">type</span><span class="token punctuation">.</span>__new__<span class="token punctuation">(</span>cls<span class="token punctuation">,</span> name<span class="token punctuation">,</span> parents<span class="token punctuation">,</span> attrs<span class="token punctuation">)</span>
</code></pre></div><ul><li><strong>New() is a class method that gets called before init(). If it returns an instance of its class, then that instance gets passed to init() as a 'self' argument.</strong></li> <li><strong>It receives the same arguments as init(), except for the first one that specifies the desired type of the returned instance (MyMetaClass in our case).</strong></li> <li><strong>Like in our case, new() can also be called directly, usually from a new() method of a child class (</strong><code>def __new__(cls): return super().__new__(cls)</code><strong>).</strong></li> <li><strong>The only difference between the examples above is that my_meta_class() returns a class of type type, while MyMetaClass() returns a class of type MyMetaClass.</strong></li></ul> <h3 id="metaclass-attribute">Metaclass Attribute</h3> <p><strong>Right before a class is created it checks if it has a 'metaclass' attribute defined. If not, it recursively checks if any of his parents has it defined and eventually comes to type().</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">MyClass</span><span class="token punctuation">(</span>metaclass<span class="token operator">=</span>MyMetaClass<span class="token punctuation">)</span><span class="token punctuation">:</span>
    b <span class="token operator">=</span> <span class="token number">12345</span>

<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> MyClass<span class="token punctuation">.</span>a<span class="token punctuation">,</span> MyClass<span class="token punctuation">.</span>b
<span class="token punctuation">(</span><span class="token string">'abcde'</span><span class="token punctuation">,</span> <span class="token number">12345</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="type-diagram">Type Diagram</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token builtin">type</span><span class="token punctuation">(</span>MyClass<span class="token punctuation">)</span>     <span class="token operator">==</span> MyMetaClass     <span class="token comment"># MyClass is an instance of MyMetaClass.</span>
<span class="token builtin">type</span><span class="token punctuation">(</span>MyMetaClass<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">type</span>            <span class="token comment"># MyMetaClass is an instance of type.</span>
</code></pre></div><div class="language-text extra-class"><pre class="language-text"><code>+-------------+-------------+
|   Classes   | Metaclasses |
+-------------+-------------|
|   MyClass --&gt; MyMetaClass |
|             |     v       |
|    object -----&gt; type &lt;+  |
|             |    ^ +---+  |
|     str ---------+        |
+-------------+-------------+
</code></pre></div><h3 id="inheritance-diagram">Inheritance Diagram</h3> <div class="language-python extra-class"><pre class="language-python"><code>MyClass<span class="token punctuation">.</span>__base__     <span class="token operator">==</span> <span class="token builtin">object</span>       <span class="token comment"># MyClass is a subclass of object.</span>
MyMetaClass<span class="token punctuation">.</span>__base__ <span class="token operator">==</span> <span class="token builtin">type</span>         <span class="token comment"># MyMetaClass is a subclass of type.</span>
</code></pre></div><div class="language-text extra-class"><pre class="language-text"><code>+-------------+-------------+
|   Classes   | Metaclasses |
+-------------+-------------|
|   MyClass   | MyMetaClass |
|      v      |     v       |
|    object &lt;----- type     |
|      ^      |             |
|     str     |             |
+-------------+-------------+
</code></pre></div><h2 id="eval">Eval</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> ast <span class="token keyword">import</span> literal_eval
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> literal_eval<span class="token punctuation">(</span><span class="token string">'1 + 2'</span><span class="token punctuation">)</span>
<span class="token number">3</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> literal_eval<span class="token punctuation">(</span><span class="token string">'[1, 2, 3]'</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> literal_eval<span class="token punctuation">(</span><span class="token string">'abs(1)'</span><span class="token punctuation">)</span>
ValueError<span class="token punctuation">:</span> malformed node <span class="token keyword">or</span> string
</code></pre></div><h2 id="coroutines">Coroutines</h2> <ul><li><strong>Coroutines have a lot in common with threads, but unlike threads, they only give up control when they call another coroutine and they don’t use as much memory.</strong></li> <li><strong>Coroutine definition starts with <code>'async'</code> and its call with <code>'await'</code>.</strong></li> <li><strong><code>'asyncio.run(&lt;coroutine&gt;)'</code> is the main entry point for asynchronous programs.</strong></li> <li><strong>Functions wait(), gather() and as_completed() can be used when multiple coroutines need to be started at the same time.</strong></li> <li><strong>Asyncio module also provides its own <a href="#queue">Queue</a>, <a href="#semaphore-event-barrier">Event</a>, <a href="#lock">Lock</a> and <a href="#semaphore-event-barrier">Semaphore</a> classes.</strong></li></ul> <h4 id="runs-a-terminal-game-where-you-control-an-asterisk-that-must-avoid-numbers">Runs a terminal game where you control an asterisk that must avoid numbers:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> asyncio<span class="token punctuation">,</span> collections<span class="token punctuation">,</span> curses<span class="token punctuation">,</span> enum<span class="token punctuation">,</span> random

P <span class="token operator">=</span> collections<span class="token punctuation">.</span>namedtuple<span class="token punctuation">(</span><span class="token string">'P'</span><span class="token punctuation">,</span> <span class="token string">'x y'</span><span class="token punctuation">)</span>         <span class="token comment"># Position</span>
D <span class="token operator">=</span> enum<span class="token punctuation">.</span>Enum<span class="token punctuation">(</span><span class="token string">'D'</span><span class="token punctuation">,</span> <span class="token string">'n e s w'</span><span class="token punctuation">)</span>                  <span class="token comment"># Direction</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span>screen<span class="token punctuation">)</span><span class="token punctuation">:</span>
    curses<span class="token punctuation">.</span>curs_set<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>                         <span class="token comment"># Makes cursor invisible.</span>
    screen<span class="token punctuation">.</span>nodelay<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>                       <span class="token comment"># Makes getch() non-blocking.</span>
    asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>main_coroutine<span class="token punctuation">(</span>screen<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment"># Starts running asyncio code.</span>

<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">main_coroutine</span><span class="token punctuation">(</span>screen<span class="token punctuation">)</span><span class="token punctuation">:</span>
    state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'*'</span><span class="token punctuation">:</span> P<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">**</span><span class="token punctuation">{</span>id_<span class="token punctuation">:</span> P<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">for</span> id_ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
    moves <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>Queue<span class="token punctuation">(</span><span class="token punctuation">)</span>
    coros <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>random_controller<span class="token punctuation">(</span>id_<span class="token punctuation">,</span> moves<span class="token punctuation">)</span> <span class="token keyword">for</span> id_ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
             human_controller<span class="token punctuation">(</span>screen<span class="token punctuation">,</span> moves<span class="token punctuation">)</span><span class="token punctuation">,</span>
             model<span class="token punctuation">(</span>moves<span class="token punctuation">,</span> state<span class="token punctuation">,</span> <span class="token operator">*</span>screen<span class="token punctuation">.</span>getmaxyx<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
             view<span class="token punctuation">(</span>state<span class="token punctuation">,</span> screen<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>wait<span class="token punctuation">(</span>coros<span class="token punctuation">,</span> return_when<span class="token operator">=</span>asyncio<span class="token punctuation">.</span>FIRST_COMPLETED<span class="token punctuation">)</span>

<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">random_controller</span><span class="token punctuation">(</span>id_<span class="token punctuation">,</span> moves<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        moves<span class="token punctuation">.</span>put_nowait<span class="token punctuation">(</span><span class="token punctuation">(</span>id_<span class="token punctuation">,</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>D<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span>

<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">human_controller</span><span class="token punctuation">(</span>screen<span class="token punctuation">,</span> moves<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        ch <span class="token operator">=</span> screen<span class="token punctuation">.</span>getch<span class="token punctuation">(</span><span class="token punctuation">)</span>
        key_mappings <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">259</span><span class="token punctuation">:</span> D<span class="token punctuation">.</span>n<span class="token punctuation">,</span> <span class="token number">261</span><span class="token punctuation">:</span> D<span class="token punctuation">.</span>e<span class="token punctuation">,</span> <span class="token number">258</span><span class="token punctuation">:</span> D<span class="token punctuation">.</span>s<span class="token punctuation">,</span> <span class="token number">260</span><span class="token punctuation">:</span> D<span class="token punctuation">.</span>w<span class="token punctuation">}</span>
        <span class="token keyword">if</span> ch <span class="token keyword">in</span> key_mappings<span class="token punctuation">:</span>
            moves<span class="token punctuation">.</span>put_nowait<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">,</span> key_mappings<span class="token punctuation">[</span>ch<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.01</span><span class="token punctuation">)</span>  

<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">model</span><span class="token punctuation">(</span>moves<span class="token punctuation">,</span> state<span class="token punctuation">,</span> height<span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> state<span class="token punctuation">[</span><span class="token string">'*'</span><span class="token punctuation">]</span> <span class="token keyword">not</span> <span class="token keyword">in</span> <span class="token punctuation">{</span>p <span class="token keyword">for</span> id_<span class="token punctuation">,</span> p <span class="token keyword">in</span> state<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> id_ <span class="token operator">!=</span> <span class="token string">'*'</span><span class="token punctuation">}</span><span class="token punctuation">:</span>
        id_<span class="token punctuation">,</span> d <span class="token operator">=</span> <span class="token keyword">await</span> moves<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
        p      <span class="token operator">=</span> state<span class="token punctuation">[</span>id_<span class="token punctuation">]</span>
        deltas <span class="token operator">=</span> <span class="token punctuation">{</span>D<span class="token punctuation">.</span>n<span class="token punctuation">:</span> P<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> D<span class="token punctuation">.</span>e<span class="token punctuation">:</span> P<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> D<span class="token punctuation">.</span>s<span class="token punctuation">:</span> P<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> D<span class="token punctuation">.</span>w<span class="token punctuation">:</span> P<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        new_p  <span class="token operator">=</span> P<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">[</span><span class="token builtin">sum</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">for</span> a <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> deltas<span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token number">0</span> <span class="token operator">&lt;=</span> new_p<span class="token punctuation">.</span>x <span class="token operator">&lt;</span> width<span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">and</span> <span class="token number">0</span> <span class="token operator">&lt;=</span> new_p<span class="token punctuation">.</span>y <span class="token operator">&lt;</span> height<span class="token punctuation">:</span>
            state<span class="token punctuation">[</span>id_<span class="token punctuation">]</span> <span class="token operator">=</span> new_p

<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">view</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> screen<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        screen<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> id_<span class="token punctuation">,</span> p <span class="token keyword">in</span> state<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            screen<span class="token punctuation">.</span>addstr<span class="token punctuation">(</span>p<span class="token punctuation">.</span>y<span class="token punctuation">,</span> p<span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>id_<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.01</span><span class="token punctuation">)</span>  

curses<span class="token punctuation">.</span>wrapper<span class="token punctuation">(</span>main<span class="token punctuation">)</span>
</code></pre></div><br> <h1 id="libraries">Libraries</h1> <h2 id="progress-bar">Progress Bar</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># $ pip3 install tqdm</span>
<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm
<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep
<span class="token keyword">for</span> el <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sleep<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="plot">Plot</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># $ pip3 install matplotlib</span>
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot
pyplot<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token operator">&lt;</span>y_data<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
pyplot<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token operator">&lt;</span>x_data<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>y_data<span class="token operator">&gt;</span><span class="token punctuation">)</span>
pyplot<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>                                <span class="token comment"># Adds a legend.</span>
pyplot<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'&lt;path&gt;'</span><span class="token punctuation">)</span>                       <span class="token comment"># Saves the figure.</span>
pyplot<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>                                  <span class="token comment"># Displays the figure.</span>
pyplot<span class="token punctuation">.</span>clf<span class="token punctuation">(</span><span class="token punctuation">)</span>                                   <span class="token comment"># Clears the figure.</span>
</code></pre></div><h2 id="table">Table</h2> <h4 id="prints-a-csv-file-as-an-ascii-table">Prints a CSV file as an ASCII table:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># $ pip3 install tabulate</span>
<span class="token keyword">import</span> csv<span class="token punctuation">,</span> tabulate
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'test.csv'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
    rows   <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>
    header <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> a <span class="token keyword">in</span> <span class="token builtin">next</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token punctuation">]</span>
    table  <span class="token operator">=</span> tabulate<span class="token punctuation">.</span>tabulate<span class="token punctuation">(</span>rows<span class="token punctuation">,</span> header<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>table<span class="token punctuation">)</span>
</code></pre></div><h2 id="curses">Curses</h2> <h4 id="clears-the-terminal-prints-a-message-and-waits-for-the-esc-key-press">Clears the terminal, prints a message and waits for the ESC key press:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> curses <span class="token keyword">import</span> wrapper<span class="token punctuation">,</span> curs_set<span class="token punctuation">,</span> <span class="token builtin">ascii</span>
<span class="token keyword">from</span> curses <span class="token keyword">import</span> KEY_UP<span class="token punctuation">,</span> KEY_RIGHT<span class="token punctuation">,</span> KEY_DOWN<span class="token punctuation">,</span> KEY_LEFT

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    wrapper<span class="token punctuation">(</span>draw<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">draw</span><span class="token punctuation">(</span>screen<span class="token punctuation">)</span><span class="token punctuation">:</span>
    curs_set<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>                                <span class="token comment"># Makes cursor invisible.</span>
    screen<span class="token punctuation">.</span>nodelay<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>                       <span class="token comment"># Makes getch() non-blocking.</span>
    screen<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
    screen<span class="token punctuation">.</span>addstr<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'Press ESC to quit.'</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> screen<span class="token punctuation">.</span>getch<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token builtin">ascii</span><span class="token punctuation">.</span>ESC<span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

<span class="token keyword">def</span> <span class="token function">get_border</span><span class="token punctuation">(</span>screen<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">from</span> collections <span class="token keyword">import</span> namedtuple
    P <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'P'</span><span class="token punctuation">,</span> <span class="token string">'x y'</span><span class="token punctuation">)</span>
    height<span class="token punctuation">,</span> width <span class="token operator">=</span> screen<span class="token punctuation">.</span>getmaxyx<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> P<span class="token punctuation">(</span>width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="logging">Logging</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># $ pip3 install loguru</span>
<span class="token keyword">from</span> loguru <span class="token keyword">import</span> logger

logger<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">'debug_{time}.log'</span><span class="token punctuation">,</span> colorize<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># Connects a log file.</span>
logger<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">'error_{time}.log'</span><span class="token punctuation">,</span> level<span class="token operator">=</span><span class="token string">'ERROR'</span><span class="token punctuation">)</span>  <span class="token comment"># Another file for errors or higher.</span>
logger<span class="token punctuation">.</span><span class="token operator">&lt;</span>level<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">'A logging message.'</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><strong>Levels: <code>'debug'</code>, <code>'info'</code>, <code>'success'</code>, <code>'warning'</code>, <code>'error'</code>, <code>'critical'</code>.</strong></li></ul> <h3 id="exceptions-3">Exceptions</h3> <p><strong>Exception description, stack trace and values of variables are appended automatically.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">except</span> <span class="token operator">&lt;</span>exception<span class="token operator">&gt;</span><span class="token punctuation">:</span>
    logger<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token string">'An error happened.'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="rotation">Rotation</h3> <p><strong>Argument that sets a condition when a new log file is created.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code>rotation<span class="token operator">=</span><span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span><span class="token operator">|</span><span class="token operator">&lt;</span>datetime<span class="token punctuation">.</span>timedelta<span class="token operator">&gt;</span><span class="token operator">|</span><span class="token operator">&lt;</span>datetime<span class="token punctuation">.</span>time<span class="token operator">&gt;</span><span class="token operator">|</span><span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>
</code></pre></div><ul><li><strong><code>'&lt;int&gt;'</code> - Max file size in bytes.</strong></li> <li><strong><code>'&lt;timedelta&gt;'</code> - Max age of a file.</strong></li> <li><strong><code>'&lt;time&gt;'</code> - Time of day.</strong></li> <li><strong><code>'&lt;str&gt;'</code> - Any of above as a string: <code>'100 MB'</code>, <code>'1 month'</code>, <code>'monday at 12:00'</code>, ...</strong></li></ul> <h3 id="retention">Retention</h3> <p><strong>Sets a condition which old log files get deleted.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code>retention<span class="token operator">=</span><span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span><span class="token operator">|</span><span class="token operator">&lt;</span>datetime<span class="token punctuation">.</span>timedelta<span class="token operator">&gt;</span><span class="token operator">|</span><span class="token operator">&lt;</span><span class="token builtin">str</span><span class="token operator">&gt;</span>
</code></pre></div><ul><li><strong><code>'&lt;int&gt;'</code> - Max number of files.</strong></li> <li><strong><code>'&lt;timedelta&gt;'</code> - Max age of a file.</strong></li> <li><strong><code>'&lt;str&gt;'</code> - Max age as a string: <code>'1 week, 3 days'</code>, <code>'2 months'</code>, ...</strong></li></ul> <h2 id="scraping">Scraping</h2> <h4 id="scrapes-python-s-url-version-number-and-logo-from-wikipedia-page">Scrapes Python's URL, version number and logo from Wikipedia page:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># $ pip3 install requests beautifulsoup4</span>
<span class="token keyword">import</span> requests
<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup
URL <span class="token operator">=</span> <span class="token string">'https://en.wikipedia.org/wiki/Python_(programming_language)'</span>
<span class="token keyword">try</span><span class="token punctuation">:</span>
    html  <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>URL<span class="token punctuation">)</span><span class="token punctuation">.</span>text
    doc   <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token string">'html.parser'</span><span class="token punctuation">)</span>
    table <span class="token operator">=</span> doc<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'table'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">'infobox vevent'</span><span class="token punctuation">)</span>
    rows  <span class="token operator">=</span> table<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'tr'</span><span class="token punctuation">)</span>
    link  <span class="token operator">=</span> rows<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'href'</span><span class="token punctuation">]</span>
    ver   <span class="token operator">=</span> rows<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    url_i <span class="token operator">=</span> rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'src'</span><span class="token punctuation">]</span>
    image <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'https:</span><span class="token interpolation"><span class="token punctuation">{</span>url_i<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>content
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'test.png'</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>image<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>link<span class="token punctuation">,</span> ver<span class="token punctuation">)</span>
<span class="token keyword">except</span> requests<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>ConnectionError<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;You've got problems with connection.&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="web">Web</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># $ pip3 install bottle</span>
<span class="token keyword">from</span> bottle <span class="token keyword">import</span> run<span class="token punctuation">,</span> route<span class="token punctuation">,</span> static_file<span class="token punctuation">,</span> template<span class="token punctuation">,</span> post<span class="token punctuation">,</span> request<span class="token punctuation">,</span> response
<span class="token keyword">import</span> json
</code></pre></div><h3 id="run">Run</h3> <div class="language-python extra-class"><pre class="language-python"><code>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'localhost'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8080</span><span class="token punctuation">)</span>        <span class="token comment"># Runs locally.</span>
run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">)</span>            <span class="token comment"># Runs globally.</span>
</code></pre></div><h3 id="static-request">Static Request</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token decorator annotation punctuation">@route</span><span class="token punctuation">(</span><span class="token string">'/img/&lt;image&gt;'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">send_image</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> static_file<span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token string">'img_dir/'</span><span class="token punctuation">,</span> mimetype<span class="token operator">=</span><span class="token string">'image/png'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="dynamic-request">Dynamic Request</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token decorator annotation punctuation">@route</span><span class="token punctuation">(</span><span class="token string">'/&lt;sport&gt;'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">send_page</span><span class="token punctuation">(</span>sport<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> template<span class="token punctuation">(</span><span class="token string">'&lt;h1&gt;{{title}}&lt;/h1&gt;'</span><span class="token punctuation">,</span> title<span class="token operator">=</span>sport<span class="token punctuation">)</span>
</code></pre></div><h3 id="rest-request">REST Request</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token decorator annotation punctuation">@post</span><span class="token punctuation">(</span><span class="token string">'/odds/&lt;sport&gt;'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">odds_handler</span><span class="token punctuation">(</span>sport<span class="token punctuation">)</span><span class="token punctuation">:</span>
    team <span class="token operator">=</span> request<span class="token punctuation">.</span>forms<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'team'</span><span class="token punctuation">)</span>
    home_odds<span class="token punctuation">,</span> away_odds <span class="token operator">=</span> <span class="token number">2.44</span><span class="token punctuation">,</span> <span class="token number">3.29</span>
    response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'Content-Type'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'application/json'</span>
    response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'Cache-Control'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'no-cache'</span>
    <span class="token keyword">return</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span><span class="token punctuation">[</span>team<span class="token punctuation">,</span> home_odds<span class="token punctuation">,</span> away_odds<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="test">Test:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># $ pip3 install requests</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">import</span> requests
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> url  <span class="token operator">=</span> <span class="token string">'http://localhost:8080/odds/football'</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'team'</span><span class="token punctuation">:</span> <span class="token string">'arsenal f.c.'</span><span class="token punctuation">}</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token string">'arsenal f.c.'</span><span class="token punctuation">,</span> <span class="token number">2.44</span><span class="token punctuation">,</span> <span class="token number">3.29</span><span class="token punctuation">]</span>
</code></pre></div><h2 id="profiling">Profiling</h2> <h3 id="stopwatch">Stopwatch</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> time <span class="token keyword">import</span> time
start_time <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>                     <span class="token comment"># Seconds since the Epoch.</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
duration <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start_time
</code></pre></div><h4 id="high-performance">High performance:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> time <span class="token keyword">import</span> perf_counter
start_time <span class="token operator">=</span> perf_counter<span class="token punctuation">(</span><span class="token punctuation">)</span>             <span class="token comment"># Seconds since restart.</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
duration <span class="token operator">=</span> perf_counter<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start_time
</code></pre></div><h3 id="timing-a-snippet">Timing a Snippet</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> timeit <span class="token keyword">import</span> timeit
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> timeit<span class="token punctuation">(</span><span class="token string">'&quot;-&quot;.join(str(a) for a in range(100))'</span><span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        number<span class="token operator">=</span><span class="token number">10000</span><span class="token punctuation">,</span> <span class="token builtin">globals</span><span class="token operator">=</span><span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> setup<span class="token operator">=</span><span class="token string">'pass'</span><span class="token punctuation">)</span>
<span class="token number">0.34986</span>
</code></pre></div><h3 id="profiling-by-line">Profiling by Line</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># $ pip3 install line_profiler memory_profiler</span>
<span class="token decorator annotation punctuation">@profile</span>
<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">*</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    b <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">*</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-text extra-class"><pre class="language-text"><code>$ kernprof -lv test.py
Line #   Hits     Time  Per Hit   % Time  Line Contents
=======================================================
     1                                    @profile
     2                                    def main():
     3      1   1128.0   1128.0     27.4      a = [*range(10000)]
     4      1   2994.0   2994.0     72.6      b = {*range(10000)}
</code></pre></div><div class="language-text extra-class"><pre class="language-text"><code>$ python3 -m memory_profiler test.py
Line #         Mem usage      Increment   Line Contents
=======================================================
     1        35.387 MiB     35.387 MiB   @profile
     2                                    def main():
     3        35.734 MiB      0.348 MiB       a = [*range(10000)]
     4        36.160 MiB      0.426 MiB       b = {*range(10000)}
</code></pre></div><h3 id="call-graph">Call Graph</h3> <h4 id="generates-a-png-image-of-a-call-graph-with-highlighted-bottlenecks">Generates a PNG image of a call graph with highlighted bottlenecks:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># $ pip3 install pycallgraph</span>
<span class="token keyword">from</span> pycallgraph <span class="token keyword">import</span> output<span class="token punctuation">,</span> PyCallGraph
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
time_str <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y%m%d%H%M%S'</span><span class="token punctuation">)</span>
filename <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'profile-</span><span class="token interpolation"><span class="token punctuation">{</span>time_str<span class="token punctuation">}</span></span><span class="token string">.png'</span></span>
drawer <span class="token operator">=</span> output<span class="token punctuation">.</span>GraphvizOutput<span class="token punctuation">(</span>output_file<span class="token operator">=</span>filename<span class="token punctuation">)</span>
<span class="token keyword">with</span> PyCallGraph<span class="token punctuation">(</span>drawer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token operator">&lt;</span>code_to_be_profiled<span class="token operator">&gt;</span>
</code></pre></div><h2 id="numpy">NumPy</h2> <p><strong>Array manipulation mini-language. It can run up to one hundred times faster than the equivalent Python code.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># $ pip3 install numpy</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token operator">&lt;</span>array<span class="token operator">&gt;</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>array<span class="token operator">&gt;</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>from_inclusive<span class="token punctuation">,</span> to_exclusive<span class="token punctuation">,</span> ±step_size<span class="token punctuation">)</span>
<span class="token operator">&lt;</span>array<span class="token operator">&gt;</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token operator">&lt;</span>shape<span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>array<span class="token operator">&gt;</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span>from_inclusive<span class="token punctuation">,</span> to_exclusive<span class="token punctuation">,</span> <span class="token operator">&lt;</span>shape<span class="token operator">&gt;</span><span class="token punctuation">)</span>

<span class="token operator">&lt;</span>array<span class="token operator">&gt;</span><span class="token punctuation">.</span>shape <span class="token operator">=</span> <span class="token operator">&lt;</span>shape<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span>array<span class="token operator">&gt;</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">&lt;</span>shape<span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>  <span class="token operator">=</span> np<span class="token punctuation">.</span>broadcast_to<span class="token punctuation">(</span><span class="token operator">&lt;</span>array<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>shape<span class="token operator">&gt;</span><span class="token punctuation">)</span>

<span class="token operator">&lt;</span>array<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>array<span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>axis<span class="token punctuation">)</span>
indexes <span class="token operator">=</span> <span class="token operator">&lt;</span>array<span class="token operator">&gt;</span><span class="token punctuation">.</span>argmin<span class="token punctuation">(</span>axis<span class="token punctuation">)</span>
</code></pre></div><ul><li><strong>Shape is a tuple of dimension sizes.</strong></li> <li><strong>Axis is the index of a dimension that gets collapsed. The leftmost dimension has index 0.</strong></li></ul> <h3 id="indexing">Indexing</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&lt;</span>el<span class="token operator">&gt;</span>       <span class="token operator">=</span> <span class="token operator">&lt;</span>2d_array<span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token number">0</span>, <span class="token number">0</span><span class="token punctuation">]</span>        <span class="token comment"># First element.</span>
<span class="token operator">&lt;</span>1d_view<span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span>2d_array<span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>           <span class="token comment"># First row.</span>
<span class="token operator">&lt;</span>1d_view<span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span>2d_array<span class="token operator">&gt;</span><span class="token punctuation">[</span>:, <span class="token number">0</span><span class="token punctuation">]</span>        <span class="token comment"># First column. Also [..., 0].</span>
<span class="token operator">&lt;</span>3d_view<span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span>2d_array<span class="token operator">&gt;</span><span class="token punctuation">[</span>None, :, :<span class="token punctuation">]</span>  <span class="token comment"># Expanded by dimension of size 1.</span>
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&lt;</span>1d_array<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>2d_array<span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token operator">&lt;</span>1d_row_indexes<span class="token operator">&gt;</span>, <span class="token operator">&lt;</span>1d_column_indexes<span class="token operator">&gt;</span><span class="token punctuation">]</span>
<span class="token operator">&lt;</span>2d_array<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>2d_array<span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token operator">&lt;</span>2d_row_indexes<span class="token operator">&gt;</span>, <span class="token operator">&lt;</span>2d_column_indexes<span class="token operator">&gt;</span><span class="token punctuation">]</span>
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&lt;</span>2d_bools<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>2d_array<span class="token operator">&gt;</span> <span class="token operator">&gt;</span> <span class="token number">0</span>
<span class="token operator">&lt;</span>1d_array<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>2d_array<span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token operator">&lt;</span>2d_bools<span class="token operator">&gt;</span><span class="token punctuation">]</span>
</code></pre></div><ul><li><strong>If row and column indexes differ in shape, they are combined with broadcasting.</strong></li></ul> <h3 id="broadcasting">Broadcasting</h3> <p><strong>Broadcasting is a set of rules by which NumPy functions operate on arrays of different sizes and/or dimensions.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code>left  <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.8</span><span class="token punctuation">]</span><span class="token punctuation">]</span>        <span class="token comment"># Shape: (3, 1)</span>
right <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token number">0.1</span> <span class="token punctuation">,</span>  <span class="token number">0.6</span> <span class="token punctuation">,</span>  <span class="token number">0.8</span> <span class="token punctuation">]</span>        <span class="token comment"># Shape: (3)</span>
</code></pre></div><h4 id="_1-if-array-shapes-differ-in-length-left-pad-the-shorter-shape-with-ones">1. If array shapes differ in length, left-pad the shorter shape with ones:</h4> <div class="language-python extra-class"><pre class="language-python"><code>left  <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.8</span><span class="token punctuation">]</span><span class="token punctuation">]</span>        <span class="token comment"># Shape: (3, 1)</span>
right <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.1</span> <span class="token punctuation">,</span>  <span class="token number">0.6</span> <span class="token punctuation">,</span>  <span class="token number">0.8</span><span class="token punctuation">]</span><span class="token punctuation">]</span>        <span class="token comment"># Shape: (1, 3) &lt;- !</span>
</code></pre></div><h4 id="_2-if-any-dimensions-differ-in-size-expand-the-ones-that-have-size-1-by-duplicating-their-elements">2. If any dimensions differ in size, expand the ones that have size 1 by duplicating their elements:</h4> <div class="language-python extra-class"><pre class="language-python"><code>left  <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.8</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">]</span><span class="token punctuation">]</span>  <span class="token comment"># Shape: (3, 3) &lt;- !</span>
right <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">]</span><span class="token punctuation">]</span>  <span class="token comment"># Shape: (3, 3) &lt;- !</span>
</code></pre></div><h4 id="_3-if-neither-non-matching-dimension-has-size-1-raise-an-error">3. If neither non-matching dimension has size 1, raise an error.</h4> <h3 id="example-3">Example</h3> <h4 id="for-each-point-returns-index-of-its-nearest-point-0-1-0-6-0-8-1-2-1">For each point returns index of its nearest point (<code>[0.1, 0.6, 0.8] =&gt; [1, 2, 1]</code>):</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> points <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
 <span class="token punctuation">[</span> <span class="token number">0.1</span><span class="token punctuation">,</span>  <span class="token number">0.6</span><span class="token punctuation">,</span>  <span class="token number">0.8</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> wrapped_points <span class="token operator">=</span> points<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token punctuation">[</span> <span class="token number">0.6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token punctuation">[</span> <span class="token number">0.8</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> distances <span class="token operator">=</span> wrapped_points <span class="token operator">-</span> points
<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token punctuation">[</span> <span class="token number">0.5</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">.</span> <span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token punctuation">[</span> <span class="token number">0.7</span><span class="token punctuation">,</span>  <span class="token number">0.2</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">.</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> distances <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">abs</span><span class="token punctuation">(</span>distances<span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">.</span> <span class="token punctuation">,</span>  <span class="token number">0.5</span><span class="token punctuation">,</span>  <span class="token number">0.7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token punctuation">[</span> <span class="token number">0.5</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">.</span> <span class="token punctuation">,</span>  <span class="token number">0.2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token punctuation">[</span> <span class="token number">0.7</span><span class="token punctuation">,</span>  <span class="token number">0.2</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">.</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> i <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> distances<span class="token punctuation">[</span>i<span class="token punctuation">,</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>inf
<span class="token punctuation">[</span><span class="token punctuation">[</span> inf<span class="token punctuation">,</span>  <span class="token number">0.5</span><span class="token punctuation">,</span>  <span class="token number">0.7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token punctuation">[</span> <span class="token number">0.5</span><span class="token punctuation">,</span>  inf<span class="token punctuation">,</span>  <span class="token number">0.2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token punctuation">[</span> <span class="token number">0.7</span><span class="token punctuation">,</span>  <span class="token number">0.2</span><span class="token punctuation">,</span>  inf<span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> distances<span class="token punctuation">.</span>argmin<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
</code></pre></div><h2 id="image">Image</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># $ pip3 install pillow</span>
<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image

<span class="token operator">&lt;</span>Image<span class="token operator">&gt;</span> <span class="token operator">=</span> Image<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token string">'&lt;mode&gt;'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>Image<span class="token operator">&gt;</span> <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'&lt;path&gt;'</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>Image<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>Image<span class="token operator">&gt;</span><span class="token punctuation">.</span>convert<span class="token punctuation">(</span><span class="token string">'&lt;mode&gt;'</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>Image<span class="token operator">&gt;</span><span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'&lt;path&gt;'</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>Image<span class="token operator">&gt;</span><span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token operator">&lt;</span><span class="token builtin">tuple</span><span class="token operator">/</span><span class="token builtin">int</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>Image<span class="token operator">&gt;</span><span class="token punctuation">.</span>getpixel<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span>          <span class="token comment"># Returns a pixel.</span>
<span class="token operator">&lt;</span>Image<span class="token operator">&gt;</span><span class="token punctuation">.</span>putpixel<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">tuple</span><span class="token operator">/</span><span class="token builtin">int</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>           <span class="token comment"># Writes a pixel to the image.</span>
<span class="token operator">&lt;</span>ImagingCore<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>Image<span class="token operator">&gt;</span><span class="token punctuation">.</span>getdata<span class="token punctuation">(</span><span class="token punctuation">)</span>               <span class="token comment"># Returns a sequence of pixels.</span>
<span class="token operator">&lt;</span>Image<span class="token operator">&gt;</span><span class="token punctuation">.</span>putdata<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">/</span>ImagingCore<span class="token operator">&gt;</span><span class="token punctuation">)</span>             <span class="token comment"># Writes a sequence of pixels.</span>
<span class="token operator">&lt;</span>Image<span class="token operator">&gt;</span><span class="token punctuation">.</span>paste<span class="token punctuation">(</span><span class="token operator">&lt;</span>Image<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span>                  <span class="token comment"># Writes an image to the image.</span>
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&lt;</span>2d_array<span class="token operator">&gt;</span> <span class="token operator">=</span> np.array<span class="token punctuation">(</span><span class="token operator">&lt;</span>Image<span class="token operator">&gt;</span><span class="token punctuation">)</span>                  <span class="token comment"># Creates NumPy array from greyscale image.</span>
<span class="token operator">&lt;</span>3d_array<span class="token operator">&gt;</span> <span class="token operator">=</span> np.array<span class="token punctuation">(</span><span class="token operator">&lt;</span>Image<span class="token operator">&gt;</span><span class="token punctuation">)</span>                  <span class="token comment"># Creates NumPy array from color image.</span>
<span class="token operator">&lt;</span>Image<span class="token operator">&gt;</span>    <span class="token operator">=</span> Image.fromarray<span class="token punctuation">(</span><span class="token operator">&lt;</span>array<span class="token operator">&gt;</span><span class="token punctuation">)</span>           <span class="token comment"># Creates image from NumPy array of floats.</span>
</code></pre></div><h3 id="modes-2">Modes</h3> <ul><li><strong><code>'1'</code> - 1-bit pixels, black and white, stored with one pixel per byte.</strong></li> <li><strong><code>'L'</code> - 8-bit pixels, greyscale.</strong></li> <li><strong><code>'RGB'</code> - 3x8-bit pixels, true color.</strong></li> <li><strong><code>'RGBA'</code> - 4x8-bit pixels, true color with transparency mask.</strong></li> <li><strong><code>'HSV'</code> - 3x8-bit pixels, Hue, Saturation, Value color space.</strong></li></ul> <h3 id="examples">Examples</h3> <h4 id="creates-a-png-image-of-a-rainbow-gradient">Creates a PNG image of a rainbow gradient:</h4> <div class="language-python extra-class"><pre class="language-python"><code>WIDTH<span class="token punctuation">,</span> HEIGHT <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span>
size <span class="token operator">=</span> WIDTH <span class="token operator">*</span> HEIGHT
hues <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">255</span> <span class="token operator">*</span> i<span class="token operator">/</span>size <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">]</span>
img <span class="token operator">=</span> Image<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token string">'HSV'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>WIDTH<span class="token punctuation">,</span> HEIGHT<span class="token punctuation">)</span><span class="token punctuation">)</span>
img<span class="token punctuation">.</span>putdata<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">for</span> h <span class="token keyword">in</span> hues<span class="token punctuation">]</span><span class="token punctuation">)</span>
img<span class="token punctuation">.</span>convert<span class="token punctuation">(</span><span class="token string">'RGB'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'test.png'</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="adds-noise-to-a-png-image">Adds noise to a PNG image:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> random <span class="token keyword">import</span> randint
add_noise <span class="token operator">=</span> <span class="token keyword">lambda</span> value<span class="token punctuation">:</span> <span class="token builtin">max</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">min</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> value <span class="token operator">+</span> randint<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
img <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'test.png'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>convert<span class="token punctuation">(</span><span class="token string">'HSV'</span><span class="token punctuation">)</span>
img<span class="token punctuation">.</span>putdata<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span>add_noise<span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">,</span> v<span class="token punctuation">)</span> <span class="token keyword">for</span> h<span class="token punctuation">,</span> s<span class="token punctuation">,</span> v <span class="token keyword">in</span> img<span class="token punctuation">.</span>getdata<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
img<span class="token punctuation">.</span>convert<span class="token punctuation">(</span><span class="token string">'RGB'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'test.png'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="drawing">Drawing</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> PIL <span class="token keyword">import</span> ImageDraw

<span class="token operator">&lt;</span>ImageDraw<span class="token operator">&gt;</span> <span class="token operator">=</span> ImageDraw<span class="token punctuation">.</span>Draw<span class="token punctuation">(</span><span class="token operator">&lt;</span>Image<span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>ImageDraw<span class="token operator">&gt;</span><span class="token punctuation">.</span>point<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> fill<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>ImageDraw<span class="token operator">&gt;</span><span class="token punctuation">.</span>line<span class="token punctuation">(</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> y2 <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fill<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> joint<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span> 
<span class="token operator">&lt;</span>ImageDraw<span class="token operator">&gt;</span><span class="token punctuation">.</span>arc<span class="token punctuation">(</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> y2<span class="token punctuation">)</span><span class="token punctuation">,</span> from_deg<span class="token punctuation">,</span> to_deg<span class="token punctuation">,</span> fill<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>ImageDraw<span class="token operator">&gt;</span><span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> y2<span class="token punctuation">)</span><span class="token punctuation">,</span> fill<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> outline<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>ImageDraw<span class="token operator">&gt;</span><span class="token punctuation">.</span>polygon<span class="token punctuation">(</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> y2 <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fill<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> outline<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>ImageDraw<span class="token operator">&gt;</span><span class="token punctuation">.</span>ellipse<span class="token punctuation">(</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> y2<span class="token punctuation">)</span><span class="token punctuation">,</span> fill<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> outline<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><strong>Use <code>'fill=&lt;color&gt;'</code> to set the primary color.</strong></li> <li><strong>Use <code>'outline=&lt;color&gt;'</code> to set the secondary color.</strong></li> <li><strong>Color can be specified as a tuple, int, <code>'#rrggbb'</code> string or a color name.</strong></li></ul> <h2 id="animation">Animation</h2> <h4 id="creates-a-gif-of-a-bouncing-ball">Creates a GIF of a bouncing ball:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># $ pip3 install pillow imageio</span>
<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token punctuation">,</span> ImageDraw
<span class="token keyword">import</span> imageio
WIDTH<span class="token punctuation">,</span> R <span class="token operator">=</span> <span class="token number">126</span><span class="token punctuation">,</span> <span class="token number">10</span>
frames <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> velocity <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    y <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>velocity<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    frame <span class="token operator">=</span> Image<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token string">'L'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>WIDTH<span class="token punctuation">,</span> WIDTH<span class="token punctuation">)</span><span class="token punctuation">)</span>
    draw  <span class="token operator">=</span> ImageDraw<span class="token punctuation">.</span>Draw<span class="token punctuation">(</span>frame<span class="token punctuation">)</span>
    draw<span class="token punctuation">.</span>ellipse<span class="token punctuation">(</span><span class="token punctuation">(</span>WIDTH<span class="token operator">/</span><span class="token number">2</span><span class="token operator">-</span>R<span class="token punctuation">,</span> y<span class="token punctuation">,</span> WIDTH<span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span>R<span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">2</span><span class="token operator">*</span>R<span class="token punctuation">)</span><span class="token punctuation">,</span> fill<span class="token operator">=</span><span class="token string">'white'</span><span class="token punctuation">)</span>
    frames<span class="token punctuation">.</span>append<span class="token punctuation">(</span>frame<span class="token punctuation">)</span>
frames <span class="token operator">+=</span> <span class="token builtin">reversed</span><span class="token punctuation">(</span>frames<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
imageio<span class="token punctuation">.</span>mimsave<span class="token punctuation">(</span><span class="token string">'test.gif'</span><span class="token punctuation">,</span> frames<span class="token punctuation">,</span> duration<span class="token operator">=</span><span class="token number">0.03</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="audio">Audio</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> wave

<span class="token operator">&lt;</span>Wave_read<span class="token operator">&gt;</span>  <span class="token operator">=</span> wave<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'&lt;path&gt;'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span>        <span class="token comment"># Opens the WAV file.</span>
framerate    <span class="token operator">=</span> <span class="token operator">&lt;</span>Wave_read<span class="token operator">&gt;</span><span class="token punctuation">.</span>getframerate<span class="token punctuation">(</span><span class="token punctuation">)</span>       <span class="token comment"># Number of frames per second.</span>
nchannels    <span class="token operator">=</span> <span class="token operator">&lt;</span>Wave_read<span class="token operator">&gt;</span><span class="token punctuation">.</span>getnchannels<span class="token punctuation">(</span><span class="token punctuation">)</span>       <span class="token comment"># Number of samples per frame.</span>
sampwidth    <span class="token operator">=</span> <span class="token operator">&lt;</span>Wave_read<span class="token operator">&gt;</span><span class="token punctuation">.</span>getsampwidth<span class="token punctuation">(</span><span class="token punctuation">)</span>       <span class="token comment"># Sample size in bytes.</span>
nframes      <span class="token operator">=</span> <span class="token operator">&lt;</span>Wave_read<span class="token operator">&gt;</span><span class="token punctuation">.</span>getnframes<span class="token punctuation">(</span><span class="token punctuation">)</span>         <span class="token comment"># Number of frames.</span>
<span class="token operator">&lt;</span>params<span class="token operator">&gt;</span>     <span class="token operator">=</span> <span class="token operator">&lt;</span>Wave_read<span class="token operator">&gt;</span><span class="token punctuation">.</span>getparams<span class="token punctuation">(</span><span class="token punctuation">)</span>          <span class="token comment"># Immutable collection of above.</span>
<span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span>      <span class="token operator">=</span> <span class="token operator">&lt;</span>Wave_read<span class="token operator">&gt;</span><span class="token punctuation">.</span>readframes<span class="token punctuation">(</span>nframes<span class="token punctuation">)</span>  <span class="token comment"># Returns next 'nframes' frames.</span>

<span class="token operator">&lt;</span>Wave_write<span class="token operator">&gt;</span> <span class="token operator">=</span> wave<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'&lt;path&gt;'</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span>        <span class="token comment"># Truncates existing file.</span>
<span class="token operator">&lt;</span>Wave_write<span class="token operator">&gt;</span><span class="token punctuation">.</span>setframerate<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>                <span class="token comment"># 44100 for CD, 48000 for video.</span>
<span class="token operator">&lt;</span>Wave_write<span class="token operator">&gt;</span><span class="token punctuation">.</span>setnchannels<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>                <span class="token comment"># 1 for mono, 2 for stereo.</span>
<span class="token operator">&lt;</span>Wave_write<span class="token operator">&gt;</span><span class="token punctuation">.</span>setsampwidth<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>                <span class="token comment"># 2 for CD quality sound.</span>
<span class="token operator">&lt;</span>Wave_write<span class="token operator">&gt;</span><span class="token punctuation">.</span>setparams<span class="token punctuation">(</span><span class="token operator">&lt;</span>params<span class="token operator">&gt;</span><span class="token punctuation">)</span>                <span class="token comment"># Sets all parameters.</span>
<span class="token operator">&lt;</span>Wave_write<span class="token operator">&gt;</span><span class="token punctuation">.</span>writeframes<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">bytes</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>               <span class="token comment"># Appends frames to file.</span>
</code></pre></div><ul><li><strong>Bytes object contains a sequence of frames, each consisting of one or more samples.</strong></li> <li><strong>In a stereo signal, the first sample of a frame belongs to the left channel.</strong></li> <li><strong>Each sample consists of one or more bytes that, when converted to an integer, indicate the displacement of a speaker membrane at a given moment.</strong></li> <li><strong>If sample width is one, then the integer should be encoded unsigned.</strong></li> <li><strong>For all other sizes, the integer should be encoded signed with little-endian byte order.</strong></li></ul> <h3 id="sample-values">Sample Values</h3> <div class="language-text extra-class"><pre class="language-text"><code>+-----------+-------------+------+-------------+
| sampwidth |     min     | zero |     max     |
+-----------+-------------+------+-------------+
|     1     |           0 |  128 |         255 |
|     2     |      -32768 |    0 |       32767 |
|     3     |    -8388608 |    0 |     8388607 |
|     4     | -2147483648 |    0 |  2147483647 |
+-----------+-------------+------+-------------+
</code></pre></div><h3 id="read-float-samples-from-wav-file">Read Float Samples from WAV File</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">read_wav_file</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get_int</span><span class="token punctuation">(</span>a_bytes<span class="token punctuation">)</span><span class="token punctuation">:</span>
        an_int <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>a_bytes<span class="token punctuation">,</span> <span class="token string">'little'</span><span class="token punctuation">,</span> signed<span class="token operator">=</span>width<span class="token operator">!=</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> an_int <span class="token operator">-</span> <span class="token number">128</span> <span class="token operator">*</span> <span class="token punctuation">(</span>width <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">with</span> wave<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        width  <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>getsampwidth<span class="token punctuation">(</span><span class="token punctuation">)</span>
        frames <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>readframes<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">.</span>getnframes<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    byte_samples <span class="token operator">=</span> <span class="token punctuation">(</span>frames<span class="token punctuation">[</span>i<span class="token punctuation">:</span> i <span class="token operator">+</span> width<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>frames<span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>get_int<span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> width <span class="token operator">*</span> <span class="token number">8</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">for</span> b <span class="token keyword">in</span> byte_samples<span class="token punctuation">]</span>
</code></pre></div><h3 id="write-float-samples-to-wav-file">Write Float Samples to WAV File</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">write_to_wav_file</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> float_samples<span class="token punctuation">,</span> nchannels<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> sampwidth<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> framerate<span class="token operator">=</span><span class="token number">44100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get_bytes</span><span class="token punctuation">(</span>a_float<span class="token punctuation">)</span><span class="token punctuation">:</span>
        a_float <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">min</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> <span class="token number">2e</span><span class="token operator">-</span><span class="token number">16</span><span class="token punctuation">,</span> a_float<span class="token punctuation">)</span><span class="token punctuation">)</span>
        a_float <span class="token operator">+=</span> sampwidth <span class="token operator">==</span> <span class="token number">1</span>
        a_float <span class="token operator">*=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> sampwidth <span class="token operator">*</span> <span class="token number">8</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>a_float<span class="token punctuation">)</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span>sampwidth<span class="token punctuation">,</span> <span class="token string">'little'</span><span class="token punctuation">,</span> signed<span class="token operator">=</span>sampwidth<span class="token operator">!=</span><span class="token number">1</span><span class="token punctuation">)</span> 
    <span class="token keyword">with</span> wave<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        <span class="token builtin">file</span><span class="token punctuation">.</span>setnchannels<span class="token punctuation">(</span>nchannels<span class="token punctuation">)</span>
        <span class="token builtin">file</span><span class="token punctuation">.</span>setsampwidth<span class="token punctuation">(</span>sampwidth<span class="token punctuation">)</span>
        <span class="token builtin">file</span><span class="token punctuation">.</span>setframerate<span class="token punctuation">(</span>framerate<span class="token punctuation">)</span>
        <span class="token builtin">file</span><span class="token punctuation">.</span>writeframes<span class="token punctuation">(</span><span class="token string">b''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>get_bytes<span class="token punctuation">(</span>f<span class="token punctuation">)</span> <span class="token keyword">for</span> f <span class="token keyword">in</span> float_samples<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="examples-2">Examples</h3> <h4 id="saves-a-sine-wave-to-a-mono-wav-file">Saves a sine wave to a mono WAV file:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> math <span class="token keyword">import</span> pi<span class="token punctuation">,</span> sin
samples_f <span class="token operator">=</span> <span class="token punctuation">(</span>sin<span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">*</span> pi <span class="token operator">*</span> <span class="token number">440</span> <span class="token operator">/</span> <span class="token number">44100</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
write_to_wav_file<span class="token punctuation">(</span><span class="token string">'test.wav'</span><span class="token punctuation">,</span> samples_f<span class="token punctuation">)</span>
</code></pre></div><h4 id="adds-noise-to-a-mono-wav-file">Adds noise to a mono WAV file:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> random <span class="token keyword">import</span> random
add_noise <span class="token operator">=</span> <span class="token keyword">lambda</span> value<span class="token punctuation">:</span> value <span class="token operator">+</span> <span class="token punctuation">(</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.03</span>
samples_f <span class="token operator">=</span> <span class="token punctuation">(</span>add_noise<span class="token punctuation">(</span>f<span class="token punctuation">)</span> <span class="token keyword">for</span> f <span class="token keyword">in</span> read_wav_file<span class="token punctuation">(</span><span class="token string">'test.wav'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
write_to_wav_file<span class="token punctuation">(</span><span class="token string">'test.wav'</span><span class="token punctuation">,</span> samples_f<span class="token punctuation">)</span>
</code></pre></div><h4 id="plays-a-wav-file">Plays a WAV file:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># $ pip3 install simpleaudio</span>
<span class="token keyword">from</span> simpleaudio <span class="token keyword">import</span> play_buffer
<span class="token keyword">with</span> wave<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'test.wav'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
    p <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>getparams<span class="token punctuation">(</span><span class="token punctuation">)</span>
    frames <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>readframes<span class="token punctuation">(</span>p<span class="token punctuation">.</span>nframes<span class="token punctuation">)</span>
    play_buffer<span class="token punctuation">(</span>frames<span class="token punctuation">,</span> p<span class="token punctuation">.</span>nchannels<span class="token punctuation">,</span> p<span class="token punctuation">.</span>sampwidth<span class="token punctuation">,</span> p<span class="token punctuation">.</span>framerate<span class="token punctuation">)</span>
</code></pre></div><h3 id="text-to-speech">Text to Speech</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># $ pip3 install pyttsx3</span>
<span class="token keyword">import</span> pyttsx3
engine <span class="token operator">=</span> pyttsx3<span class="token punctuation">.</span>init<span class="token punctuation">(</span><span class="token punctuation">)</span>
engine<span class="token punctuation">.</span>say<span class="token punctuation">(</span><span class="token string">'Sally sells seashells by the seashore.'</span><span class="token punctuation">)</span>
engine<span class="token punctuation">.</span>runAndWait<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="synthesizer">Synthesizer</h2> <h4 id="plays-popcorn-by-gershon-kingsley">Plays Popcorn by Gershon Kingsley:</h4> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># $ pip3 install simpleaudio</span>
<span class="token keyword">import</span> simpleaudio<span class="token punctuation">,</span> math<span class="token punctuation">,</span> struct
<span class="token keyword">from</span> itertools <span class="token keyword">import</span> chain<span class="token punctuation">,</span> repeat
F  <span class="token operator">=</span> <span class="token number">44100</span>
P1 <span class="token operator">=</span> <span class="token string">'71♪,69,,71♪,66,,62♪,66,,59♪,,,'</span>
P2 <span class="token operator">=</span> <span class="token string">'71♪,73,,74♪,73,,74,,71,,73♪,71,,73,,69,,71♪,69,,71,,67,,71♪,,,'</span>
get_pause   <span class="token operator">=</span> <span class="token keyword">lambda</span> seconds<span class="token punctuation">:</span> repeat<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>seconds <span class="token operator">*</span> F<span class="token punctuation">)</span><span class="token punctuation">)</span>
sin_f       <span class="token operator">=</span> <span class="token keyword">lambda</span> i<span class="token punctuation">,</span> hz<span class="token punctuation">:</span> math<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>pi <span class="token operator">*</span> hz <span class="token operator">/</span> F<span class="token punctuation">)</span>
get_wave    <span class="token operator">=</span> <span class="token keyword">lambda</span> hz<span class="token punctuation">,</span> seconds<span class="token punctuation">:</span> <span class="token punctuation">(</span>sin_f<span class="token punctuation">(</span>i<span class="token punctuation">,</span> hz<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>seconds <span class="token operator">*</span> F<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
get_hz      <span class="token operator">=</span> <span class="token keyword">lambda</span> key<span class="token punctuation">:</span> <span class="token number">8.176</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">12</span><span class="token punctuation">)</span>
parse_note  <span class="token operator">=</span> <span class="token keyword">lambda</span> note<span class="token punctuation">:</span> <span class="token punctuation">(</span>get_hz<span class="token punctuation">(</span>note<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.25</span> <span class="token keyword">if</span> <span class="token string">'♪'</span> <span class="token keyword">in</span> note <span class="token keyword">else</span> <span class="token number">0.125</span><span class="token punctuation">)</span>
get_samples <span class="token operator">=</span> <span class="token keyword">lambda</span> note<span class="token punctuation">:</span> get_wave<span class="token punctuation">(</span><span class="token operator">*</span>parse_note<span class="token punctuation">(</span>note<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">if</span> note <span class="token keyword">else</span> get_pause<span class="token punctuation">(</span><span class="token number">0.125</span><span class="token punctuation">)</span>
samples_f   <span class="token operator">=</span> chain<span class="token punctuation">.</span>from_iterable<span class="token punctuation">(</span>get_samples<span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>P1<span class="token punctuation">}</span></span><span class="token interpolation"><span class="token punctuation">{</span>P1<span class="token punctuation">}</span></span><span class="token interpolation"><span class="token punctuation">{</span>P2<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
samples_b   <span class="token operator">=</span> <span class="token string">b''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>struct<span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token string">'&lt;h'</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>f <span class="token operator">*</span> <span class="token number">30000</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> f <span class="token keyword">in</span> samples_f<span class="token punctuation">)</span>
simpleaudio<span class="token punctuation">.</span>play_buffer<span class="token punctuation">(</span>samples_b<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> F<span class="token punctuation">)</span>
</code></pre></div><h2 id="pygame">Pygame</h2> <h3 id="basic-example-2">Basic Example</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># $ pip3 install pygame</span>
<span class="token keyword">import</span> pygame <span class="token keyword">as</span> pg
pg<span class="token punctuation">.</span>init<span class="token punctuation">(</span><span class="token punctuation">)</span>
screen <span class="token operator">=</span> pg<span class="token punctuation">.</span>display<span class="token punctuation">.</span>set_mode<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
rect <span class="token operator">=</span> pg<span class="token punctuation">.</span>Rect<span class="token punctuation">(</span><span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token builtin">all</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token builtin">type</span> <span class="token operator">!=</span> pg<span class="token punctuation">.</span>QUIT <span class="token keyword">for</span> event <span class="token keyword">in</span> pg<span class="token punctuation">.</span>event<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    deltas <span class="token operator">=</span> <span class="token punctuation">{</span>pg<span class="token punctuation">.</span>K_UP<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pg<span class="token punctuation">.</span>K_RIGHT<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pg<span class="token punctuation">.</span>K_DOWN<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pg<span class="token punctuation">.</span>K_LEFT<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token keyword">for</span> delta <span class="token keyword">in</span> <span class="token punctuation">(</span>deltas<span class="token punctuation">.</span>get<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i<span class="token punctuation">,</span> on <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>pg<span class="token punctuation">.</span>key<span class="token punctuation">.</span>get_pressed<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">if</span> on<span class="token punctuation">)</span><span class="token punctuation">:</span>
        rect <span class="token operator">=</span> rect<span class="token punctuation">.</span>move<span class="token punctuation">(</span>delta<span class="token punctuation">)</span> <span class="token keyword">if</span> delta <span class="token keyword">else</span> rect
    screen<span class="token punctuation">.</span>fill<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    pg<span class="token punctuation">.</span>draw<span class="token punctuation">.</span>rect<span class="token punctuation">(</span>screen<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rect<span class="token punctuation">)</span>
    pg<span class="token punctuation">.</span>display<span class="token punctuation">.</span>flip<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="rect">Rect</h3> <p><strong>Object for storing rectangular coordinates.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span>Rect<span class="token operator">&gt;</span> <span class="token operator">=</span> pg<span class="token punctuation">.</span>Rect<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span>Rect<span class="token operator">&gt;</span><span class="token punctuation">.</span>x<span class="token operator">/</span>y<span class="token operator">/</span>centerx<span class="token operator">/</span>centery
<span class="token operator">&lt;</span>tup<span class="token punctuation">.</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>Rect<span class="token operator">&gt;</span><span class="token punctuation">.</span>topleft<span class="token operator">/</span>center
<span class="token operator">&lt;</span>Rect<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>Rect<span class="token operator">&gt;</span><span class="token punctuation">.</span>move<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token operator">&lt;</span><span class="token builtin">bool</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>Rect<span class="token operator">&gt;</span><span class="token punctuation">.</span>collidepoint<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token comment"># Tests if a point is inside a rectangle.</span>
<span class="token operator">&lt;</span><span class="token builtin">bool</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>Rect<span class="token operator">&gt;</span><span class="token punctuation">.</span>colliderect<span class="token punctuation">(</span><span class="token operator">&lt;</span>Rect<span class="token operator">&gt;</span><span class="token punctuation">)</span>             <span class="token comment"># Tests if two rectangles overlap.</span>
<span class="token operator">&lt;</span><span class="token builtin">int</span><span class="token operator">&gt;</span>  <span class="token operator">=</span> <span class="token operator">&lt;</span>Rect<span class="token operator">&gt;</span><span class="token punctuation">.</span>collidelist<span class="token punctuation">(</span><span class="token operator">&lt;</span>list_of_Rect<span class="token operator">&gt;</span><span class="token punctuation">)</span>     <span class="token comment"># Returns index of first colliding Rect or -1.</span>
<span class="token operator">&lt;</span><span class="token builtin">list</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>Rect<span class="token operator">&gt;</span><span class="token punctuation">.</span>collidelistall<span class="token punctuation">(</span><span class="token operator">&lt;</span>list_of_Rect<span class="token operator">&gt;</span><span class="token punctuation">)</span>  <span class="token comment"># Returns indices of all colliding Rects.</span>
</code></pre></div><h3 id="surface">Surface</h3> <p><strong>Object for representing images.</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span>Surf<span class="token operator">&gt;</span> <span class="token operator">=</span> pg<span class="token punctuation">.</span>display<span class="token punctuation">.</span>set_mode<span class="token punctuation">(</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment"># Returns the display surface.</span>
<span class="token operator">&lt;</span>Surf<span class="token operator">&gt;</span> <span class="token operator">=</span> pg<span class="token punctuation">.</span>Surface<span class="token punctuation">(</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token comment"># Creates a new surface.</span>
<span class="token operator">&lt;</span>Surf<span class="token operator">&gt;</span> <span class="token operator">=</span> pg<span class="token punctuation">.</span>image<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">'&lt;path&gt;'</span><span class="token punctuation">)</span>                <span class="token comment"># Loads the image.</span>
<span class="token operator">&lt;</span>Surf<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>Surf<span class="token operator">&gt;</span><span class="token punctuation">.</span>subsurface<span class="token punctuation">(</span><span class="token operator">&lt;</span>Rect<span class="token operator">&gt;</span><span class="token punctuation">)</span>              <span class="token comment"># Returns a subsurface.</span>

<span class="token operator">&lt;</span>Surf<span class="token operator">&gt;</span><span class="token punctuation">.</span>fill<span class="token punctuation">(</span>color<span class="token punctuation">)</span>                              <span class="token comment"># Fills the whole surface.</span>
<span class="token operator">&lt;</span>Surf<span class="token operator">&gt;</span><span class="token punctuation">.</span>set_at<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> color<span class="token punctuation">)</span>                    <span class="token comment"># Updates pixel.</span>
<span class="token operator">&lt;</span>Surf<span class="token operator">&gt;</span><span class="token punctuation">.</span>blit<span class="token punctuation">(</span><span class="token operator">&lt;</span>Surface<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span>                  <span class="token comment"># Draws passed surface to the surface.</span>

<span class="token operator">&lt;</span>Surf<span class="token operator">&gt;</span> <span class="token operator">=</span> pg<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>flip<span class="token punctuation">(</span><span class="token operator">&lt;</span>Surf<span class="token operator">&gt;</span><span class="token punctuation">,</span> xbool<span class="token punctuation">,</span> ybool<span class="token punctuation">)</span>
<span class="token operator">&lt;</span>Surf<span class="token operator">&gt;</span> <span class="token operator">=</span> pg<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>rotate<span class="token punctuation">(</span><span class="token operator">&lt;</span>Surf<span class="token operator">&gt;</span><span class="token punctuation">,</span> degrees<span class="token punctuation">)</span>
<span class="token operator">&lt;</span>Surf<span class="token operator">&gt;</span> <span class="token operator">=</span> pg<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>scale<span class="token punctuation">(</span><span class="token operator">&lt;</span>Surf<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">)</span>

pg<span class="token punctuation">.</span>draw<span class="token punctuation">.</span>line<span class="token punctuation">(</span><span class="token operator">&lt;</span>Surf<span class="token operator">&gt;</span><span class="token punctuation">,</span> color<span class="token punctuation">,</span> <span class="token punctuation">(</span>x1<span class="token punctuation">,</span> y1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x2<span class="token punctuation">,</span> y2<span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token punctuation">)</span>
pg<span class="token punctuation">.</span>draw<span class="token punctuation">.</span>arc<span class="token punctuation">(</span><span class="token operator">&lt;</span>Surf<span class="token operator">&gt;</span><span class="token punctuation">,</span> color<span class="token punctuation">,</span> <span class="token operator">&lt;</span>Rect<span class="token operator">&gt;</span><span class="token punctuation">,</span> from_radians<span class="token punctuation">,</span> to_radians<span class="token punctuation">)</span>
pg<span class="token punctuation">.</span>draw<span class="token punctuation">.</span>rect<span class="token punctuation">(</span><span class="token operator">&lt;</span>Surf<span class="token operator">&gt;</span><span class="token punctuation">,</span> color<span class="token punctuation">,</span> <span class="token operator">&lt;</span>Rect<span class="token operator">&gt;</span><span class="token punctuation">)</span>
pg<span class="token punctuation">.</span>draw<span class="token punctuation">.</span>polygon<span class="token punctuation">(</span><span class="token operator">&lt;</span>Surf<span class="token operator">&gt;</span><span class="token punctuation">,</span> color<span class="token punctuation">,</span> points<span class="token punctuation">)</span>
pg<span class="token punctuation">.</span>draw<span class="token punctuation">.</span>ellipse<span class="token punctuation">(</span><span class="token operator">&lt;</span>Surf<span class="token operator">&gt;</span><span class="token punctuation">,</span> color<span class="token punctuation">,</span> <span class="token operator">&lt;</span>Rect<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="font">Font</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span>Font<span class="token operator">&gt;</span> <span class="token operator">=</span> pg<span class="token punctuation">.</span>font<span class="token punctuation">.</span>SysFont<span class="token punctuation">(</span><span class="token string">'&lt;name&gt;'</span><span class="token punctuation">,</span> size<span class="token punctuation">,</span> bold<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> italic<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>Font<span class="token operator">&gt;</span> <span class="token operator">=</span> pg<span class="token punctuation">.</span>font<span class="token punctuation">.</span>Font<span class="token punctuation">(</span><span class="token string">'&lt;path&gt;'</span><span class="token punctuation">,</span> size<span class="token punctuation">)</span>
<span class="token operator">&lt;</span>Surf<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>Font<span class="token operator">&gt;</span><span class="token punctuation">.</span>render<span class="token punctuation">(</span>text<span class="token punctuation">,</span> antialias<span class="token punctuation">,</span> color<span class="token punctuation">,</span> background<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="sound">Sound</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&lt;</span>Sound<span class="token operator">&gt;</span> <span class="token operator">=</span> pg<span class="token punctuation">.</span>mixer<span class="token punctuation">.</span>Sound<span class="token punctuation">(</span><span class="token string">'&lt;path&gt;'</span><span class="token punctuation">)</span>              <span class="token comment"># Loads the WAV file.</span>
<span class="token operator">&lt;</span>Sound<span class="token operator">&gt;</span><span class="token punctuation">.</span>play<span class="token punctuation">(</span><span class="token punctuation">)</span>                                  <span class="token comment"># Starts playing the sound.</span>
</code></pre></div><h3 id="basic-mario-brothers-example">Basic Mario Brothers Example</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> collections<span class="token punctuation">,</span> dataclasses<span class="token punctuation">,</span> enum<span class="token punctuation">,</span> io<span class="token punctuation">,</span> math<span class="token punctuation">,</span> pygame<span class="token punctuation">,</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">,</span> itertools <span class="token keyword">as</span> it
<span class="token keyword">from</span> random <span class="token keyword">import</span> randint

P <span class="token operator">=</span> collections<span class="token punctuation">.</span>namedtuple<span class="token punctuation">(</span><span class="token string">'P'</span><span class="token punctuation">,</span> <span class="token string">'x y'</span><span class="token punctuation">)</span>          <span class="token comment"># Position</span>
D <span class="token operator">=</span> enum<span class="token punctuation">.</span>Enum<span class="token punctuation">(</span><span class="token string">'D'</span><span class="token punctuation">,</span> <span class="token string">'n e s w'</span><span class="token punctuation">)</span>                   <span class="token comment"># Direction</span>
SIZE<span class="token punctuation">,</span> MAX_SPEED <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> P<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>                  <span class="token comment"># Screen size, Speed limit</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get_screen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        pygame<span class="token punctuation">.</span>init<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> pygame<span class="token punctuation">.</span>display<span class="token punctuation">.</span>set_mode<span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">[</span>SIZE<span class="token operator">*</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">get_images</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        url <span class="token operator">=</span> <span class="token string">'https://gto76.github.io/python-cheatsheet/web/mario_bros.png'</span>
        img <span class="token operator">=</span> pygame<span class="token punctuation">.</span>image<span class="token punctuation">.</span>load<span class="token punctuation">(</span>io<span class="token punctuation">.</span>BytesIO<span class="token punctuation">(</span>urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>img<span class="token punctuation">.</span>subsurface<span class="token punctuation">(</span>get_rect<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>img<span class="token punctuation">.</span>get_width<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">def</span> <span class="token function">get_mario</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        Mario <span class="token operator">=</span> dataclasses<span class="token punctuation">.</span>make_dataclass<span class="token punctuation">(</span><span class="token string">'Mario'</span><span class="token punctuation">,</span> <span class="token string">'rect spd facing_left frame_cycle'</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Mario<span class="token punctuation">(</span>get_rect<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> P<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> it<span class="token punctuation">.</span>cycle<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">get_tiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        positions <span class="token operator">=</span> <span class="token punctuation">[</span>p <span class="token keyword">for</span> p <span class="token keyword">in</span> it<span class="token punctuation">.</span>product<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>SIZE<span class="token punctuation">)</span><span class="token punctuation">,</span> repeat<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token punctuation">{</span><span class="token operator">*</span>p<span class="token punctuation">}</span> <span class="token operator">&amp;</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> SIZE<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token operator">+</span> \
            <span class="token punctuation">[</span><span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> SIZE<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> randint<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> SIZE<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>SIZE<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">//</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>get_rect<span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span> <span class="token keyword">for</span> p <span class="token keyword">in</span> positions<span class="token punctuation">]</span>
    <span class="token keyword">def</span> <span class="token function">get_rect</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> pygame<span class="token punctuation">.</span>Rect<span class="token punctuation">(</span>x<span class="token operator">*</span><span class="token number">16</span><span class="token punctuation">,</span> y<span class="token operator">*</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
    run<span class="token punctuation">(</span>get_screen<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> get_images<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> get_mario<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> get_tiles<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>screen<span class="token punctuation">,</span> images<span class="token punctuation">,</span> mario<span class="token punctuation">,</span> tiles<span class="token punctuation">)</span><span class="token punctuation">:</span>
    clock <span class="token operator">=</span> pygame<span class="token punctuation">.</span>time<span class="token punctuation">.</span>Clock<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token builtin">all</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token builtin">type</span> <span class="token operator">!=</span> pygame<span class="token punctuation">.</span>QUIT <span class="token keyword">for</span> event <span class="token keyword">in</span> pygame<span class="token punctuation">.</span>event<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        keys <span class="token operator">=</span> <span class="token punctuation">{</span>pygame<span class="token punctuation">.</span>K_UP<span class="token punctuation">:</span> D<span class="token punctuation">.</span>n<span class="token punctuation">,</span> pygame<span class="token punctuation">.</span>K_RIGHT<span class="token punctuation">:</span> D<span class="token punctuation">.</span>e<span class="token punctuation">,</span> pygame<span class="token punctuation">.</span>K_DOWN<span class="token punctuation">:</span> D<span class="token punctuation">.</span>s<span class="token punctuation">,</span> pygame<span class="token punctuation">.</span>K_LEFT<span class="token punctuation">:</span> D<span class="token punctuation">.</span>w<span class="token punctuation">}</span>
        pressed <span class="token operator">=</span> <span class="token punctuation">{</span>keys<span class="token punctuation">.</span>get<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i<span class="token punctuation">,</span> on <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>pygame<span class="token punctuation">.</span>key<span class="token punctuation">.</span>get_pressed<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">if</span> on<span class="token punctuation">}</span>
        update_speed<span class="token punctuation">(</span>mario<span class="token punctuation">,</span> tiles<span class="token punctuation">,</span> pressed<span class="token punctuation">)</span>
        update_position<span class="token punctuation">(</span>mario<span class="token punctuation">,</span> tiles<span class="token punctuation">)</span>
        draw<span class="token punctuation">(</span>screen<span class="token punctuation">,</span> images<span class="token punctuation">,</span> mario<span class="token punctuation">,</span> tiles<span class="token punctuation">,</span> pressed<span class="token punctuation">)</span>
        clock<span class="token punctuation">.</span>tick<span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">update_speed</span><span class="token punctuation">(</span>mario<span class="token punctuation">,</span> tiles<span class="token punctuation">,</span> pressed<span class="token punctuation">)</span><span class="token punctuation">:</span>
    x<span class="token punctuation">,</span> y <span class="token operator">=</span> mario<span class="token punctuation">.</span>spd
    x <span class="token operator">+=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>D<span class="token punctuation">.</span>e <span class="token keyword">in</span> pressed<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>D<span class="token punctuation">.</span>w <span class="token keyword">in</span> pressed<span class="token punctuation">)</span><span class="token punctuation">)</span>
    x <span class="token operator">=</span> math<span class="token punctuation">.</span>copysign<span class="token punctuation">(</span><span class="token builtin">abs</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token keyword">if</span> x <span class="token keyword">else</span> <span class="token number">0</span>
    y <span class="token operator">+=</span> <span class="token number">1</span> <span class="token keyword">if</span> D<span class="token punctuation">.</span>s <span class="token keyword">not</span> <span class="token keyword">in</span> get_boundaries<span class="token punctuation">(</span>mario<span class="token punctuation">.</span>rect<span class="token punctuation">,</span> tiles<span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span> <span class="token keyword">if</span> D<span class="token punctuation">.</span>n <span class="token keyword">in</span> pressed <span class="token keyword">else</span> <span class="token number">0</span><span class="token punctuation">)</span>
    mario<span class="token punctuation">.</span>spd <span class="token operator">=</span> P<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">[</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token operator">-</span>thresh<span class="token punctuation">,</span> <span class="token builtin">min</span><span class="token punctuation">(</span>thresh<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> thresh<span class="token punctuation">,</span> s <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>MAX_SPEED<span class="token punctuation">,</span> P<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">update_position</span><span class="token punctuation">(</span>mario<span class="token punctuation">,</span> tiles<span class="token punctuation">)</span><span class="token punctuation">:</span>
    old_p<span class="token punctuation">,</span> delta <span class="token operator">=</span> mario<span class="token punctuation">.</span>rect<span class="token punctuation">.</span>topleft<span class="token punctuation">,</span> P<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    larger_speed <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span><span class="token builtin">abs</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">for</span> s <span class="token keyword">in</span> mario<span class="token punctuation">.</span>spd<span class="token punctuation">)</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>larger_speed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        mario<span class="token punctuation">.</span>spd <span class="token operator">=</span> stop_on_collision<span class="token punctuation">(</span>mario<span class="token punctuation">.</span>spd<span class="token punctuation">,</span> get_boundaries<span class="token punctuation">(</span>mario<span class="token punctuation">.</span>rect<span class="token punctuation">,</span> tiles<span class="token punctuation">)</span><span class="token punctuation">)</span>
        delta <span class="token operator">=</span> P<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">[</span>a <span class="token operator">+</span> s<span class="token operator">/</span>larger_speed <span class="token keyword">for</span> a<span class="token punctuation">,</span> s <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>delta<span class="token punctuation">,</span> mario<span class="token punctuation">.</span>spd<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        mario<span class="token punctuation">.</span>rect<span class="token punctuation">.</span>topleft <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">sum</span><span class="token punctuation">(</span>pair<span class="token punctuation">)</span> <span class="token keyword">for</span> pair <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>old_p<span class="token punctuation">,</span> delta<span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">get_boundaries</span><span class="token punctuation">(</span>rect<span class="token punctuation">,</span> tiles<span class="token punctuation">)</span><span class="token punctuation">:</span>
    deltas <span class="token operator">=</span> <span class="token punctuation">{</span>D<span class="token punctuation">.</span>n<span class="token punctuation">:</span> P<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> D<span class="token punctuation">.</span>e<span class="token punctuation">:</span> P<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> D<span class="token punctuation">.</span>s<span class="token punctuation">:</span> P<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> D<span class="token punctuation">.</span>w<span class="token punctuation">:</span> P<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>d <span class="token keyword">for</span> d<span class="token punctuation">,</span> delta <span class="token keyword">in</span> deltas<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> rect<span class="token punctuation">.</span>move<span class="token punctuation">(</span>delta<span class="token punctuation">)</span><span class="token punctuation">.</span>collidelist<span class="token punctuation">(</span>tiles<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span>

<span class="token keyword">def</span> <span class="token function">stop_on_collision</span><span class="token punctuation">(</span>spd<span class="token punctuation">,</span> bounds<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> P<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>D<span class="token punctuation">.</span>w <span class="token keyword">in</span> bounds <span class="token keyword">and</span> spd<span class="token punctuation">.</span>x <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token punctuation">(</span>D<span class="token punctuation">.</span>e <span class="token keyword">in</span> bounds <span class="token keyword">and</span> spd<span class="token punctuation">.</span>x <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">else</span> spd<span class="token punctuation">.</span>x<span class="token punctuation">,</span>
             y<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>D<span class="token punctuation">.</span>n <span class="token keyword">in</span> bounds <span class="token keyword">and</span> spd<span class="token punctuation">.</span>y <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token punctuation">(</span>D<span class="token punctuation">.</span>s <span class="token keyword">in</span> bounds <span class="token keyword">and</span> spd<span class="token punctuation">.</span>y <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">else</span> spd<span class="token punctuation">.</span>y<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">draw</span><span class="token punctuation">(</span>screen<span class="token punctuation">,</span> images<span class="token punctuation">,</span> mario<span class="token punctuation">,</span> tiles<span class="token punctuation">,</span> pressed<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get_frame_index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> D<span class="token punctuation">.</span>s <span class="token keyword">not</span> <span class="token keyword">in</span> get_boundaries<span class="token punctuation">(</span>mario<span class="token punctuation">.</span>rect<span class="token punctuation">,</span> tiles<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token number">4</span>
        <span class="token keyword">return</span> <span class="token builtin">next</span><span class="token punctuation">(</span>mario<span class="token punctuation">.</span>frame_cycle<span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token punctuation">{</span>D<span class="token punctuation">.</span>w<span class="token punctuation">,</span> D<span class="token punctuation">.</span>e<span class="token punctuation">}</span> <span class="token operator">&amp;</span> pressed <span class="token keyword">else</span> <span class="token number">6</span>
    screen<span class="token punctuation">.</span>fill<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">168</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    mario<span class="token punctuation">.</span>facing_left <span class="token operator">=</span> <span class="token punctuation">(</span>D<span class="token punctuation">.</span>w <span class="token keyword">in</span> pressed<span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token punctuation">{</span>D<span class="token punctuation">.</span>e<span class="token punctuation">,</span> D<span class="token punctuation">.</span>w<span class="token punctuation">}</span> <span class="token operator">&amp;</span> pressed <span class="token keyword">else</span> mario<span class="token punctuation">.</span>facing_left
    screen<span class="token punctuation">.</span>blit<span class="token punctuation">(</span>images<span class="token punctuation">[</span>get_frame_index<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> mario<span class="token punctuation">.</span>facing_left<span class="token operator">*</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span> mario<span class="token punctuation">.</span>rect<span class="token punctuation">)</span>
    <span class="token keyword">for</span> rect <span class="token keyword">in</span> tiles<span class="token punctuation">:</span>
        screen<span class="token punctuation">.</span>blit<span class="token punctuation">(</span>images<span class="token punctuation">[</span><span class="token number">19</span> <span class="token keyword">if</span> <span class="token punctuation">{</span><span class="token operator">*</span>rect<span class="token punctuation">.</span>topleft<span class="token punctuation">}</span> <span class="token operator">&amp;</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>SIZE<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rect<span class="token punctuation">)</span>
    pygame<span class="token punctuation">.</span>display<span class="token punctuation">.</span>flip<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="basic-script-template">Basic Script Template</h2> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python3</span>
<span class="token comment">#</span>
<span class="token comment"># Usage: .py</span>
<span class="token comment">#</span>

<span class="token keyword">from</span> collections <span class="token keyword">import</span> namedtuple
<span class="token keyword">from</span> dataclasses <span class="token keyword">import</span> make_dataclass
<span class="token keyword">from</span> enum <span class="token keyword">import</span> Enum
<span class="token keyword">from</span> sys <span class="token keyword">import</span> argv
<span class="token keyword">import</span> re


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>


<span class="token comment">###</span>
<span class="token comment">##  UTIL</span>
<span class="token comment">#</span>

<span class="token keyword">def</span> <span class="token function">read_file</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">file</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div></div></div></div></div><div class="global-ui"></div></div>
    <script src="/vuepress/assets/js/app.f5011d8a.js" defer></script><script src="/vuepress/assets/js/4.90bcc246.js" defer></script><script src="/vuepress/assets/js/12.6b37e325.js" defer></script>
  </body>
</html>
